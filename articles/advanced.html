<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Spectroscopy Advanced • OpenSpecy</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spectroscopy Advanced">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OpenSpecy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/app.html">Open Specy App Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/sop.html">Open Specy Package Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/advanced.html">Spectroscopy Advanced</a></li>
    <li><a class="dropdown-item" href="../articles/spectragryph.html">File Conversion in SpectraGryph</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/wincowgerDEV/OpenSpecy-package/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Spectroscopy Advanced</h1>
                        <h4 data-toc-skip class="author"></h4>
<p>Jessica
Meyers, Jeremy Conkle, Win Cowger, Zacharias Steinmetz, Andrew Gray,
Chelsea Rochman, Sebastian Primpke, Jennifer Lynch, Hannah Hapich,
Hannah De Frond, Keenan Munno, Bridget O’Donnell</p>
            
            <h4 data-toc-skip class="date">2025-05-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wincowgerDEV/OpenSpecy-package/blob/main/vignettes/advanced.Rmd" class="external-link"><code>vignettes/advanced.Rmd</code></a></small>
      <div class="d-none name"><code>advanced.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="how-to-interpret-the-reported-matches">How to Interpret the Reported Matches<a class="anchor" aria-label="anchor" href="#how-to-interpret-the-reported-matches"></a>
</h2>
<p>There are several important things to consider when interpreting a
spectral match including the library source, the Pearson’s r, and other
metrics.</p>
</div>
<div class="section level2">
<h2 id="the-library-source">The Library Source<a class="anchor" aria-label="anchor" href="#the-library-source"></a>
</h2>
<p>When you click on a spectrum, all of the metadata that we have in
Open Specy about that source will be displayed in a metadata window
below to the matches table. Each library has different methodologies
used to develop it. It is useful to read up on the library sources from
the literature that they came from. E.g. Chabuka et al. 2020 focuses on
weathered plastics, so matching to it may suggest that your spectrum is
of a weathered polymer. Primpke et al. 2018 only has a spectral range up
to 2000, so some polymers may be difficult to differentiate with it.
Make sure to cite the libraries that you use during your search when you
publish your results. The authors were kind enough to make their data
open access so that it could be used in Open Specy and we should return
the favor by citing them.</p>
</div>
<div class="section level2">
<h2 id="pearsons-r">Pearson’s <strong>r</strong><a class="anchor" aria-label="anchor" href="#pearsons-r"></a>
</h2>
<p>Correlation values are used to identify the closest matches available
in the current Open Specy spectral libraries to improve material
identification and reduce sample processing times. Pearson’s r values
range from 0 - 1 with 0 being a completely different spectrum and 1
being an exact match. Some general guidelines that we have observed from
using Open Specy. If no matches are &gt; ~0.6 the material may require
additional processing or may not exist in the Open Specy library.
Correlation values are not the only metric you should use to assess your
spectra’s match to a material in the library, matches need to make
sense.</p>
</div>
<div class="section level2">
<h2 id="things-to-consider-beyond-correlation">Things to Consider beyond Correlation<a class="anchor" aria-label="anchor" href="#things-to-consider-beyond-correlation"></a>
</h2>
<p>Peak position and height similarities are more important than
correlation and need to be assessed manually. Peak position correlates
with specific bond types. Peak height correlates to the concentration of
a compound. Therefore, peak height and peak position should match as
closely as possible to the matched spectrum. When there are peaks that
exist in the spectra you are trying to interpret that do not exist in
the match, there may be additional materials to identify. In this case,
restrict the processing range to just the unidentified peak and try to
identify it as an additional component (see also <a href="https://www.compoundchem.com/2015/02/05/irspectroscopy/" class="external-link">https://www.compoundchem.com/2015/02/05/irspectroscopy/</a>).</p>
<p>Also, check the match metadata to see if the match makes sense.
Example: A single fiber cannot be a “cotton blend” since there would be
no other fibers to make up the rest of the blend. Example: Cellophane
does not degrade into fibers, so a match for a fiber to cellophane
wouldn’t make sense. Example: You are analyzing a particle at room
temperature, but the matched material is liquid at room temperature. The
material may be a component of the particle but it cannot be the whole
particle.</p>
</div>
<div class="section level2">
<h2 id="how-specific-do-you-need-to-be-in-the-material-type-of-the-match">How Specific Do You Need to be in the Material Type of the
Match?<a class="anchor" aria-label="anchor" href="#how-specific-do-you-need-to-be-in-the-material-type-of-the-match"></a>
</h2>
<p>You can choose to be specific about how you classify a substance
(e.g. polyester, cellophane) or more general (e.g. synthetic,
semi-synthetic, natural, etc.). The choice depends on your research
question. Using more general groups can speed up analysis time but will
decrease the information you have for interpretation. To identify
materials more generally, you can often clump the identities provided by
Open Specy to suit your needs. For example, matches to “polyester” and
“polypropylene” could be clumped to the category “plastic”.</p>
</div>
<div class="section level2">
<h2 id="how-to-differentiate-between-similar-spectra">How to Differentiate Between Similar Spectra?<a class="anchor" aria-label="anchor" href="#how-to-differentiate-between-similar-spectra"></a>
</h2>
<p>One common challenge is differentiating between LDPE and HDPE. But,
even with a low resolution instrument (MacroRAM, 2 cm<sup>-1</sup>
pixel<sup>-1</sup>), you can still see some differences. From a wide
view, these low, medium, and high density PE samples all look relatively
similar (figures courtesy of Bridget O'Donnell, Horiba Scientific):</p>
<p><img src="advanced/horiba-1.png" width="300" style="display: block; margin: auto;"></p>
<p>But, a closer look at the 1450 cm<sup>-1</sup> band reveals clear
differences:</p>
<p><img src="advanced/horiba-2.png" width="300" style="display: block; margin: auto;"></p>
<p>When you overlay them, you start to see differences in other spectral
regions too:</p>
<p><img src="advanced/horiba-3.png" width="300" style="display: block; margin: auto;"></p>
<p>So, the question is, how do we deal with samples that are very
similar with only subtle differences? Usually, researchers will use MVA
techniques after they’ve collected multiple reference spectra of known
samples (LDPE and HDPE in this case). They can then develop models and
apply them to distinguish between different types of PE. With a
reference database like Open Specy, this is complicated by the fact that
researchers are measuring samples on different instruments with
correspondingly different spectral responses and spectral resolutions.
That makes it even more difficult to accurately match definitively to
LDPE and HDPE as opposed to generic ‘PE’.</p>
<p>One possibility is to place more emphasis (from a computational
perspective) on the bands that show the most difference (the triplet at
1450 cm<sup>-1</sup>) by restricting the range used to match in Open
Specy.</p>
<p>The other, much simpler option is to just match any PE hit to generic
‘PE’ and not specifically HDPE or LDPE.</p>
<p>Another challenge is in differentiating between types of nylons. But,
Raman has a pretty easy time distinguishing nylons. These spectra were
recorded of a series of nylons and the differences are much more
distinguishable compared to the PE results above (nylon 6, 6-6, 6-9,
6-10, and 6-12 top to bottom):</p>
<p><img src="advanced/horiba-4.png" width="300" style="display: block; margin: auto;"></p>
<p>The differences are even more pronounced when you overlay the
spectra:</p>
<p><img src="advanced/horiba-5.png" width="300" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="what-to-do-when-matches-arent-making-sense">What to Do When Matches Aren’t Making Sense<a class="anchor" aria-label="anchor" href="#what-to-do-when-matches-arent-making-sense"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Double check that the baseline correction and smoothing parameters
result in the best processing of the data.</li>
<li>Try reprocessing your spectrum, but limit it to specific peak
regions with a higher signal to noise ratio.</li>
<li>Restrict the spectral range to include or exclude questionable peaks
or peaks that were not present in the previous matches.</li>
<li>Restrict the spectral range to exclude things like CO<sub>2</sub>
(2200 cm<sup>-1</sup>) or H<sub>2</sub>O (~1600 cm<sup>-1</sup>) in
spikes in the IR spectrum.</li>
<li>If nothing above works to determine a quality match, you may need to
measure the spectrum of your material again or use another spectral
analysis tool.</li>
</ol>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Chabuka BK, Kalivas JH (2020). “Application of a Hybrid Fusion
Classification Process for Identification of Microplastics Based on
Fourier Transform Infrared Spectroscopy.” <em>Applied Spectroscopy</em>,
<strong>74</strong>(9), 1167–1183. doi: <a href="https://doi.org/10.1177/0003702820923993" class="external-link">10.1177/0003702820923993</a>.</p>
<p>Cowger W, Gray A, Christiansen SH, De Frond H, Deshpande AD,
Hemabessiere L, Lee E, Mill L, et al. (2020). “Critical Review of
Processing and Classification Techniques for Images and Spectra in
Microplastic Research.” <em>Applied Spectroscopy</em>,
<strong>74</strong>(9), 989–1010. doi: <a href="https://doi.org/10.1177/0003702820929064" class="external-link">10.1177/0003702820929064</a>.</p>
<p>Cowger W, Steinmetz Z, Gray A, Munno K, Lynch J, Hapich H, Primpke S,
De Frond H, Rochman C, Herodotou O (2021). “Microplastic Spectral
Classification Needs an Open Source Community: Open Specy to the
Rescue!” <em>Analytical Chemistry</em>, <strong>93</strong>(21),
7543–7548. doi: <a href="https://doi.org/10.1021/acs.analchem.1c00123" class="external-link">10.1021/acs.analchem.1c00123</a>.</p>
<p>Primpke S, Wirth M, Lorenz C, Gerdts G (2018). “Reference Database
Design for the Automated Analysis of Microplastic Samples Based on
Fourier Transform Infrared (FTIR) Spectroscopy.” <em>Analytical and
Bioanalytical Chemistry</em>, <strong>410</strong>(21), 5131–5141. doi:
<a href="https://doi.org/10.1007/s00216-018-1156-x" class="external-link">10.1007/s00216-018-1156-x</a>.</p>
<p>Renner G, Schmidt TC, Schram J (2017). “A New Chemometric Approach
for Automatic Identification of Microplastics from Environmental
Compartments Based on FT-IR Spectroscopy.” <em>Analytical
Chemistry</em>, <strong>89</strong>(22), 12045–12053. doi: <a href="https://doi.org/10.1021/acs.analchem.7b02472" class="external-link">10.1021/acs.analchem.7b02472</a>.</p>
<p>Savitzky A, Golay MJ (1964). “Smoothing and Differentiation of Data
by Simplified Least Squares Procedures.” <em>Analytical Chemistry</em>,
<strong>36</strong>(8), 1627–1639.</p>
<p>Zhao J, Lui H, McLean DI, Zeng H (2007). “Automated Autofluorescence
Background Subtraction Algorithm for Biomedical Raman Spectroscopy.”
<em>Applied Spectroscopy</em>, <strong>61</strong>(11), 1225–1232. doi:
<a href="https://doi.org/10.1366/000370207782597003" class="external-link">10.1366/000370207782597003</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Win Cowger, Zacharias Steinmetz, Hazel Vaquero, Nick Leong, Andrea Faltynkova, Hannah Sherrod, National Renewable Energy Laboratory, Possibility Lab.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
