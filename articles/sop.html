<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="OpenSpecy">
<title>Open Specy Package Tutorial • OpenSpecy</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Open Specy Package Tutorial">
<meta property="og:description" content="OpenSpecy">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">OpenSpecy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/app.html">Open Specy App Tutorial</a>
    <a class="dropdown-item" href="../articles/sop.html">Open Specy Package Tutorial</a>
    <a class="dropdown-item" href="../articles/advanced.html">Spectroscopy Advanced</a>
    <a class="dropdown-item" href="../articles/spectragryph.html">File Conversion in SpectraGryph</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/wincowgerDEV/OpenSpecy-package/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<link href="sop_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="sop_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="sop_files/plotly-binding-4.10.4/plotly.js"></script><script src="sop_files/typedarray-0.1/typedarray.min.js"></script><link href="sop_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="sop_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="sop_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="sop_files/plotly-main-2.11.1/plotly-latest.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Open Specy Package Tutorial</h1>
                        <h4 data-toc-skip class="author"></h4>
<p>Win Cowger,
Zacharias Steinmetz, Rachel Kozloski, Aleksandra Karapetrova</p>
            
            <h4 data-toc-skip class="date">2024-05-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wincowgerDEV/OpenSpecy-package/blob/HEAD/vignettes/sop.Rmd" class="external-link"><code>vignettes/sop.Rmd</code></a></small>
      <div class="d-none name"><code>sop.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="document-overview">Document Overview<a class="anchor" aria-label="anchor" href="#document-overview"></a>
</h2>
<p>This document outlines a common workflow for using the Open Specy
package and highlights some topics that users are often requesting a
tutorial on. If the document is followed sequentially from beginning to
end, the user will have a better understanding of every procedure
involved in using the Open Specy R package as a tool for interpreting
spectra. It takes approximately 45 minutes to read through and follow
along with this standard operating procedure the first time. Afterward,
knowledgeable users should be able to thoroughly analyze spectra at an
average speed of 1 min<sup>-1</sup> or faster with the new batch and
automated procedures.</p>
<p>The Open Specy R package is the backbone of the Shiny app. The choice
is yours as to which you start with, we use both on a regular basis. The
tutorial will talk through the R functions you can use to
programatically analyze spectra. If you are looking for a tutorial about
how to use the app see <a href="http://wincowger.com/OpenSpecy-package/articles/app.html">this
tutorial</a>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>After installing the R package, you just need to read in the
library.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wincowgerDEV/OpenSpecy-package/" class="external-link">OpenSpecy</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-the-app">Running the App<a class="anchor" aria-label="anchor" href="#running-the-app"></a>
</h2>
<p>To get started with the Open Specy user interface, access <a href="https://openanalysis.org/openspecy/" class="external-link">https://openanalysis.org/openspecy/</a>
or start the Shiny GUI directly from your own computer in R. If you are
looking for a tutorial about how to use the app see <a href="http://wincowger.com/OpenSpecy-package/articles/app.html">this
tutorial</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run_app.html">run_app</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="read-data">Read Data<a class="anchor" aria-label="anchor" href="#read-data"></a>
</h2>
<p>The following line of code will read in your data when using the
package and interprets which reading function to use based on the file
extension.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_multi.html">read_any</a></span><span class="op">(</span><span class="st">"path/to/your/data"</span><span class="op">)</span></span></code></pre></div>
<p>These file type specific functions will also read in spectral data
accordingly if you have a particular format in mind.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_ext.html">read_text</a></span><span class="op">(</span><span class="st">".csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/read_ext.html">read_asp</a></span><span class="op">(</span><span class="st">".asp"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/read_opus.html">read_opus</a></span><span class="op">(</span><span class="st">".0"</span><span class="op">)</span></span></code></pre></div>
<p>Open Specy allows for upload of native Open Specy .y(a)ml, .json, or
.rds files. In addition, .csv, .asp, .jdx, .0, .spa, .spc, and .zip
files can be imported. .zip files can either contain multiple files with
individual spectra in them of the non-zip formats or it can contain a
.hdr and .dat file that form an ENVI file for a spectral map. Open Specy
and .csv files should always load correctly but the other file types are
still in development, though most of the time these files work
perfectly. If uploading a .csv file, label the column with the
wavenumbers <code>wavenumber</code> and name the column with the
intensities <code>intensity</code>. Wavenumber units must be
cm<sup>-1</sup>. Any other columns are not used by the software. Always
keep a copy of the original file before alteration to preserve metadata
and raw data for your records.</p>
<p>It is best practice to cross check files in the proprietary software
they came from and Open Specy before use in Open Specy. Due to the
complexity of some proprietary file types, we haven’t been able to make
them fully compatible yet. If your file is not working, please contact
the administrator and share the file so that we can work on integrating
it.</p>
<p>The specific steps to converting your instrument’s native files to
.csv can be found in its software manual or you can check out <a href="https://www.effemm2.de/spectragryph/" class="external-link">Spectragryph</a>, which
supports many spectral file conversions. For instructions, see <a href="http://wincowger.com/OpenSpecy-package/articles/spectragryph.html">Spectragryph
Tutorial</a>.</p>
<p>If you don’t have your own data, you can use a test dataset.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"raman_hdpe"</span><span class="op">)</span></span></code></pre></div>
<p>We also have many onboard files that you can call to test different
formats:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spectral_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ext.html">read_extdata</a></span><span class="op">(</span><span class="st">"CA_tiny_map.zip"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/read_multi.html">read_any</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># preserves some metadata</span></span>
<span><span class="va">asp_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ext.html">read_extdata</a></span><span class="op">(</span><span class="st">"ftir_ldpe_soil.asp"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/read_multi.html">read_any</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">ps_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ext.html">read_extdata</a></span><span class="op">(</span><span class="st">"ftir_ps.0"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/read_multi.html">read_any</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># preserves some metadata</span></span>
<span><span class="va">csv_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ext.html">read_extdata</a></span><span class="op">(</span><span class="st">"raman_hdpe.csv"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/read_multi.html">read_any</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">json_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ext.html">read_extdata</a></span><span class="op">(</span><span class="st">"raman_hdpe.json"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/read_multi.html">read_any</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># read in exactly as an OpenSpecy object</span></span></code></pre></div>
<p>You will notice now that the R package reads in files into an object
with class <code>OpenSpecy</code>. This is a class we created for high
throughput spectral analysis which now also preserves spectral metadata.
You can even create these from scratch if you’d like.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scratch_OpenSpecy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_OpenSpecy.html">as_OpenSpecy</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">2000</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span>                                  spectra <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">201</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                                  metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>file_name <span class="op">=</span> <span class="st">"fake_noise"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>Open Specy objects are lists with three components,
<code>wavenumber</code> is a vector of the wavenumber values for the
spectra and corresponds to the rows in <code>spectra</code> which is a
<code>data.table</code> where each column is a set of spectral
intensities. <code>metadata</code> is a data.table which holds
additional information about the spectra. Each row corresponds to a
column in <code>spectra</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access the wavenumbers</span></span>
<span><span class="va">scratch_OpenSpecy</span><span class="op">$</span><span class="va">wavenumber</span></span>
<span><span class="co">#&gt;   [1] 1000 1005 1010 1015 1020 1025 1030 1035 1040 1045 1050 1055 1060 1065 1070</span></span>
<span><span class="co">#&gt;  [16] 1075 1080 1085 1090 1095 1100 1105 1110 1115 1120 1125 1130 1135 1140 1145</span></span>
<span><span class="co">#&gt;  [31] 1150 1155 1160 1165 1170 1175 1180 1185 1190 1195 1200 1205 1210 1215 1220</span></span>
<span><span class="co">#&gt;  [46] 1225 1230 1235 1240 1245 1250 1255 1260 1265 1270 1275 1280 1285 1290 1295</span></span>
<span><span class="co">#&gt;  [61] 1300 1305 1310 1315 1320 1325 1330 1335 1340 1345 1350 1355 1360 1365 1370</span></span>
<span><span class="co">#&gt;  [76] 1375 1380 1385 1390 1395 1400 1405 1410 1415 1420 1425 1430 1435 1440 1445</span></span>
<span><span class="co">#&gt;  [91] 1450 1455 1460 1465 1470 1475 1480 1485 1490 1495 1500 1505 1510 1515 1520</span></span>
<span><span class="co">#&gt; [106] 1525 1530 1535 1540 1545 1550 1555 1560 1565 1570 1575 1580 1585 1590 1595</span></span>
<span><span class="co">#&gt; [121] 1600 1605 1610 1615 1620 1625 1630 1635 1640 1645 1650 1655 1660 1665 1670</span></span>
<span><span class="co">#&gt; [136] 1675 1680 1685 1690 1695 1700 1705 1710 1715 1720 1725 1730 1735 1740 1745</span></span>
<span><span class="co">#&gt; [151] 1750 1755 1760 1765 1770 1775 1780 1785 1790 1795 1800 1805 1810 1815 1820</span></span>
<span><span class="co">#&gt; [166] 1825 1830 1835 1840 1845 1850 1855 1860 1865 1870 1875 1880 1885 1890 1895</span></span>
<span><span class="co">#&gt; [181] 1900 1905 1910 1915 1920 1925 1930 1935 1940 1945 1950 1955 1960 1965 1970</span></span>
<span><span class="co">#&gt; [196] 1975 1980 1985 1990 1995 2000</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access the spectra</span></span>
<span><span class="va">scratch_OpenSpecy</span><span class="op">$</span><span class="va">spectra</span></span>
<span><span class="co">#&gt;      runif.n...201.</span></span>
<span><span class="co">#&gt;               &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1:    0.080750138</span></span>
<span><span class="co">#&gt;   2:    0.834333037</span></span>
<span><span class="co">#&gt;   3:    0.600760886</span></span>
<span><span class="co">#&gt;   4:    0.157208442</span></span>
<span><span class="co">#&gt;   5:    0.007399441</span></span>
<span><span class="co">#&gt;  ---               </span></span>
<span><span class="co">#&gt; 197:    0.906051578</span></span>
<span><span class="co">#&gt; 198:    0.772730364</span></span>
<span><span class="co">#&gt; 199:    0.383370670</span></span>
<span><span class="co">#&gt; 200:    0.999652457</span></span>
<span><span class="co">#&gt; 201:    0.349299049</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access the metadata</span></span>
<span><span class="va">scratch_OpenSpecy</span><span class="op">$</span><span class="va">metadata</span></span>
<span><span class="co">#&gt;        x     y  file_name         col_id                          file_id</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;int&gt;     &lt;char&gt;         &lt;char&gt;                           &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:     1     1 fake_noise runif.n...201. 74944ff090b28e2fe0504f0e85d29ded</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Performs checks to ensure that OpenSpecy objects are adhering to our standards;</span></span>
<span><span class="co"># returns TRUE if it passes. </span></span>
<span><span class="fu"><a href="../reference/as_OpenSpecy.html">check_OpenSpecy</a></span><span class="op">(</span><span class="va">scratch_OpenSpecy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Checks only the object type to make sure it has OpenSpecy type</span></span>
<span><span class="fu"><a href="../reference/as_OpenSpecy.html">is_OpenSpecy</a></span><span class="op">(</span><span class="va">scratch_OpenSpecy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We have some generic functions built for inspecting the spectra:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scratch_OpenSpecy</span><span class="op">)</span> <span class="co"># shows the raw object</span></span>
<span><span class="co">#&gt;      wavenumber runif.n...201.</span></span>
<span><span class="co">#&gt;           &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1:       1000    0.080750138</span></span>
<span><span class="co">#&gt;   2:       1005    0.834333037</span></span>
<span><span class="co">#&gt;   3:       1010    0.600760886</span></span>
<span><span class="co">#&gt;   4:       1015    0.157208442</span></span>
<span><span class="co">#&gt;   5:       1020    0.007399441</span></span>
<span><span class="co">#&gt;  ---                          </span></span>
<span><span class="co">#&gt; 197:       1980    0.906051578</span></span>
<span><span class="co">#&gt; 198:       1985    0.772730364</span></span>
<span><span class="co">#&gt; 199:       1990    0.383370670</span></span>
<span><span class="co">#&gt; 200:       1995    0.999652457</span></span>
<span><span class="co">#&gt; 201:       2000    0.349299049</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metadata</span></span>
<span><span class="co">#&gt;        x     y  file_name         col_id                          file_id</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;int&gt;     &lt;char&gt;         &lt;char&gt;                           &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:     1     1 fake_noise runif.n...201. 74944ff090b28e2fe0504f0e85d29ded</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scratch_OpenSpecy</span><span class="op">)</span> <span class="co"># summarizes the contents of the spectra</span></span>
<span><span class="co">#&gt; $wavenumber</span></span>
<span><span class="co">#&gt;  Length Min. Max.     Res.</span></span>
<span><span class="co">#&gt;     201 1000 2000 4.975124</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $spectra</span></span>
<span><span class="co">#&gt;  Number Min. Intensity Max. Intensity</span></span>
<span><span class="co">#&gt;       1    0.004496308      0.9996525</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metadata</span></span>
<span><span class="co">#&gt;   Min. Max.</span></span>
<span><span class="co">#&gt; x    1    1</span></span>
<span><span class="co">#&gt; y    1    1</span></span>
<span><span class="co">#&gt; [1] "x"         "y"         "file_name" "col_id"    "file_id"</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scratch_OpenSpecy</span><span class="op">)</span> <span class="co"># shows the top wavenumbers and intensities</span></span>
<span><span class="co">#&gt;    wavenumber runif.n...201.</span></span>
<span><span class="co">#&gt;         &lt;num&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:       1000    0.080750138</span></span>
<span><span class="co">#&gt; 2:       1005    0.834333037</span></span>
<span><span class="co">#&gt; 3:       1010    0.600760886</span></span>
<span><span class="co">#&gt; 4:       1015    0.157208442</span></span>
<span><span class="co">#&gt; 5:       1020    0.007399441</span></span>
<span><span class="co">#&gt; 6:       1025    0.466393497</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="save-data">Save Data<a class="anchor" aria-label="anchor" href="#save-data"></a>
</h2>
<p>Open Specy objects can be saved most accurately as .rds, .yml, or
.json files. .rds will be the most reproducible as it is a native R file
format and floating point errors can happen with .json or .yml.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/io_spec.html">write_spec</a></span><span class="op">(</span><span class="va">scratch_OpenSpecy</span>, <span class="st">"test_scratch_OpenSpecy.yml"</span>, digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/io_spec.html">write_spec</a></span><span class="op">(</span><span class="va">scratch_OpenSpecy</span>, <span class="st">"test_scratch_OpenSpecy.json"</span>, digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="format-conversions">Format Conversions<a class="anchor" aria-label="anchor" href="#format-conversions"></a>
</h2>
<p>Another great spectroscopy R package is <a href="https://CRAN.R-project.org/package=hyperSpec" class="external-link">hyperSpec</a>. We
actually depend on their functions for several of ours. They are
currently making some awesome new features and we want to integrate well
with them so that both packages can be easily used together. That is why
we created the <code>as_hyperSpec</code> function and made sure that
<code>as_OpenSpecy</code> can convert from <code>hyperSpec</code>
objects.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hyperspecy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/io_spec.html">as_hyperSpec</a></span><span class="op">(</span><span class="va">scratch_OpenSpecy</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<div class="section level3">
<h3 id="spectra">Spectra<a class="anchor" aria-label="anchor" href="#spectra"></a>
</h3>
<p>In R, we have two ways to visualize your spectra, one is quick and
efficient and the other is interactive. Here is an example of quick and
efficient plotting.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scratch_OpenSpecy</span><span class="op">)</span> <span class="co"># quick and efficient</span></span></code></pre></div>
<p><img src="sop_files/figure-html/unnamed-chunk-17-1.png" width="480" style="display: block; margin: auto;"></p>
<p>This is an example of an interactive plot. You can plot two different
datasets simultaneously to compare.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This will min-max normalize your data even if it isn't already but are not</span></span>
<span><span class="co"># changing your underlying data</span></span>
<span><span class="fu"><a href="../reference/interactive_plots.html">plotly_spec</a></span><span class="op">(</span><span class="va">scratch_OpenSpecy</span>, <span class="va">json_example</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"visdat":{"18f163891e11":["function () ","plotlyVisDat"],"18f1612c3487":["function () ","data"]},"cur_data":"18f1612c3487","attrs":{"18f163891e11":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"18f163891e11.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"split":{},"line":{"color":"rgb(255, 255, 255)"},"name":"x1","showlegend":false,"inherit":true},"18f1612c3487":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"split":{},"name":"x2","line":{"dash":"dot","color":"rgb(255,0,0)"},"showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"wavenumber [cm<sup>-1<\/sup>]","autorange":"reversed"},"yaxis":{"domain":[0,1],"automargin":true,"title":"intensity [-]"},"plot_bgcolor":"rgba(17, 0, 73, 0)","paper_bgcolor":"rgb(0, 0, 0)","legend":{"orientation":"h","y":1.1000000000000001},"font":{"color":"#FFFFFF"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[1000,1005,1010,1015,1020,1025,1030,1035,1040,1045,1050,1055,1060,1065,1070,1075,1080,1085,1090,1095,1100,1105,1110,1115,1120,1125,1130,1135,1140,1145,1150,1155,1160,1165,1170,1175,1180,1185,1190,1195,1200,1205,1210,1215,1220,1225,1230,1235,1240,1245,1250,1255,1260,1265,1270,1275,1280,1285,1290,1295,1300,1305,1310,1315,1320,1325,1330,1335,1340,1345,1350,1355,1360,1365,1370,1375,1380,1385,1390,1395,1400,1405,1410,1415,1420,1425,1430,1435,1440,1445,1450,1455,1460,1465,1470,1475,1480,1485,1490,1495,1500,1505,1510,1515,1520,1525,1530,1535,1540,1545,1550,1555,1560,1565,1570,1575,1580,1585,1590,1595,1600,1605,1610,1615,1620,1625,1630,1635,1640,1645,1650,1655,1660,1665,1670,1675,1680,1685,1690,1695,1700,1705,1710,1715,1720,1725,1730,1735,1740,1745,1750,1755,1760,1765,1770,1775,1780,1785,1790,1795,1800,1805,1810,1815,1820,1825,1830,1835,1840,1845,1850,1855,1860,1865,1870,1875,1880,1885,1890,1895,1900,1905,1910,1915,1920,1925,1930,1935,1940,1945,1950,1955,1960,1965,1970,1975,1980,1985,1990,1995,2000],"y":[0.076624989544883101,0.83387589970346743,0.59916685304135853,0.15345544878672698,0.0029172639565956293,0.46414544055134871,0.49568209073836433,0.28665947228361688,0.73193104376878704,0.77176351048081138,0.87433952295477613,0.17127394423270625,0.029889806393128261,0.31742699178667166,0.39976834856944854,0.19210405005799597,0.40098411662981187,0.059453131329546834,0.38607509531137768,0.97577805052954791,0.28678513173683595,0.67716420176912229,0.73438052047763269,0.19239234485790091,0.98079418735520107,0.74061263827082557,0.047178493795036178,0.52827504104274225,0.69469255807753605,0.68738930661985276,0.026864143204324106,0.22214225041338881,0.2977768849142296,0.635045371917211,0.4768379736953488,0.42975662710523393,0.70535416007397744,0.94867551094853342,0.1766983605163604,0.21343742750444844,0.67895536808496371,0.49675551210216273,0.64028448291917839,0.65898004222517836,0.091973355350056643,0.76480847409119057,0.76890294744869603,0.99101633958113455,0.97072664995846791,0.38655888615986994,0.4589130630312877,0.31225797544228728,0.17100792279894073,0.5296427431735955,0.49152156515205903,0.77858366104963217,0.2006539727017414,0.71235149527043728,0.061015352943543426,0.35141268140394777,0.82469782625504684,0.27063284223770201,0.56830141027502645,0.3328349755786052,0.59464686152952306,0.18793203824650945,0.94785891693794189,0.5406026994830776,0.54273601769173474,0.27543501203041942,0.44435856772396481,0.36880129480037405,0.023679365592017186,0.46373715641406915,0.3874116435071992,0.015644690247157308,0.37428761302667318,0.55811998181075506,0.85673718514600961,0.38216455105972247,0.52596844025687117,0.59904289006059608,0.25812537105290145,0.2869437663003182,0.4778937118313511,0.91996541339297955,0.39815246779602609,0.20969212051234501,0.67051839878132491,0.054381217502973096,0.99740410398445922,0.14524269320030384,0.51656247915564169,0.84572028950280242,0.71724765679655167,0.23797040511403131,0.54518786913447037,0.83434695940470671,0.023573905882625631,0.46715080058426828,0.80508342672364297,0.81349545266477274,0.4013588161807905,0.21497601244448528,0.41587955283264849,0.66760823446018625,0.50560303967248099,0.65905536433885026,0.5097642276106723,0.83510123478289389,0.70771290908021423,0.87394288179851087,0.0070172202588014709,0.88805486521540955,0.99667837220573652,0.49810795346775155,0.35619607699506339,0.77416666209754603,0.58280194858684053,0.6325440118351684,0.85832745692954215,0.56513546254773672,0.24971027059176706,0.91875722950737226,0.86705377597644628,0.24523024760602755,0.40032401360517567,0.76885810194447857,0.11554876749246384,0.19112443185266689,0.16085208367158912,0.66191649800899088,0.85622612814111099,0.92653815295488551,0.55054805927779848,0.5753563265682714,0.68627565445639294,0.24139118448220476,0.040316135665309068,0.90976501466533288,0.066507061464826669,0.9972255773397174,0.61031237152492246,0.16888056996860776,0.9093494100306464,0.033115264249806244,0.59192467716571928,0.23361283253224649,0.90619040986225907,0.81834059578233953,0.69871753268358827,0.21655297144643484,0.72701618829069892,0.21362291176854162,0.45393267238468504,0.32990144364202628,0.5666008907102742,0.24891512452256984,0.46175392583256619,0.9176089598068603,0.97306127354009508,0.81855107792253734,0.90280052121969612,0.57967760783504862,0.77225285071976013,0.99544852255831606,0.70991365756521907,0.2114706197870504,0.28865954569447921,0.72075464929934008,0.86631569932491914,0.23509556630479694,0,0.9435907691136397,0.43575160818353559,0.74973864234472487,0.66654811605148578,0.40544078814362233,0.34844029975678642,0.73716597547307228,0.66300066112474509,0.08112133174870656,0.85578112476879586,0.072839838963422429,0.85247777049332385,0.10234640354852251,0.48264437282712364,0.2439042380814706,0.68539284327243089,0.15990142879701491,0.95294441237065419,0.31890296142804087,0.35877566455486104,0.88752615376027832,0.82752652480367495,0.096628202267381183,0.90594352504022302,0.77197338033740437,0.38071850610689667,1,0.34648104299126636],"line":{"color":"rgb(255, 255, 255)"},"name":"x1","showlegend":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[301.04000000000002,304.63200000000001,308.221,311.81,315.39800000000002,318.983,322.56599999999997,326.14999999999998,329.73200000000003,333.31099999999998,336.88900000000001,340.46699999999998,344.04199999999997,347.61799999999999,351.19,354.75999999999999,358.33199999999999,361.89999999999998,365.46600000000001,369.03100000000001,372.59699999999998,376.16000000000003,379.721,383.27999999999997,386.839,390.39600000000002,393.95100000000002,397.505,401.05799999999999,404.61000000000001,408.16000000000003,411.70800000000003,415.25599999999997,418.80099999999999,422.346,425.887,429.42899999999997,432.97000000000003,436.50700000000001,440.04399999999998,443.58100000000002,447.11599999999999,450.64699999999999,454.18000000000001,457.70800000000003,461.238,464.76400000000001,468.291,471.815,475.339,478.85899999999998,482.37900000000002,485.899,489.416,492.93099999999998,496.447,499.95999999999998,503.471,506.98099999999999,510.48899999999998,513.99900000000002,517.50300000000004,521.00900000000001,524.50999999999999,528.01400000000001,531.51300000000003,535.01400000000001,538.50999999999999,542.00800000000004,545.50199999999995,548.99699999999996,552.48800000000006,555.97900000000004,559.46900000000005,562.95500000000004,566.44200000000001,569.928,573.41099999999994,576.89400000000001,580.37599999999998,583.85400000000004,587.33100000000002,590.81100000000004,594.28599999999994,597.75900000000001,601.23099999999999,604.70500000000004,608.17399999999998,611.64200000000005,615.10900000000004,618.57399999999996,622.03800000000001,625.50300000000004,628.96600000000001,632.42600000000004,635.88400000000001,639.34199999999998,642.798,646.25199999999995,649.70600000000002,653.15800000000002,656.60799999999995,660.05799999999999,663.50599999999997,666.95299999999997,670.39800000000002,673.84199999999998,677.28499999999997,680.72699999999998,684.16499999999996,687.60199999999998,691.03999999999996,694.476,697.91099999999994,701.34500000000003,704.77499999999998,708.20399999999995,711.63400000000001,715.06299999999999,718.49000000000001,721.91200000000003,725.33600000000001,728.75999999999999,732.17999999999995,735.59900000000005,739.01800000000003,742.43399999999997,745.84900000000005,749.26499999999999,752.67499999999995,756.08799999999997,759.49800000000005,762.90599999999995,766.31299999999999,769.71900000000005,773.12400000000002,776.52700000000004,779.92899999999997,783.33000000000004,786.72900000000004,790.12699999999995,793.524,796.91899999999998,800.31200000000001,803.70500000000004,807.09699999999998,810.48500000000001,813.87400000000002,817.26199999999994,820.64700000000005,824.03200000000004,827.41600000000005,830.79700000000003,834.17899999999997,837.55700000000002,840.93600000000004,844.31200000000001,847.68799999999999,851.06100000000004,854.43299999999999,857.80600000000004,861.17499999999995,864.54300000000001,867.90999999999997,871.27800000000002,874.64200000000005,878.005,881.36699999999996,884.72799999999995,888.08699999999999,891.44500000000005,894.80200000000002,898.15700000000004,901.51099999999997,904.86400000000003,908.21600000000001,911.56700000000001,914.91399999999999,918.26199999999994,921.60900000000004,924.95399999999995,928.29600000000005,931.63900000000001,934.98099999999999,938.32000000000005,941.65899999999999,944.995,948.33199999999999,951.66499999999996,954.99900000000002,958.33000000000004,961.65999999999997,964.99099999999999,968.31799999999998,971.64400000000001,974.971,978.29499999999996,981.61699999999996,984.94000000000005,988.25800000000004,991.57799999999997,994.89599999999996,998.21199999999999,1001.53,1004.84,1008.15,1011.46,1014.77,1018.08,1021.39,1024.7,1028,1031.3,1034.6099999999999,1037.9100000000001,1041.21,1044.51,1047.8,1051.0999999999999,1054.3900000000001,1057.6800000000001,1060.98,1064.27,1067.5599999999999,1070.8399999999999,1074.1300000000001,1077.4200000000001,1080.7,1083.98,1087.27,1090.55,1093.8299999999999,1097.0999999999999,1100.3800000000001,1103.6500000000001,1106.9300000000001,1110.2,1113.47,1116.74,1120.01,1123.28,1126.55,1129.8099999999999,1133.0799999999999,1136.3399999999999,1139.5999999999999,1142.8599999999999,1146.1199999999999,1149.3699999999999,1152.6300000000001,1155.8900000000001,1159.1400000000001,1162.3900000000001,1165.6400000000001,1168.8900000000001,1172.1400000000001,1175.3900000000001,1178.6400000000001,1181.8800000000001,1185.1199999999999,1188.3699999999999,1191.6099999999999,1194.8499999999999,1198.0899999999999,1201.3199999999999,1204.5599999999999,1207.79,1211.03,1214.26,1217.49,1220.72,1223.95,1227.1800000000001,1230.4000000000001,1233.6300000000001,1236.8499999999999,1240.0699999999999,1243.3,1246.52,1249.74,1252.95,1256.1700000000001,1259.3800000000001,1262.5999999999999,1265.8099999999999,1269.02,1272.23,1275.4400000000001,1278.6500000000001,1281.8499999999999,1285.0599999999999,1288.26,1291.46,1294.6700000000001,1297.8699999999999,1301.0699999999999,1304.26,1307.46,1310.6600000000001,1313.8499999999999,1317.04,1320.23,1323.4200000000001,1326.6099999999999,1329.8,1332.99,1336.1700000000001,1339.3599999999999,1342.54,1345.72,1348.9000000000001,1352.0799999999999,1355.26,1358.4400000000001,1361.6099999999999,1364.79,1367.96,1371.1300000000001,1374.3,1377.47,1380.6400000000001,1383.8099999999999,1386.97,1390.1400000000001,1393.3,1396.47,1399.6300000000001,1402.79,1405.95,1409.0999999999999,1412.26,1415.4100000000001,1418.5699999999999,1421.72,1424.8699999999999,1428.02,1431.1700000000001,1434.3199999999999,1437.47,1440.6099999999999,1443.76,1446.9000000000001,1450.04,1453.1800000000001,1456.3199999999999,1459.46,1462.5899999999999,1465.73,1468.8699999999999,1472,1475.1300000000001,1478.26,1481.4000000000001,1484.52,1487.6500000000001,1490.78,1493.9000000000001,1497.03,1500.1500000000001,1503.27,1506.3900000000001,1509.51,1512.6300000000001,1515.74,1518.8599999999999,1521.97,1525.0899999999999,1528.2,1531.3099999999999,1534.4200000000001,1537.53,1540.6400000000001,1543.74,1546.8499999999999,1549.95,1553.05,1556.1600000000001,1559.26,1562.3599999999999,1565.45,1568.55,1571.6500000000001,1574.74,1577.8299999999999,1580.9200000000001,1584.02,1587.1099999999999,1590.1900000000001,1593.28,1596.3699999999999,1599.45,1602.54,1605.6199999999999,1608.7,1611.78,1614.8599999999999,1617.9400000000001,1621.02,1624.0899999999999,1627.1700000000001,1630.24,1633.3099999999999,1636.3800000000001,1639.45,1642.52,1645.5899999999999,1648.6500000000001,1651.72,1654.78,1657.8499999999999,1660.9100000000001,1663.97,1667.03,1670.0899999999999,1673.1500000000001,1676.2,1679.26,1682.3099999999999,1685.3599999999999,1688.4100000000001,1691.46,1694.51,1697.5599999999999,1700.6099999999999,1703.6500000000001,1706.7,1709.74,1712.78,1715.8299999999999,1718.8599999999999,1721.9000000000001,1724.9400000000001,1727.98,1731.01,1734.05,1737.0799999999999,1740.1099999999999,1743.1400000000001,1746.1700000000001,1749.2,1752.23,1755.25,1758.28,1761.3,1764.3299999999999,1767.3499999999999,1770.3699999999999,1773.3900000000001,1776.4100000000001,1779.4200000000001,1782.4400000000001,1785.46,1788.47,1791.48,1794.49,1797.5,1800.51,1803.52,1806.53,1809.53,1812.54,1815.54,1818.54,1821.54,1824.55,1827.55,1830.54,1833.54,1836.54,1839.53,1842.52,1845.51,1848.51,1851.5,1854.49,1857.48,1860.46,1863.45,1866.4300000000001,1869.4100000000001,1872.4000000000001,1875.3800000000001,1878.3599999999999,1881.3399999999999,1884.3199999999999,1887.29,1890.27,1893.24,1896.22,1899.1900000000001,1902.1600000000001,1905.1300000000001,1908.0999999999999,1911.0699999999999,1914.03,1917,1919.96,1922.9300000000001,1925.8900000000001,1928.8499999999999,1931.8099999999999,1934.77,1937.4300000000001,1940.4000000000001,1943.3599999999999,1946.3299999999999,1949.3,1952.27,1955.23,1958.1900000000001,1961.1600000000001,1964.1199999999999,1967.0799999999999,1970.04,1972.99,1975.95,1978.9100000000001,1981.8599999999999,1984.8199999999999,1987.77,1990.72,1993.6700000000001,1996.6199999999999,1999.5699999999999,2002.52,2005.46,2008.4100000000001,2011.3499999999999,2014.29,2017.24,2020.1800000000001,2023.1199999999999,2026.05,2028.99,2031.9300000000001,2034.8699999999999,2037.8,2040.73,2043.6600000000001,2046.5999999999999,2049.52,2052.4499999999998,2055.3800000000001,2058.3099999999999,2061.23,2064.1599999999999,2067.0799999999999,2070,2072.9299999999998,2075.8499999999999,2078.77,2081.6799999999998,2084.5999999999999,2087.52,2090.4299999999998,2093.3400000000001,2096.2600000000002,2099.1700000000001,2102.0799999999999,2104.9899999999998,2107.9000000000001,2110.8099999999999,2113.71,2116.6199999999999,2119.52,2122.4299999999998,2125.3299999999999,2128.23,2131.1300000000001,2134.0300000000002,2136.9299999999998,2139.8200000000002,2142.7199999999998,2145.6100000000001,2148.5100000000002,2151.4000000000001,2154.29,2157.1799999999998,2160.0700000000002,2162.96,2165.8499999999999,2168.73,2171.6199999999999,2174.5,2177.3899999999999,2180.27,2183.1500000000001,2186.0300000000002,2188.9099999999999,2191.79,2194.6700000000001,2197.54,2200.4200000000001,2203.29,2206.1599999999999,2209.0300000000002,2211.9000000000001,2214.77,2217.6399999999999,2220.5100000000002,2223.3800000000001,2226.2399999999998,2229.1100000000001,2231.9699999999998,2234.8299999999999,2237.6900000000001,2240.5500000000002,2243.4099999999999,2246.27,2249.1300000000001,2251.98,2254.8400000000001,2257.6900000000001,2260.54,2263.3899999999999,2266.25,2269.0999999999999,2271.9400000000001,2274.79,2277.6399999999999,2280.4899999999998,2283.3299999999999,2286.1700000000001,2289.02,2291.8600000000001,2294.6999999999998,2297.54,2300.3800000000001,2303.21,2306.0500000000002,2308.8899999999999,2311.7199999999998,2314.5500000000002,2317.3899999999999,2320.2199999999998,2323.0500000000002,2325.8800000000001,2328.6999999999998,2331.5300000000002,2334.3600000000001,2337.1799999999998,2340.0100000000002,2342.8299999999999,2345.6500000000001,2348.4699999999998,2351.29,2354.1100000000001,2356.9299999999998,2359.75,2362.5599999999999,2365.3800000000001,2368.1900000000001,2371,2373.8200000000002,2376.6300000000001,2379.4400000000001,2382.25,2385.0500000000002,2387.8600000000001,2390.6700000000001,2393.4699999999998,2396.2800000000002,2399.0799999999999,2401.8800000000001,2404.6799999999998,2407.48,2410.2800000000002,2413.0799999999999,2415.8699999999999,2418.6700000000001,2421.46,2424.2600000000002,2427.0500000000002,2429.8400000000001,2432.6300000000001,2435.4200000000001,2438.21,2441,2443.79,2446.5700000000002,2449.3600000000001,2452.1399999999999,2454.9200000000001,2457.6999999999998,2460.48,2463.2600000000002,2466.04,2468.8200000000002,2471.5999999999999,2474.3699999999999,2477.1500000000001,2479.9200000000001,2482.6900000000001,2485.4699999999998,2488.2399999999998,2491.0100000000002,2493.77,2496.54,2499.3099999999999,2502.0700000000002,2504.8400000000001,2507.5999999999999,2510.3699999999999,2513.1300000000001,2515.8899999999999,2518.6500000000001,2521.4099999999999,2524.1599999999999,2526.9200000000001,2529.6799999999998,2532.4299999999998,2535.1900000000001,2537.9400000000001,2540.6900000000001,2543.4400000000001,2546.1900000000001,2548.9400000000001,2551.6900000000001,2554.4400000000001,2557.1799999999998,2559.9299999999998,2562.6700000000001,2565.4200000000001,2568.1599999999999,2570.9000000000001,2573.6399999999999,2576.3800000000001,2579.1100000000001,2581.8499999999999,2584.5900000000001,2587.3200000000002,2590.0599999999999,2592.79,2595.52,2598.25,2600.98,2603.7199999999998,2606.4400000000001,2609.1700000000001,2611.9000000000001,2614.6199999999999,2617.3499999999999,2620.0700000000002,2622.79,2625.5100000000002,2628.23,2630.9499999999998,2633.6700000000001,2636.3899999999999,2639.1100000000001,2641.8200000000002,2644.54,2647.25,2649.96,2652.6799999999998,2655.3899999999999,2658.0999999999999,2660.8099999999999,2663.5100000000002,2666.2199999999998,2668.9299999999998,2671.6300000000001,2674.3400000000001,2677.04,2679.7399999999998,2682.4400000000001,2685.1399999999999,2687.8400000000001,2690.54,2693.2399999999998,2695.9400000000001,2698.6300000000001,2701.3299999999999,2704.02,2706.71,2709.4099999999999,2712.0999999999999,2714.79,2717.4699999999998,2720.1599999999999,2722.8499999999999,2725.5300000000002,2728.2199999999998,2730.9000000000001,2733.5900000000001,2736.27,2738.9499999999998,2741.6300000000001,2744.3099999999999,2746.9899999999998,2749.6700000000001,2752.3400000000001,2755.02,2757.6900000000001,2760.3699999999999,2763.04,2765.71,2768.3800000000001,2771.0500000000002,2773.7199999999998,2776.3899999999999,2779.0599999999999,2781.7199999999998,2784.3899999999999,2787.0500000000002,2789.71,2792.3800000000001,2795.04,2797.6999999999998,2800.3600000000001,2803.02,2805.6799999999998,2808.3299999999999,2810.9899999999998,2813.6399999999999,2816.3000000000002,2818.9499999999998,2821.5999999999999,2824.25,2826.9000000000001,2829.5500000000002,2832.1999999999998,2834.8499999999999,2837.4899999999998,2840.1399999999999,2842.7800000000002,2845.4299999999998,2848.0700000000002,2850.71,2853.3499999999999,2855.9899999999998,2858.6300000000001,2861.27,2863.9099999999999,2866.54,2869.1799999999998,2871.8099999999999,2874.4499999999998,2877.0799999999999,2879.71,2882.3400000000001,2884.9699999999998,2887.5999999999999,2890.23,2892.8600000000001,2895.48,2898.1100000000001,2900.73,2903.3499999999999,2905.9699999999998,2908.5999999999999,2911.2199999999998,2913.8400000000001,2916.46,2919.0700000000002,2921.6900000000001,2924.3099999999999,2926.9200000000001,2929.54,2932.1500000000001,2934.7600000000002,2937.3699999999999,2939.98,2942.5900000000001,2945.1999999999998,2947.8099999999999,2950.4200000000001,2953.02,2955.6300000000001,2958.23,2960.8299999999999,2963.4400000000001,2966.04,2968.6399999999999,2971.2399999999998,2973.8299999999999,2976.4299999999998,2979.0300000000002,2981.6300000000001,2984.2199999999998,2986.8099999999999,2989.4099999999999,2992,2994.5900000000001,2997.1799999999998,2999.77,3002.3600000000001,3004.9499999999998,3007.5300000000002,3010.1199999999999,3012.6999999999998,3015.29,3017.8699999999999,3020.4499999999998,3023.04,3025.6199999999999,3028.1999999999998,3030.77,3033.3499999999999,3035.9299999999998,3038.5,3041.0799999999999,3043.6500000000001,3046.23,3048.8000000000002,3051.3699999999999,3053.9400000000001,3056.5100000000002,3059.0799999999999,3061.6500000000001,3064.21,3066.7800000000002,3069.3499999999999,3071.9099999999999,3074.4699999999998,3077.04,3079.5999999999999,3082.1599999999999,3084.7199999999998,3087.2800000000002,3089.8299999999999,3092.3899999999999,3094.9499999999998,3097.5,3100.0599999999999,3102.6100000000001,3105.1599999999999,3107.7199999999998,3110.27,3112.8200000000002,3115.3699999999999,3117.9099999999999,3120.46,3123.0100000000002,3125.5599999999999,3128.0999999999999,3130.6399999999999,3133.1900000000001,3135.73,3138.27,3140.8099999999999,3143.3499999999999,3145.8899999999999,3148.4299999999998,3150.96,3153.5,3156.0300000000002,3158.5700000000002,3161.0999999999999,3163.6399999999999,3166.1700000000001,3168.6999999999998,3171.23,3173.7600000000002,3175.3000000000002,3177.8400000000001,3180.3800000000001,3182.9099999999999,3185.4499999999998,3187.9899999999998,3190.52,3193.0599999999999,3195.5900000000001,3198.1199999999999],"y":[0,0.030379746835443037,0.027848101265822784,0.024050632911392405,0.025316455696202531,0.020253164556962026,0.024050632911392405,0.022784810126582278,0.027848101265822784,0.025316455696202531,0.027848101265822784,0.022784810126582278,0.02911392405063291,0.032911392405063293,0.027848101265822784,0.034177215189873419,0.032911392405063293,0.025316455696202531,0.018987341772151899,0.030379746835443037,0.045569620253164557,0.039240506329113925,0.032911392405063293,0.024050632911392405,0.036708860759493672,0.020253164556962026,0.032911392405063293,0.022784810126582278,0.045569620253164557,0.039240506329113925,0.030379746835443037,0.041772151898734178,0.027848101265822784,0.026582278481012658,0.041772151898734178,0.040506329113924051,0.040506329113924051,0.060759493670886074,0.054430379746835442,0.065822784810126586,0.051898734177215189,0.059493670886075947,0.041772151898734178,0.058227848101265821,0.049367088607594936,0.034177215189873419,0.049367088607594936,0.046835443037974683,0.044303797468354431,0.037974683544303799,0.026582278481012658,0.032911392405063293,0.034177215189873419,0.040506329113924051,0.040506329113924051,0.021518987341772152,0.035443037974683546,0.036708860759493672,0.030379746835443037,0.026582278481012658,0.036708860759493672,0.040506329113924051,0.030379746835443037,0.026582278481012658,0.022784810126582278,0.036708860759493672,0.037974683544303799,0.040506329113924051,0.035443037974683546,0.032911392405063293,0.024050632911392405,0.04810126582278481,0.045569620253164557,0.045569620253164557,0.039240506329113925,0.036708860759493672,0.02911392405063291,0.049367088607594936,0.045569620253164557,0.034177215189873419,0.036708860759493672,0.041772151898734178,0.059493670886075947,0.046835443037974683,0.046835443037974683,0.051898734177215189,0.064556962025316453,0.060759493670886074,0.060759493670886074,0.067088607594936706,0.050632911392405063,0.050632911392405063,0.051898734177215189,0.043037974683544304,0.041772151898734178,0.027848101265822784,0.022784810126582278,0.039240506329113925,0.044303797468354431,0.041772151898734178,0.027848101265822784,0.041772151898734178,0.041772151898734178,0.021518987341772152,0.030379746835443037,0.02911392405063291,0.044303797468354431,0.040506329113924051,0.04810126582278481,0.060759493670886074,0.02911392405063291,0.04810126582278481,0.036708860759493672,0.036708860759493672,0.045569620253164557,0.032911392405063293,0.045569620253164557,0.036708860759493672,0.049367088607594936,0.035443037974683546,0.032911392405063293,0.050632911392405063,0.035443037974683546,0.035443037974683546,0.035443037974683546,0.043037974683544304,0.036708860759493672,0.037974683544303799,0.034177215189873419,0.044303797468354431,0.046835443037974683,0.034177215189873419,0.030379746835443037,0.045569620253164557,0.045569620253164557,0.055696202531645568,0.046835443037974683,0.044303797468354431,0.036708860759493672,0.037974683544303799,0.055696202531645568,0.045569620253164557,0.050632911392405063,0.043037974683544304,0.037974683544303799,0.051898734177215189,0.039240506329113925,0.04810126582278481,0.037974683544303799,0.031645569620253167,0.037974683544303799,0.041772151898734178,0.044303797468354431,0.034177215189873419,0.053164556962025315,0.04810126582278481,0.031645569620253167,0.043037974683544304,0.045569620253164557,0.045569620253164557,0.063291139240506333,0.049367088607594936,0.034177215189873419,0.053164556962025315,0.034177215189873419,0.031645569620253167,0.039240506329113925,0.034177215189873419,0.046835443037974683,0.043037974683544304,0.060759493670886074,0.041772151898734178,0.059493670886075947,0.031645569620253167,0.060759493670886074,0.049367088607594936,0.04810126582278481,0.041772151898734178,0.055696202531645568,0.044303797468354431,0.020253164556962026,0.056962025316455694,0.050632911392405063,0.032911392405063293,0.055696202531645568,0.051898734177215189,0.040506329113924051,0.049367088607594936,0.04810126582278481,0.050632911392405063,0.0620253164556962,0.041772151898734178,0.043037974683544304,0.04810126582278481,0.046835443037974683,0.053164556962025315,0.044303797468354431,0.034177215189873419,0.043037974683544304,0.051898734177215189,0.039240506329113925,0.060759493670886074,0.041772151898734178,0.04810126582278481,0.054430379746835442,0.063291139240506333,0.041772151898734178,0.049367088607594936,0.049367088607594936,0.0620253164556962,0.075949367088607597,0.065822784810126586,0.055696202531645568,0.063291139240506333,0.073417721518987344,0.065822784810126586,0.054430379746835442,0.050632911392405063,0.072151898734177211,0.081012658227848103,0.088607594936708861,0.12911392405063291,0.14810126582278482,0.0949367088607595,0.069620253164556958,0.063291139240506333,0.058227848101265821,0.074683544303797464,0.067088607594936706,0.072151898734177211,0.051898734177215189,0.067088607594936706,0.04810126582278481,0.068354430379746839,0.058227848101265821,0.060759493670886074,0.055696202531645568,0.069620253164556958,0.067088607594936706,0.070886075949367092,0.087341772151898728,0.11772151898734177,0.15443037974683543,0.086075949367088608,0.068354430379746839,0.056962025316455694,0.070886075949367092,0.063291139240506333,0.063291139240506333,0.063291139240506333,0.070886075949367092,0.059493670886075947,0.050632911392405063,0.068354430379746839,0.067088607594936706,0.0949367088607595,0.056962025316455694,0.072151898734177211,0.0620253164556962,0.050632911392405063,0.058227848101265821,0.063291139240506333,0.053164556962025315,0.07848101265822785,0.069620253164556958,0.050632911392405063,0.051898734177215189,0.053164556962025315,0.069620253164556958,0.051898734177215189,0.054430379746835442,0.065822784810126586,0.053164556962025315,0.04810126582278481,0.069620253164556958,0.072151898734177211,0.065822784810126586,0.060759493670886074,0.051898734177215189,0.04810126582278481,0.070886075949367092,0.058227848101265821,0.067088607594936706,0.049367088607594936,0.073417721518987344,0.063291139240506333,0.077215189873417717,0.0620253164556962,0.063291139240506333,0.077215189873417717,0.070886075949367092,0.0949367088607595,0.12911392405063291,0.22025316455696203,0.14810126582278482,0.10000000000000001,0.0949367088607595,0.077215189873417717,0.064556962025316453,0.07848101265822785,0.063291139240506333,0.067088607594936706,0.087341772151898728,0.063291139240506333,0.051898734177215189,0.070886075949367092,0.070886075949367092,0.055696202531645568,0.070886075949367092,0.058227848101265821,0.07848101265822785,0.050632911392405063,0.053164556962025315,0.056962025316455694,0.073417721518987344,0.060759493670886074,0.093670886075949367,0.072151898734177211,0.054430379746835442,0.082278481012658222,0.069620253164556958,0.064556962025316453,0.073417721518987344,0.0620253164556962,0.075949367088607597,0.056962025316455694,0.083544303797468356,0.086075949367088608,0.064556962025316453,0.084810126582278475,0.084810126582278475,0.10632911392405063,0.10886075949367088,0.097468354430379753,0.10126582278481013,0.10632911392405063,0.12531645569620253,0.12278481012658228,0.18101265822784809,0.19240506329113924,0.17721518987341772,0.13037974683544304,0.11518987341772152,0.11392405063291139,0.12784810126582277,0.13924050632911392,0.14810126582278482,0.12784810126582277,0.11139240506329114,0.0949367088607595,0.074683544303797464,0.084810126582278475,0.091139240506329114,0.077215189873417717,0.089873417721518981,0.086075949367088608,0.087341772151898728,0.074683544303797464,0.086075949367088608,0.084810126582278475,0.074683544303797464,0.084810126582278475,0.060759493670886074,0.0620253164556962,0.069620253164556958,0.10000000000000001,0.087341772151898728,0.10000000000000001,0.10000000000000001,0.097468354430379753,0.075949367088607597,0.074683544303797464,0.096202531645569619,0.0620253164556962,0.058227848101265821,0.079746835443037969,0.088607594936708861,0.083544303797468356,0.075949367088607597,0.074683544303797464,0.081012658227848103,0.093670886075949367,0.082278481012658222,0.07848101265822785,0.091139240506329114,0.072151898734177211,0.073417721518987344,0.084810126582278475,0.089873417721518981,0.056962025316455694,0.059493670886075947,0.07848101265822785,0.065822784810126586,0.073417721518987344,0.081012658227848103,0.089873417721518981,0.079746835443037969,0.07848101265822785,0.075949367088607597,0.079746835443037969,0.079746835443037969,0.079746835443037969,0.079746835443037969,0.088607594936708861,0.091139240506329114,0.097468354430379753,0.086075949367088608,0.082278481012658222,0.091139240506329114,0.10379746835443038,0.068354430379746839,0.093670886075949367,0.07848101265822785,0.0949367088607595,0.098734177215189872,0.082278481012658222,0.088607594936708861,0.091139240506329114,0.096202531645569619,0.088607594936708861,0.093670886075949367,0.070886075949367092,0.077215189873417717,0.10253164556962026,0.086075949367088608,0.10000000000000001,0.088607594936708861,0.10000000000000001,0.10126582278481013,0.10632911392405063,0.088607594936708861,0.07848101265822785,0.091139240506329114,0.086075949367088608,0.092405063291139247,0.074683544303797464,0.092405063291139247,0.084810126582278475,0.082278481012658222,0.088607594936708861,0.086075949367088608,0.097468354430379753,0.093670886075949367,0.10126582278481013,0.075949367088607597,0.10000000000000001,0.093670886075949367,0.081012658227848103,0.096202531645569619,0.093670886075949367,0.093670886075949367,0.12025316455696203,0.12025316455696203,0.10253164556962026,0.089873417721518981,0.086075949367088608,0.11392405063291139,0.10000000000000001,0.093670886075949367,0.091139240506329114,0.096202531645569619,0.10253164556962026,0.10632911392405063,0.093670886075949367,0.10253164556962026,0.0949367088607595,0.11139240506329114,0.10126582278481013,0.10506329113924051,0.11265822784810127,0.11392405063291139,0.10379746835443038,0.11139240506329114,0.10886075949367088,0.10632911392405063,0.10886075949367088,0.10379746835443038,0.10253164556962026,0.10506329113924051,0.10506329113924051,0.10000000000000001,0.096202531645569619,0.10253164556962026,0.10759493670886076,0.10506329113924051,0.10379746835443038,0.10886075949367088,0.10379746835443038,0.096202531645569619,0.10000000000000001,0.10632911392405063,0.10379746835443038,0.087341772151898728,0.10253164556962026,0.092405063291139247,0.10126582278481013,0.10632911392405063,0.11265822784810127,0.10253164556962026,0.093670886075949367,0.10379746835443038,0.10253164556962026,0.10253164556962026,0.11012658227848102,0.084810126582278475,0.11012658227848102,0.1240506329113924,0.11772151898734177,0.10506329113924051,0.0949367088607595,0.10506329113924051,0.11898734177215189,0.10886075949367088,0.10379746835443038,0.10759493670886076,0.11392405063291139,0.089873417721518981,0.10126582278481013,0.11139240506329114,0.11392405063291139,0.12531645569620253,0.10506329113924051,0.097468354430379753,0.11139240506329114,0.12151898734177215,0.12151898734177215,0.10126582278481013,0.1240506329113924,0.10000000000000001,0.11898734177215189,0.10000000000000001,0.11645569620253164,0.11139240506329114,0.10000000000000001,0.11645569620253164,0.11265822784810127,0.10886075949367088,0.11392405063291139,0.10886075949367088,0.13417721518987341,0.11392405063291139,0.10126582278481013,0.11265822784810127,0.11012658227848102,0.10379746835443038,0.13924050632911392,0.13291139240506328,0.12278481012658228,0.10379746835443038,0.11898734177215189,0.13291139240506328,0.12025316455696203,0.12658227848101267,0.1240506329113924,0.14050632911392405,0.13164556962025317,0.13037974683544304,0.11772151898734177,0.12658227848101267,0.13924050632911392,0.13797468354430381,0.13797468354430381,0.13164556962025317,0.13164556962025317,0.1240506329113924,0.12658227848101267,0.12151898734177215,0.13291139240506328,0.11898734177215189,0.14430379746835442,0.11898734177215189,0.14177215189873418,0.12911392405063291,0.12784810126582277,0.13291139240506328,0.15189873417721519,0.13544303797468354,0.14556962025316456,0.1240506329113924,0.12278481012658228,0.14050632911392405,0.13291139240506328,0.12784810126582277,0.12911392405063291,0.12278481012658228,0.13797468354430381,0.12278481012658228,0.12025316455696203,0.12911392405063291,0.14556962025316456,0.13924050632911392,0.13924050632911392,0.11772151898734177,0.11139240506329114,0.12151898734177215,0.12784810126582277,0.13797468354430381,0.14177215189873418,0.12658227848101267,0.12531645569620253,0.11645569620253164,0.12025316455696203,0.13037974683544304,0.13544303797468354,0.14050632911392405,0.13291139240506328,0.11645569620253164,0.14683544303797469,0.097468354430379753,0.11012658227848102,0.12278481012658228,0.10632911392405063,0.13797468354430381,0.12911392405063291,0.13544303797468354,0.12025316455696203,0.13291139240506328,0.11645569620253164,0.11265822784810127,0.12151898734177215,0.1240506329113924,0.11139240506329114,0.11898734177215189,0.13924050632911392,0.13037974683544304,0.12278481012658228,0.11772151898734177,0.11772151898734177,0.11645569620253164,0.11139240506329114,0.11392405063291139,0.11392405063291139,0.11898734177215189,0.10379746835443038,0.11012658227848102,0.11139240506329114,0.13037974683544304,0.11392405063291139,0.10632911392405063,0.10506329113924051,0.11645569620253164,0.097468354430379753,0.12025316455696203,0.11898734177215189,0.10379746835443038,0.10379746835443038,0.11772151898734177,0.13164556962025317,0.098734177215189872,0.10253164556962026,0.087341772151898728,0.10632911392405063,0.088607594936708861,0.11518987341772152,0.10506329113924051,0.10759493670886076,0.10759493670886076,0.10886075949367088,0.11012658227848102,0.10886075949367088,0.0949367088607595,0.10632911392405063,0.10253164556962026,0.088607594936708861,0.092405063291139247,0.10000000000000001,0.0949367088607595,0.092405063291139247,0.097468354430379753,0.089873417721518981,0.088607594936708861,0.10379746835443038,0.10253164556962026,0.097468354430379753,0.097468354430379753,0.10886075949367088,0.097468354430379753,0.11265822784810127,0.10379746835443038,0.10253164556962026,0.096202531645569619,0.10379746835443038,0.097468354430379753,0.096202531645569619,0.091139240506329114,0.096202531645569619,0.091139240506329114,0.10000000000000001,0.10253164556962026,0.087341772151898728,0.097468354430379753,0.10886075949367088,0.10886075949367088,0.10000000000000001,0.092405063291139247,0.10000000000000001,0.10886075949367088,0.092405063291139247,0.092405063291139247,0.10126582278481013,0.0949367088607595,0.089873417721518981,0.096202531645569619,0.092405063291139247,0.092405063291139247,0.096202531645569619,0.087341772151898728,0.10506329113924051,0.088607594936708861,0.093670886075949367,0.092405063291139247,0.097468354430379753,0.11518987341772152,0.093670886075949367,0.10126582278481013,0.10632911392405063,0.088607594936708861,0.089873417721518981,0.10000000000000001,0.091139240506329114,0.093670886075949367,0.081012658227848103,0.086075949367088608,0.10253164556962026,0.0949367088607595,0.083544303797468356,0.088607594936708861,0.10126582278481013,0.10000000000000001,0.063291139240506333,0.084810126582278475,0.098734177215189872,0.0949367088607595,0.098734177215189872,0.087341772151898728,0.087341772151898728,0.084810126582278475,0.069620253164556958,0.098734177215189872,0.088607594936708861,0.0949367088607595,0.091139240506329114,0.082278481012658222,0.097468354430379753,0.074683544303797464,0.093670886075949367,0.077215189873417717,0.077215189873417717,0.091139240506329114,0.093670886075949367,0.093670886075949367,0.087341772151898728,0.11139240506329114,0.088607594936708861,0.10000000000000001,0.10126582278481013,0.069620253164556958,0.088607594936708861,0.098734177215189872,0.097468354430379753,0.079746835443037969,0.10379746835443038,0.083544303797468356,0.079746835443037969,0.088607594936708861,0.069620253164556958,0.082278481012658222,0.093670886075949367,0.096202531645569619,0.097468354430379753,0.092405063291139247,0.11772151898734177,0.098734177215189872,0.089873417721518981,0.092405063291139247,0.12911392405063291,0.11392405063291139,0.12658227848101267,0.12278481012658228,0.13164556962025317,0.12025316455696203,0.13417721518987341,0.11265822784810127,0.10759493670886076,0.10506329113924051,0.096202531645569619,0.088607594936708861,0.10379746835443038,0.098734177215189872,0.070886075949367092,0.093670886075949367,0.10253164556962026,0.089873417721518981,0.069620253164556958,0.093670886075949367,0.0949367088607595,0.091139240506329114,0.091139240506329114,0.093670886075949367,0.096202531645569619,0.089873417721518981,0.087341772151898728,0.081012658227848103,0.084810126582278475,0.096202531645569619,0.087341772151898728,0.097468354430379753,0.10126582278481013,0.096202531645569619,0.092405063291139247,0.0949367088607595,0.11518987341772152,0.0949367088607595,0.098734177215189872,0.11139240506329114,0.10886075949367088,0.11772151898734177,0.10126582278481013,0.11392405063291139,0.13291139240506328,0.13417721518987341,0.15443037974683543,0.18101265822784809,0.22025316455696203,0.35063291139240504,0.44556962025316454,0.53924050632911391,0.58607594936708862,0.55569620253164553,0.51265822784810122,0.45822784810126582,0.41772151898734178,0.38860759493670888,0.36962025316455699,0.35316455696202531,0.35696202531645571,0.35316455696202531,0.39113924050632909,0.48227848101265824,0.69620253164556967,1,0.80759493670886073,0.59240506329113929,0.46455696202531643,0.41265822784810124,0.36962025316455699,0.37468354430379747,0.37341772151898733,0.35696202531645571,0.32025316455696201,0.28860759493670884,0.29240506329113924,0.26835443037974682,0.2481012658227848,0.23797468354430379,0.24430379746835443,0.2189873417721519,0.22911392405063291,0.23544303797468355,0.25316455696202533,0.22784810126582278,0.19620253164556961,0.20253164556962025,0.17215189873417722,0.15443037974683543,0.10253164556962026,0.11772151898734177,0.10632911392405063,0.11012658227848102,0.0949367088607595,0.10506329113924051,0.11139240506329114,0.10000000000000001,0.10253164556962026,0.086075949367088608,0.082278481012658222,0.089873417721518981,0.0949367088607595,0.077215189873417717,0.10379746835443038,0.087341772151898728,0.097468354430379753,0.087341772151898728,0.086075949367088608,0.088607594936708861,0.079746835443037969,0.079746835443037969,0.10000000000000001,0.086075949367088608,0.067088607594936706,0.074683544303797464,0.092405063291139247,0.084810126582278475,0.073417721518987344,0.064556962025316453,0.087341772151898728,0.083544303797468356,0.059493670886075947,0.079746835443037969,0.091139240506329114,0.058227848101265821,0.068354430379746839,0.069620253164556958,0.091139240506329114,0.077215189873417717,0.069620253164556958,0.075949367088607597,0.083544303797468356,0.074683544303797464,0.075949367088607597,0.083544303797468356,0.075949367088607597,0.070886075949367092,0.077215189873417717,0.075949367088607597,0.084810126582278475,0.077215189873417717,0.07848101265822785,0.077215189873417717,0.069620253164556958,0.070886075949367092,0.081012658227848103,0.063291139240506333,0.081012658227848103,0.072151898734177211,0.068354430379746839,0.0620253164556962,0.070886075949367092,0.072151898734177211,0.063291139240506333,0.060759493670886074,0.073417721518987344,0.072151898734177211,0.059493670886075947,0.060759493670886074,0.064556962025316453,0.064556962025316453,0.064556962025316453,0.069620253164556958,0.068354430379746839,0.064556962025316453,0.0620253164556962,0.053164556962025315,0.054430379746835442,0.064556962025316453,0.064556962025316453,0.059493670886075947,0.060759493670886074,0.069620253164556958,0.0620253164556962,0.053164556962025315,0.059493670886075947,0.0620253164556962,0.063291139240506333,0.064556962025316453,0.0620253164556962,0.064556962025316453,0.056962025316455694,0.064556962025316453,0.056962025316455694,0.056962025316455694,0.0620253164556962,0.0620253164556962,0.051898734177215189],"name":"x2","line":{"color":"rgb(255,0,0)","dash":"dot"},"showlegend":false,"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="maps">Maps<a class="anchor" aria-label="anchor" href="#maps"></a>
</h3>
<p>Spectral maps can also be visualized as overlaid spectra but in
addition the spatial information can be plotted as a heatmap. It is
important to note that when multiple spectra are uploaded in batch they
are prescribed <code>x</code> and <code>y</code> coordinates, this can
be helpful for visualizing summary statistics and navigating vast
amounts of data but shouldn’t be confused with data which actually has
spatial coordinates.</p>
<p>In R the user can control what values form the colors of the heatmap
by specifying <code>z</code>, it is handy to put the information you
want in the metadata for this reason. This example just shows the x
values of the spectra.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/interactive_plots.html">heatmap_spec</a></span><span class="op">(</span><span class="va">spectral_map</span>,</span>
<span>             z <span class="op">=</span> <span class="va">spectral_map</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>An interactive plot of the heatmap and spectra overlayed can be
generated with the <code><a href="../reference/interactive_plots.html">interactive_plot()</a></code> function. A user can
hover over the heatmap to identify the next row id they are interested
in and update the value of select to see that spectrum.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/interactive_plots.html">interactive_plot</a></span><span class="op">(</span><span class="va">spectral_map</span>, select <span class="op">=</span> <span class="fl">100</span>, z <span class="op">=</span> <span class="va">spectral_map</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"data":[{"colorbar":{"title":"","ticklen":2},"colorscale":"Viridis","showscale":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12],"z":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12],"type":"heatmap","hoverinfo":"text","text":["row:  1 <br>x:  0 , y:  0 , z:  0  ","row:  2 <br>x:  1 , y:  0 , z:  0  ","row:  3 <br>x:  2 , y:  0 , z:  0  ","row:  4 <br>x:  3 , y:  0 , z:  0  ","row:  5 <br>x:  4 , y:  0 , z:  0  ","row:  6 <br>x:  5 , y:  0 , z:  0  ","row:  7 <br>x:  6 , y:  0 , z:  0  ","row:  8 <br>x:  7 , y:  0 , z:  0  ","row:  9 <br>x:  8 , y:  0 , z:  0  ","row:  10 <br>x:  9 , y:  0 , z:  0  ","row:  11 <br>x:  10 , y:  0 , z:  0  ","row:  12 <br>x:  11 , y:  0 , z:  0  ","row:  13 <br>x:  12 , y:  0 , z:  0  ","row:  14 <br>x:  13 , y:  0 , z:  0  ","row:  15 <br>x:  14 , y:  0 , z:  0  ","row:  16 <br>x:  15 , y:  0 , z:  0  ","row:  17 <br>x:  0 , y:  1 , z:  1  ","row:  18 <br>x:  1 , y:  1 , z:  1  ","row:  19 <br>x:  2 , y:  1 , z:  1  ","row:  20 <br>x:  3 , y:  1 , z:  1  ","row:  21 <br>x:  4 , y:  1 , z:  1  ","row:  22 <br>x:  5 , y:  1 , z:  1  ","row:  23 <br>x:  6 , y:  1 , z:  1  ","row:  24 <br>x:  7 , y:  1 , z:  1  ","row:  25 <br>x:  8 , y:  1 , z:  1  ","row:  26 <br>x:  9 , y:  1 , z:  1  ","row:  27 <br>x:  10 , y:  1 , z:  1  ","row:  28 <br>x:  11 , y:  1 , z:  1  ","row:  29 <br>x:  12 , y:  1 , z:  1  ","row:  30 <br>x:  13 , y:  1 , z:  1  ","row:  31 <br>x:  14 , y:  1 , z:  1  ","row:  32 <br>x:  15 , y:  1 , z:  1  ","row:  33 <br>x:  0 , y:  2 , z:  2  ","row:  34 <br>x:  1 , y:  2 , z:  2  ","row:  35 <br>x:  2 , y:  2 , z:  2  ","row:  36 <br>x:  3 , y:  2 , z:  2  ","row:  37 <br>x:  4 , y:  2 , z:  2  ","row:  38 <br>x:  5 , y:  2 , z:  2  ","row:  39 <br>x:  6 , y:  2 , z:  2  ","row:  40 <br>x:  7 , y:  2 , z:  2  ","row:  41 <br>x:  8 , y:  2 , z:  2  ","row:  42 <br>x:  9 , y:  2 , z:  2  ","row:  43 <br>x:  10 , y:  2 , z:  2  ","row:  44 <br>x:  11 , y:  2 , z:  2  ","row:  45 <br>x:  12 , y:  2 , z:  2  ","row:  46 <br>x:  13 , y:  2 , z:  2  ","row:  47 <br>x:  14 , y:  2 , z:  2  ","row:  48 <br>x:  15 , y:  2 , z:  2  ","row:  49 <br>x:  0 , y:  3 , z:  3  ","row:  50 <br>x:  1 , y:  3 , z:  3  ","row:  51 <br>x:  2 , y:  3 , z:  3  ","row:  52 <br>x:  3 , y:  3 , z:  3  ","row:  53 <br>x:  4 , y:  3 , z:  3  ","row:  54 <br>x:  5 , y:  3 , z:  3  ","row:  55 <br>x:  6 , y:  3 , z:  3  ","row:  56 <br>x:  7 , y:  3 , z:  3  ","row:  57 <br>x:  8 , y:  3 , z:  3  ","row:  58 <br>x:  9 , y:  3 , z:  3  ","row:  59 <br>x:  10 , y:  3 , z:  3  ","row:  60 <br>x:  11 , y:  3 , z:  3  ","row:  61 <br>x:  12 , y:  3 , z:  3  ","row:  62 <br>x:  13 , y:  3 , z:  3  ","row:  63 <br>x:  14 , y:  3 , z:  3  ","row:  64 <br>x:  15 , y:  3 , z:  3  ","row:  65 <br>x:  0 , y:  4 , z:  4  ","row:  66 <br>x:  1 , y:  4 , z:  4  ","row:  67 <br>x:  2 , y:  4 , z:  4  ","row:  68 <br>x:  3 , y:  4 , z:  4  ","row:  69 <br>x:  4 , y:  4 , z:  4  ","row:  70 <br>x:  5 , y:  4 , z:  4  ","row:  71 <br>x:  6 , y:  4 , z:  4  ","row:  72 <br>x:  7 , y:  4 , z:  4  ","row:  73 <br>x:  8 , y:  4 , z:  4  ","row:  74 <br>x:  9 , y:  4 , z:  4  ","row:  75 <br>x:  10 , y:  4 , z:  4  ","row:  76 <br>x:  11 , y:  4 , z:  4  ","row:  77 <br>x:  12 , y:  4 , z:  4  ","row:  78 <br>x:  13 , y:  4 , z:  4  ","row:  79 <br>x:  14 , y:  4 , z:  4  ","row:  80 <br>x:  15 , y:  4 , z:  4  ","row:  81 <br>x:  0 , y:  5 , z:  5  ","row:  82 <br>x:  1 , y:  5 , z:  5  ","row:  83 <br>x:  2 , y:  5 , z:  5  ","row:  84 <br>x:  3 , y:  5 , z:  5  ","row:  85 <br>x:  4 , y:  5 , z:  5  ","row:  86 <br>x:  5 , y:  5 , z:  5  ","row:  87 <br>x:  6 , y:  5 , z:  5  ","row:  88 <br>x:  7 , y:  5 , z:  5  ","row:  89 <br>x:  8 , y:  5 , z:  5  ","row:  90 <br>x:  9 , y:  5 , z:  5  ","row:  91 <br>x:  10 , y:  5 , z:  5  ","row:  92 <br>x:  11 , y:  5 , z:  5  ","row:  93 <br>x:  12 , y:  5 , z:  5  ","row:  94 <br>x:  13 , y:  5 , z:  5  ","row:  95 <br>x:  14 , y:  5 , z:  5  ","row:  96 <br>x:  15 , y:  5 , z:  5  ","row:  97 <br>x:  0 , y:  6 , z:  6  ","row:  98 <br>x:  1 , y:  6 , z:  6  ","row:  99 <br>x:  2 , y:  6 , z:  6  ","row:  100 <br>x:  3 , y:  6 , z:  6  ","row:  101 <br>x:  4 , y:  6 , z:  6  ","row:  102 <br>x:  5 , y:  6 , z:  6  ","row:  103 <br>x:  6 , y:  6 , z:  6  ","row:  104 <br>x:  7 , y:  6 , z:  6  ","row:  105 <br>x:  8 , y:  6 , z:  6  ","row:  106 <br>x:  9 , y:  6 , z:  6  ","row:  107 <br>x:  10 , y:  6 , z:  6  ","row:  108 <br>x:  11 , y:  6 , z:  6  ","row:  109 <br>x:  12 , y:  6 , z:  6  ","row:  110 <br>x:  13 , y:  6 , z:  6  ","row:  111 <br>x:  14 , y:  6 , z:  6  ","row:  112 <br>x:  15 , y:  6 , z:  6  ","row:  113 <br>x:  0 , y:  7 , z:  7  ","row:  114 <br>x:  1 , y:  7 , z:  7  ","row:  115 <br>x:  2 , y:  7 , z:  7  ","row:  116 <br>x:  3 , y:  7 , z:  7  ","row:  117 <br>x:  4 , y:  7 , z:  7  ","row:  118 <br>x:  5 , y:  7 , z:  7  ","row:  119 <br>x:  6 , y:  7 , z:  7  ","row:  120 <br>x:  7 , y:  7 , z:  7  ","row:  121 <br>x:  8 , y:  7 , z:  7  ","row:  122 <br>x:  9 , y:  7 , z:  7  ","row:  123 <br>x:  10 , y:  7 , z:  7  ","row:  124 <br>x:  11 , y:  7 , z:  7  ","row:  125 <br>x:  12 , y:  7 , z:  7  ","row:  126 <br>x:  13 , y:  7 , z:  7  ","row:  127 <br>x:  14 , y:  7 , z:  7  ","row:  128 <br>x:  15 , y:  7 , z:  7  ","row:  129 <br>x:  0 , y:  8 , z:  8  ","row:  130 <br>x:  1 , y:  8 , z:  8  ","row:  131 <br>x:  2 , y:  8 , z:  8  ","row:  132 <br>x:  3 , y:  8 , z:  8  ","row:  133 <br>x:  4 , y:  8 , z:  8  ","row:  134 <br>x:  5 , y:  8 , z:  8  ","row:  135 <br>x:  6 , y:  8 , z:  8  ","row:  136 <br>x:  7 , y:  8 , z:  8  ","row:  137 <br>x:  8 , y:  8 , z:  8  ","row:  138 <br>x:  9 , y:  8 , z:  8  ","row:  139 <br>x:  10 , y:  8 , z:  8  ","row:  140 <br>x:  11 , y:  8 , z:  8  ","row:  141 <br>x:  12 , y:  8 , z:  8  ","row:  142 <br>x:  13 , y:  8 , z:  8  ","row:  143 <br>x:  14 , y:  8 , z:  8  ","row:  144 <br>x:  15 , y:  8 , z:  8  ","row:  145 <br>x:  0 , y:  9 , z:  9  ","row:  146 <br>x:  1 , y:  9 , z:  9  ","row:  147 <br>x:  2 , y:  9 , z:  9  ","row:  148 <br>x:  3 , y:  9 , z:  9  ","row:  149 <br>x:  4 , y:  9 , z:  9  ","row:  150 <br>x:  5 , y:  9 , z:  9  ","row:  151 <br>x:  6 , y:  9 , z:  9  ","row:  152 <br>x:  7 , y:  9 , z:  9  ","row:  153 <br>x:  8 , y:  9 , z:  9  ","row:  154 <br>x:  9 , y:  9 , z:  9  ","row:  155 <br>x:  10 , y:  9 , z:  9  ","row:  156 <br>x:  11 , y:  9 , z:  9  ","row:  157 <br>x:  12 , y:  9 , z:  9  ","row:  158 <br>x:  13 , y:  9 , z:  9  ","row:  159 <br>x:  14 , y:  9 , z:  9  ","row:  160 <br>x:  15 , y:  9 , z:  9  ","row:  161 <br>x:  0 , y:  10 , z:  10  ","row:  162 <br>x:  1 , y:  10 , z:  10  ","row:  163 <br>x:  2 , y:  10 , z:  10  ","row:  164 <br>x:  3 , y:  10 , z:  10  ","row:  165 <br>x:  4 , y:  10 , z:  10  ","row:  166 <br>x:  5 , y:  10 , z:  10  ","row:  167 <br>x:  6 , y:  10 , z:  10  ","row:  168 <br>x:  7 , y:  10 , z:  10  ","row:  169 <br>x:  8 , y:  10 , z:  10  ","row:  170 <br>x:  9 , y:  10 , z:  10  ","row:  171 <br>x:  10 , y:  10 , z:  10  ","row:  172 <br>x:  11 , y:  10 , z:  10  ","row:  173 <br>x:  12 , y:  10 , z:  10  ","row:  174 <br>x:  13 , y:  10 , z:  10  ","row:  175 <br>x:  14 , y:  10 , z:  10  ","row:  176 <br>x:  15 , y:  10 , z:  10  ","row:  177 <br>x:  0 , y:  11 , z:  11  ","row:  178 <br>x:  1 , y:  11 , z:  11  ","row:  179 <br>x:  2 , y:  11 , z:  11  ","row:  180 <br>x:  3 , y:  11 , z:  11  ","row:  181 <br>x:  4 , y:  11 , z:  11  ","row:  182 <br>x:  5 , y:  11 , z:  11  ","row:  183 <br>x:  6 , y:  11 , z:  11  ","row:  184 <br>x:  7 , y:  11 , z:  11  ","row:  185 <br>x:  8 , y:  11 , z:  11  ","row:  186 <br>x:  9 , y:  11 , z:  11  ","row:  187 <br>x:  10 , y:  11 , z:  11  ","row:  188 <br>x:  11 , y:  11 , z:  11  ","row:  189 <br>x:  12 , y:  11 , z:  11  ","row:  190 <br>x:  13 , y:  11 , z:  11  ","row:  191 <br>x:  14 , y:  11 , z:  11  ","row:  192 <br>x:  15 , y:  11 , z:  11  ","row:  193 <br>x:  0 , y:  12 , z:  12  ","row:  194 <br>x:  1 , y:  12 , z:  12  ","row:  195 <br>x:  2 , y:  12 , z:  12  ","row:  196 <br>x:  3 , y:  12 , z:  12  ","row:  197 <br>x:  4 , y:  12 , z:  12  ","row:  198 <br>x:  5 , y:  12 , z:  12  ","row:  199 <br>x:  6 , y:  12 , z:  12  ","row:  200 <br>x:  7 , y:  12 , z:  12  ","row:  201 <br>x:  8 , y:  12 , z:  12  ","row:  202 <br>x:  9 , y:  12 , z:  12  ","row:  203 <br>x:  10 , y:  12 , z:  12  ","row:  204 <br>x:  11 , y:  12 , z:  12  ","row:  205 <br>x:  12 , y:  12 , z:  12  ","row:  206 <br>x:  13 , y:  12 , z:  12  ","row:  207 <br>x:  14 , y:  12 , z:  12  ","row:  208 <br>x:  15 , y:  12 , z:  12  "],"xaxis":"x","yaxis":"y","frame":null},{"x":[3],"y":[6],"type":"scatter","mode":"markers","name":"Selected Spectrum","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"mode":"lines","type":"scatter","x":[717.41999999999996,725.13,732.85000000000002,740.55999999999995,748.27999999999997,755.99000000000001,763.71000000000004,771.41999999999996,779.13,786.85000000000002,794.55999999999995,802.27999999999997,809.99000000000001,817.70000000000005,825.41999999999996,833.13,840.85000000000002,848.55999999999995,856.27999999999997,863.99000000000001,871.70000000000005,879.41999999999996,887.13,894.85000000000002,902.55999999999995,910.26999999999998,917.99000000000001,925.70000000000005,933.41999999999996,941.13,948.85000000000002,956.55999999999995,964.26999999999998,971.99000000000001,979.70000000000005,987.41999999999996,995.13,1002.85,1010.5599999999999,1018.27,1025.99,1033.7,1041.4200000000001,1049.1300000000001,1056.8399999999999,1064.5599999999999,1072.27,1079.99,1087.7,1095.4200000000001,1103.1300000000001,1110.8399999999999,1118.5599999999999,1126.27,1133.99,1141.7,1149.4100000000001,1157.1300000000001,1164.8399999999999,1172.5599999999999,1180.27,1187.99,1195.7,1203.4100000000001,1211.1300000000001,1218.8399999999999,1226.5599999999999,1234.27,1241.98,1249.7,1257.4100000000001,1265.1300000000001,1272.8399999999999,1280.5599999999999,1288.27,1295.98,1303.7,1311.4100000000001,1319.1300000000001,1326.8399999999999,1334.5599999999999,1342.27,1349.98,1357.7,1365.4100000000001,1373.1300000000001,1380.8399999999999,1388.55,1396.27,1403.98,1411.7,1419.4100000000001,1427.1300000000001,1434.8399999999999,1442.55,1450.27,1457.98,1465.7,1473.4100000000001,1481.1300000000001,1488.8399999999999,1496.55,1504.27,1511.98,1519.7,1527.4100000000001,1535.1199999999999,1542.8399999999999,1550.55,1558.27,1565.98,1573.7,1581.4100000000001,1589.1199999999999,1596.8399999999999,1604.55,1612.27,1619.98,1627.6900000000001,1635.4100000000001,1643.1199999999999,1650.8399999999999,1658.55,1666.27,1673.98,1681.6900000000001,1689.4100000000001,1697.1199999999999,1704.8399999999999,1712.55,1720.26,1727.98,1735.6900000000001,1743.4100000000001,1751.1199999999999,1758.8399999999999,1766.55,1774.26,1781.98,1789.6900000000001,1797.4100000000001,1805.1199999999999,1812.8399999999999,1820.55,1828.26,1835.98,1843.6900000000001,1851.4100000000001,1859.1199999999999,1866.8299999999999,1874.55,1882.26,1889.98,1897.6900000000001,1905.4100000000001,1913.1199999999999,1920.8299999999999,1928.55,1936.26,1943.98,1951.6900000000001,1959.4000000000001,1967.1199999999999,1974.8299999999999,1982.55,1990.26,1997.98,2005.6900000000001,2013.4000000000001,2021.1199999999999,2028.8299999999999,2036.55,2044.26,2051.98,2059.6900000000001,2067.4000000000001,2075.1199999999999,2082.8299999999999,2090.5500000000002,2098.2600000000002,2105.9699999999998,2113.6900000000001,2121.4000000000001,2129.1199999999999,2136.8299999999999,2144.5500000000002,2152.2600000000002,2159.9699999999998,2167.6900000000001,2175.4000000000001,2183.1199999999999,2190.8299999999999,2198.54,2206.2600000000002,2213.9699999999998,2221.6900000000001,2229.4000000000001,2237.1199999999999,2244.8299999999999,2252.54,2260.2600000000002,2267.9699999999998,2275.6900000000001,2283.4000000000001,2291.1199999999999,2298.8299999999999,2306.54,2314.2600000000002,2321.9699999999998,2329.6900000000001,2337.4000000000001,2345.1100000000001,2352.8299999999999,2360.54,2368.2600000000002,2375.9699999999998,2383.6900000000001,2391.4000000000001,2399.1100000000001,2406.8299999999999,2414.54,2422.2600000000002,2429.9699999999998,2437.6799999999998,2445.4000000000001,2453.1100000000001,2460.8299999999999,2468.54,2476.2600000000002,2483.9699999999998,2491.6799999999998,2499.4000000000001,2507.1100000000001,2514.8299999999999,2522.54,2530.25,2537.9699999999998,2545.6799999999998,2553.4000000000001,2561.1100000000001,2568.8299999999999,2576.54,2584.25,2591.9699999999998,2599.6799999999998,2607.4000000000001,2615.1100000000001,2622.8299999999999,2630.54,2638.25,2645.9699999999998,2653.6799999999998,2661.4000000000001,2669.1100000000001,2676.8200000000002,2684.54,2692.25,2699.9699999999998,2707.6799999999998,2715.4000000000001,2723.1100000000001,2730.8200000000002,2738.54,2746.25,2753.9699999999998,2761.6799999999998,2769.4000000000001,2777.1100000000001,2784.8200000000002,2792.54,2800.25,2807.9699999999998,2815.6799999999998,2823.3899999999999,2831.1100000000001,2838.8200000000002,2846.54,2854.25,2861.9699999999998,2869.6799999999998,2877.3899999999999,2885.1100000000001,2892.8200000000002,2900.54,2908.25,2915.96,2923.6799999999998,2931.3899999999999,2939.1100000000001,2946.8200000000002,2954.54,2962.25,2969.96,2977.6799999999998,2985.3899999999999,2993.1100000000001,3000.8200000000002,3008.5300000000002,3016.25,3023.96,3031.6799999999998,3039.3899999999999,3047.1100000000001,3054.8200000000002,3062.5300000000002,3070.25,3077.96,3085.6799999999998,3093.3899999999999,3101.1100000000001,3108.8200000000002,3116.5300000000002,3124.25,3131.96,3139.6799999999998,3147.3899999999999,3155.0999999999999,3162.8200000000002,3170.5300000000002,3178.25,3185.96,3193.6799999999998,3201.3899999999999,3209.0999999999999,3216.8200000000002,3224.5300000000002,3232.25,3239.96,3247.6700000000001,3255.3899999999999,3263.0999999999999,3270.8200000000002,3278.5300000000002,3286.25,3293.96,3301.6700000000001,3309.3899999999999,3317.0999999999999,3324.8200000000002,3332.5300000000002,3340.25,3347.96,3355.6700000000001,3363.3899999999999,3371.0999999999999,3378.8200000000002,3386.5300000000002,3394.2399999999998,3401.96,3409.6700000000001,3417.3899999999999,3425.0999999999999,3432.8200000000002,3440.5300000000002,3448.2399999999998,3455.96,3463.6700000000001,3471.3899999999999,3479.0999999999999,3486.8099999999999,3494.5300000000002,3502.2399999999998,3509.96,3517.6700000000001,3525.3899999999999,3533.0999999999999,3540.8099999999999,3548.5300000000002,3556.2399999999998,3563.96,3571.6700000000001,3579.3899999999999,3587.0999999999999,3594.8099999999999,3602.5300000000002,3610.2399999999998,3617.96,3625.6700000000001,3633.3800000000001,3641.0999999999999,3648.8099999999999,3656.5300000000002,3664.2399999999998,3671.96,3679.6700000000001,3687.3800000000001,3695.0999999999999,3702.8099999999999,3710.5300000000002,3718.2399999999998,3725.9499999999998,3733.6700000000001,3741.3800000000001,3749.0999999999999,3756.8099999999999,3764.5300000000002,3772.2399999999998,3779.9499999999998,3787.6700000000001,3795.3800000000001,3803.0999999999999,3810.8099999999999,3818.5300000000002,3826.2399999999998,3833.9499999999998,3841.6700000000001,3849.3800000000001,3857.0999999999999,3864.8099999999999,3872.52,3880.2399999999998,3887.9499999999998,3895.6700000000001,3903.3800000000001,3911.0999999999999,3918.8099999999999,3926.52,3934.2399999999998,3941.9499999999998,3949.6700000000001,3957.3800000000001,3965.0900000000001,3972.8099999999999,3980.52,3988.2399999999998,3995.9499999999998,4003.6700000000001],"y":[0.51695636418374225,0.48689518215791605,0.45217936848860824,0.41889186361714159,0.38819818006906365,0.36085739885687168,0.34169958258902311,0.33434384555387958,0.33344438914606211,0.33115266163136337,0.32975401217209976,0.33641133774170257,0.35047720295679541,0.37326105456895009,0.41015621534488939,0.45010221454655164,0.46841135478929896,0.46632779350234921,0.47666043443653894,0.51985270876738743,0.58433331402432109,0.64352548235855001,0.68759711403908408,0.72376414058978766,0.7469333896483864,0.74675572354202902,0.72736970722144878,0.70216405319476305,0.68291676603849749,0.67336173323724058,0.66952155920795475,0.66771578966350886,0.67654563279141111,0.70257748639917827,0.72953037409094712,0.74455632267806371,0.75649906270111744,0.77148471169818245,0.78762156632271696,0.80233555549331825,0.81194245589644753,0.81730180850063894,0.82574277508079774,0.83811219788571534,0.85034506596463044,0.86326499856516059,0.87451606425737738,0.88248033597449305,0.89054306625838253,0.89643759161995828,0.89868723650518945,0.8998441536572922,0.89911058514830799,0.89568656961945536,0.89017636898142294,0.88448316761504064,0.88242475733123471,0.88526077574797346,0.88753170113615276,0.88198665150010436,0.86755142532111962,0.85359399572058947,0.85196122448825751,0.86125149768062814,0.87421573083770443,0.88802524064798727,0.89883967912712592,0.9065000223532258,0.91916563264876794,0.94171200660472587,0.96702328034836005,0.98243297380880357,0.98190965898834803,0.97077752057555,0.95420975026257071,0.93300596149806159,0.9133068840455546,0.89874777286779939,0.88645761558748715,0.874962085043964,0.8614288158768556,0.8508872259171244,0.86135711739757659,0.89994197438882773,0.95161573233371799,0.98836774077540934,1,0.98968974128416987,0.95989031089423171,0.92999526320358084,0.91966644928082042,0.93054409143356542,0.94773009804745301,0.94737691128053947,0.92560863833019835,0.89348122529077023,0.84910717272978353,0.77727663256393587,0.68625394899741865,0.6118894198963889,0.56522909041273917,0.53762559628172213,0.52126915962829978,0.50514517043044538,0.48638791469220422,0.47336390622592717,0.46631094885355784,0.45964208788870914,0.45173297442344479,0.44210787397164286,0.43632584680020964,0.44072098459958414,0.45331255527059783,0.47178310406925544,0.49795157038804677,0.53366701683821249,0.57936963671166242,0.63499771220097057,0.684013871640761,0.7052397816910323,0.69712654645327943,0.65845755319560384,0.61412172726014447,0.59291029896903213,0.58988310393588994,0.59376676673141859,0.60957833988071208,0.65572860412135503,0.72576198551847282,0.78561482069320743,0.82384106931802015,0.84365530502353814,0.85570401267367024,0.87243643145564498,0.89238942531798837,0.90282330809999145,0.89447624826240635,0.85988545754791901,0.80237075240146416,0.72867816822765241,0.64793854840180809,0.57816040257376955,0.52277050056091812,0.47202235026861272,0.41836726044198619,0.36978426542226173,0.33421374166153645,0.31146581177029836,0.29556117990937292,0.27857725109596038,0.26266782822262053,0.25274783769505366,0.2480210291958643,0.24780068611356726,0.25091561248447669,0.25614261427673574,0.26069800455565123,0.26017602339069384,0.25628753334211224,0.25341205611813589,0.25126740761087041,0.24650396707424918,0.238828112854856,0.23182710281376376,0.226952055606708,0.22221854983751727,0.21679947266101904,0.21264368615885357,0.21242718458424131,0.21637005008688187,0.22082841692830957,0.2232445658032291,0.22425892677958786,0.22350290357096697,0.22099335532241324,0.2199781825557513,0.22356720895998472,0.23160935456118589,0.24218740260328395,0.25314320856522271,0.26158345033261077,0.26515969103956882,0.26482991572514936,0.26304777507702876,0.25932489025029987,0.25113320127824501,0.23833892221964575,0.22284441116877335,0.2064988974438057,0.19257689669150804,0.18352317339498764,0.17732311045804514,0.17063717652838226,0.16343779972820102,0.15674795180957626,0.14997556221262262,0.14455170127183767,0.14369236325087922,0.14664272813032575,0.14889089439750461,0.14704581100837519,0.14166019118937312,0.13744708649329956,0.13700776297671444,0.1355943490813114,0.12747169127753932,0.11411846560267631,0.10291767292423624,0.097797740474467085,0.091491492466614976,0.09469548383078974,0.12254940077408845,0.13178183390735607,0.10879326617624095,0.11056882552440349,0.11897129005018198,0.1227447813045621,0.12588609086032551,0.12802338976609595,0.12984841033773201,0.13213136761790514,0.13300349133613901,0.13353063316802383,0.13497622875044657,0.13561606447192201,0.13481268199686267,0.13385517533423871,0.13396595571811462,0.13480717341980525,0.13450399873407101,0.13129838378928985,0.12698160187449339,0.12438503260468775,0.12272938628131212,0.11998898516528601,0.11689693388542031,0.1152734692490644,0.11473275892211179,0.11501769731853485,0.11769834486974332,0.12194421110305313,0.12428013770051002,0.12462187242564624,0.12625577436590044,0.13017446011450998,0.13449234374471794,0.13898496523768958,0.14359141132817418,0.14774708186029634,0.15241000536187496,0.15552603344819585,0.15459160482419143,0.15211906551571036,0.15133275962952905,0.15228861371903579,0.153487396056775,0.15556766669374567,0.16202534258565532,0.17377296301083281,0.18581994560657059,0.19198566691443666,0.19123818200025477,0.18729338849564414,0.18331700765048578,0.18043850070912781,0.17984732891707811,0.18355728308397745,0.1906386023800648,0.19782064165877056,0.20707571794299529,0.21932058892139336,0.23041305108312252,0.24080859126955478,0.2516644310541567,0.26392787173574045,0.28409759186465505,0.31517080821784599,0.35394267415206909,0.39748557711375843,0.4383763892413895,0.46494464778825123,0.47556531482126724,0.47771873356305838,0.47781603967752673,0.47866075097677219,0.48023276840266282,0.48995568958600028,0.51306372095798447,0.53614783350853512,0.54836397290870209,0.5518499164406846,0.53953915998142854,0.4990441604067487,0.44358386820166934,0.39786297126818981,0.36846371816310641,0.34722939303656714,0.32940281864030574,0.31694773021401751,0.3090809023257966,0.30200738201512217,0.2914287541228075,0.27677714958738148,0.26168953392973249,0.24733942976254031,0.23575842929709456,0.23093943910972581,0.23039675729203687,0.22935696988368146,0.22774329021973019,0.22579940035369703,0.22522624740712727,0.22830890511348451,0.23324854763466629,0.23847221528818005,0.24354441156887,0.24760761048770447,0.25178334383731998,0.25964034326437002,0.2707203821352091,0.28159677036186076,0.29254745189751052,0.30157567628075721,0.30752359135102375,0.31580290293893021,0.3264553820044529,0.33484357496677603,0.34388858601379241,0.35680808735072411,0.37066200281540473,0.38268584757546942,0.38967773765987412,0.39119330394913371,0.39261822424727177,0.39877651577123008,0.41239545101271707,0.42860482768504138,0.43964778332249882,0.44800476584691501,0.45568969834626138,0.46090564311970317,0.47087319586128429,0.48721246170016841,0.50129629864791103,0.51339283669278257,0.5267839338349154,0.53884987753273506,0.54497200860057038,0.54683232755414013,0.54763505769770593,0.54449457442850102,0.54322200615070315,0.5506096893087159,0.56132330633144834,0.57227329929496595,0.58159249251688794,0.58259382135962934,0.57353342978561839,0.56385140978693227,0.56430743298975472,0.57062636522109422,0.56998419560249713,0.56117587941388514,0.55278115588849785,0.54835731912746688,0.54451008542179435,0.53560591999238305,0.52281059720339396,0.51051738121318935,0.49731185063661465,0.4883249695738095,0.48434880617248238,0.4733187648865671,0.46005320894038576,0.45568397957350043,0.44763954718800769,0.4298448373731788,0.41418388031763964,0.40372567508409135,0.39043246888973121,0.36137438243777498,0.32374158876523967,0.29099892565351876,0.2470195119018026,0.19382453140999337,0.15138338055343573,0.11670419167343207,0.09140526873941085,0.077815203243589329,0.071340885650464092,0.066292274777333168,0.059871999224392347,0.0487073602069555,0.032636492537066783,0.018911524888359989,0.013231109219253138,0.01624598243529321,0.021025455830402627,0.019794520798154545,0.012668393576581659,0.0052630394832189316,0.0056428993600946961,0.0079397440529547052,0.0023621068347350923,0,0.0096822519387726874,0.018618410603883268,0.023640174411986941,0.028499928069580634,0.030660971841719679,0.028898111213300048,0.028500507919797205,0.033512762184349114,0.038807432496882004,0.038846108506327297,0.037076347660330466,0.039114231246469802,0.046317855449487425,0.055180576084669267,0.059922910073407297,0.060608090081818604,0.06453303821276711,0.070381204549527995,0.070427650551875345,0.064125229555452606,0.057711941197621477,0.058226007407122637],"line":{"color":"rgb(255, 255, 255)"},"name":"x1","showlegend":false,"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"zeroline":false,"showgrid":false,"anchor":"y"},"xaxis2":{"domain":[0,1],"automargin":true,"autorange":"reversed","anchor":"y2"},"yaxis2":{"domain":[0,0.30000000000000004],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0.5,1],"automargin":true,"scaleanchor":"x","scaleratio":1,"zeroline":false,"showgrid":false,"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"plot_bgcolor":"rgba(17, 0, 73, 0)","paper_bgcolor":"rgb(0, 0, 0)","showlegend":true,"font":{"color":"#FFFFFF"},"autosize":true,"scene":{"zaxis":{"title":[]}},"hovermode":"closest","legend":{"orientation":"h","y":1.1000000000000001}},"attrs":{"18f131082a86":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12],"z":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12],"colorscale":"Viridis","type":"heatmap","hoverinfo":"text","showscale":false,"text":{},"inherit":true},"18f131082a86.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":3,"y":6,"type":"scatter","mode":"markers","name":"Selected Spectrum","inherit":true},"18f139e4d800":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"18f139e4d800.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"split":{},"line":{"color":"rgb(255, 255, 255)"},"name":"x1","showlegend":false,"inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="combining-openspecy-objects">Combining OpenSpecy Objects<a class="anchor" aria-label="anchor" href="#combining-openspecy-objects"></a>
</h2>
<p>Sometimes you have several OpenSpecy objects that you want to combine
into one. The easiest way to do that is by having spectra which all are
in the same exact format with the same series of wavenumbers. The
default settings of <code>c_spec</code> assume that is the case.</p>
<p>If you have different wavenumber ranges for the spectra you want to
combine, you can set <code>range = "common"</code> and <code>res</code>
equal to the wavenumber resolution you want and the function will
collapse all the spectra to whatever their common range is using linear
interpolation.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manage_spec.html">c_spec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">asp_example</span>, <span class="va">ps_example</span><span class="op">)</span>, range <span class="op">=</span> <span class="st">"common"</span>, res <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sop_files/figure-html/unnamed-chunk-21-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="filtering-openspecy-objects">Filtering OpenSpecy Objects<a class="anchor" aria-label="anchor" href="#filtering-openspecy-objects"></a>
</h2>
<p>OpenSpecy objects can have any number of spectra in them. To create
an OpenSpecy with a subset of the spectra that is in an Open Specy
object you can use the <code>filter_spec</code> function. Filtering is
allowed by index number, name, or using a logical vector. Filtering will
update the <code>spectra</code> and <code>metadata</code> items of the
<code>OpenSpecy</code> but not the <code>wavenumber</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the 150th spectrum. </span></span>
<span><span class="fu"><a href="../reference/match_spec.html">filter_spec</a></span><span class="op">(</span><span class="va">spectral_map</span>, <span class="fl">150</span><span class="op">)</span></span>
<span><span class="co">#&gt;      wavenumber         9_5</span></span>
<span><span class="co">#&gt;           &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1:     717.42  0.06159078</span></span>
<span><span class="co">#&gt;   2:     725.13  0.01614512</span></span>
<span><span class="co">#&gt;   3:     732.85 -0.02511934</span></span>
<span><span class="co">#&gt;   4:     740.56 -0.05653130</span></span>
<span><span class="co">#&gt;   5:     748.28 -0.07012609</span></span>
<span><span class="co">#&gt;  ---                       </span></span>
<span><span class="co">#&gt; 423:    3972.81 -0.23276733</span></span>
<span><span class="co">#&gt; 424:    3980.52 -0.22747667</span></span>
<span><span class="co">#&gt; 425:    3988.24 -0.23046409</span></span>
<span><span class="co">#&gt; 426:    3995.95 -0.23281474</span></span>
<span><span class="co">#&gt; 427:    4003.67 -0.22850421</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metadata</span></span>
<span><span class="co">#&gt;        y     x       file_name  license</span></span>
<span><span class="co">#&gt;    &lt;num&gt; &lt;num&gt;          &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:     9     5 CA small UF.dat CC BY-NC</span></span>
<span><span class="co">#&gt;                                                     description samples lines</span></span>
<span><span class="co">#&gt;                                                          &lt;char&gt;   &lt;num&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: Pixel 15, XPos=12549.72, YPos= 589.82, X=12362.22, Y= 614.82      16    13</span></span>
<span><span class="co">#&gt;    bands header offset data type interleave                  z plot titles</span></span>
<span><span class="co">#&gt;    &lt;num&gt;         &lt;num&gt;     &lt;num&gt;     &lt;char&gt;                         &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:   427             0         4        bip Wavenumbers (cm-1), Absorbance</span></span>
<span><span class="co">#&gt;                  pixel size col_id</span></span>
<span><span class="co">#&gt;                      &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: 0.000025000, 0.000025000    9_5</span></span>
<span><span class="co">#&gt;                                                           session_id</span></span>
<span><span class="co">#&gt;                                                               &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: b30320912a9bd1c92e306a6260ee900e/5c57090e2332089ebe6148c3d85f1379</span></span>
<span><span class="co">#&gt;                             file_id</span></span>
<span><span class="co">#&gt;                              &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: 215a0fd7e0dc3b1001799214618ce6eb</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the spectrum with column name "8_5". </span></span>
<span><span class="fu"><a href="../reference/match_spec.html">filter_spec</a></span><span class="op">(</span><span class="va">spectral_map</span>, <span class="st">"8_5"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;      wavenumber         8_5</span></span>
<span><span class="co">#&gt;           &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1:     717.42  0.15336494</span></span>
<span><span class="co">#&gt;   2:     725.13  0.10891031</span></span>
<span><span class="co">#&gt;   3:     732.85  0.06503499</span></span>
<span><span class="co">#&gt;   4:     740.56  0.03334329</span></span>
<span><span class="co">#&gt;   5:     748.28  0.01523896</span></span>
<span><span class="co">#&gt;  ---                       </span></span>
<span><span class="co">#&gt; 423:    3972.81 -0.28495014</span></span>
<span><span class="co">#&gt; 424:    3980.52 -0.28366613</span></span>
<span><span class="co">#&gt; 425:    3988.24 -0.28505880</span></span>
<span><span class="co">#&gt; 426:    3995.95 -0.28465354</span></span>
<span><span class="co">#&gt; 427:    4003.67 -0.27912781</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metadata</span></span>
<span><span class="co">#&gt;        y     x       file_name  license</span></span>
<span><span class="co">#&gt;    &lt;num&gt; &lt;num&gt;          &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:     8     5 CA small UF.dat CC BY-NC</span></span>
<span><span class="co">#&gt;                                                     description samples lines</span></span>
<span><span class="co">#&gt;                                                          &lt;char&gt;   &lt;num&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: Pixel 15, XPos=12549.72, YPos= 589.82, X=12362.22, Y= 614.82      16    13</span></span>
<span><span class="co">#&gt;    bands header offset data type interleave                  z plot titles</span></span>
<span><span class="co">#&gt;    &lt;num&gt;         &lt;num&gt;     &lt;num&gt;     &lt;char&gt;                         &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:   427             0         4        bip Wavenumbers (cm-1), Absorbance</span></span>
<span><span class="co">#&gt;                  pixel size col_id</span></span>
<span><span class="co">#&gt;                      &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: 0.000025000, 0.000025000    8_5</span></span>
<span><span class="co">#&gt;                                                           session_id</span></span>
<span><span class="co">#&gt;                                                               &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: b30320912a9bd1c92e306a6260ee900e/5c57090e2332089ebe6148c3d85f1379</span></span>
<span><span class="co">#&gt;                             file_id</span></span>
<span><span class="co">#&gt;                              &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: 215a0fd7e0dc3b1001799214618ce6eb</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the spectra with a logical argument based on metadata</span></span>
<span><span class="fu"><a href="../reference/match_spec.html">filter_spec</a></span><span class="op">(</span><span class="va">spectral_map</span>, <span class="va">spectral_map</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">y</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sop_files/figure-html/unnamed-chunk-24-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="sampling-openspecy-objects">Sampling OpenSpecy Objects<a class="anchor" aria-label="anchor" href="#sampling-openspecy-objects"></a>
</h2>
<p>Sometimes you have a large suite of examples of spectra of the same
material and you want to reduce the number of spectra you run through
the analysis for simplicity or you are running simulations or other
procedures that require you to first sample from the spectra contained
in your OpenSpecy objects before doing analysis. the
<code>sample_spec</code> function serves this purpose.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manage_spec.html">sample_spec</a></span><span class="op">(</span><span class="va">spectral_map</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sop_files/figure-html/unnamed-chunk-25-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="processing">Processing<a class="anchor" aria-label="anchor" href="#processing"></a>
</h2>
<p>The goal of this all processing is to increase the signal to noise
ratio (S/N) of the spectra without distorting the shape, position, or
relative size of the peaks. After loading data, you can process the data
using intensity adjustment, baseline subtraction, smoothing, flattening,
and range selection. The default settings is an absolute derivative
transformation, it is kind of magic, it does something similar to
smoothing, baseline subtraction, and intensity correction simultaneously
and really quickly.</p>
<p>The <code><a href="../reference/process_spec.html">process_spec()</a></code> function is a monolithic function for
all processing procedures which is optimized by default to result in
high signal to noise in most cases, same as the app.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">processed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_spec.html">process_spec</a></span><span class="op">(</span><span class="va">raman_hdpe</span>,</span>
<span>                          active <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          adj_intens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          adj_intens_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>,</span>
<span>                          conform_spec <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          conform_spec_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="cn">NULL</span>, res <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                                                   type <span class="op">=</span> <span class="st">"interp"</span><span class="op">)</span>,</span>
<span>                          restrict_range <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          restrict_range_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">6000</span><span class="op">)</span>,</span>
<span>                          flatten_range <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          flatten_range_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">2200</span>, max <span class="op">=</span> <span class="fl">2420</span><span class="op">)</span>,</span>
<span>                          subtr_baseline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          subtr_baseline_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"polynomial"</span>,</span>
<span>                                                     degree <span class="op">=</span> <span class="fl">8</span>, raw <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                                     baseline <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>                          smooth_intens <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          smooth_intens_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>polynomial <span class="op">=</span> <span class="fl">3</span>, window <span class="op">=</span> <span class="fl">11</span>,</span>
<span>                                                    derivative <span class="op">=</span> <span class="fl">1</span>, abs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                          make_rel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">processed</span><span class="op">)</span></span>
<span><span class="co">#&gt; $wavenumber</span></span>
<span><span class="co">#&gt;  Length Min. Max.     Res.</span></span>
<span><span class="co">#&gt;     362  304 3192 7.977901</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $spectra</span></span>
<span><span class="co">#&gt;  Number Min. Intensity Max. Intensity</span></span>
<span><span class="co">#&gt;       1              0              1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metadata</span></span>
<span><span class="co">#&gt;   Min. Max.</span></span>
<span><span class="co">#&gt; x    1    1</span></span>
<span><span class="co">#&gt; y    1    1</span></span>
<span><span class="co">#&gt; [1] "x"                 "y"                 "user_name"        </span></span>
<span><span class="co">#&gt; [4] "spectrum_type"     "spectrum_identity" "organization"     </span></span>
<span><span class="co">#&gt; [7] "license"           "session_id"        "file_id"</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">raman_hdpe</span><span class="op">)</span></span>
<span><span class="co">#&gt; $wavenumber</span></span>
<span><span class="co">#&gt;  Length   Min.    Max.    Res.</span></span>
<span><span class="co">#&gt;     964 301.04 3198.12 3.00527</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $spectra</span></span>
<span><span class="co">#&gt;  Number Min. Intensity Max. Intensity</span></span>
<span><span class="co">#&gt;       1             26            816</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metadata</span></span>
<span><span class="co">#&gt;   Min. Max.</span></span>
<span><span class="co">#&gt; x    1    1</span></span>
<span><span class="co">#&gt; y    1    1</span></span>
<span><span class="co">#&gt; [1] "x"                 "y"                 "user_name"        </span></span>
<span><span class="co">#&gt; [4] "spectrum_type"     "spectrum_identity" "organization"     </span></span>
<span><span class="co">#&gt; [7] "license"           "session_id"        "file_id"</span></span></code></pre></div>
<p>You can compare the processed and unprocessed data in an overlay
plot.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/interactive_plots.html">plotly_spec</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, <span class="va">processed</span><span class="op">)</span></span></code></pre></div>
<p>We want people to use the <code><a href="../reference/process_spec.html">process_spec()</a></code> function for
most processing operations. All other processing functions can be tuned
using its parameters in the single function and we have set defaults and
nested the processing functions in a way that provides typically quality
results. However, we recognize that nesting of functions and order of
operations can be useful for users to control so you can also use
individual functions for each operation if you’d like. See explanations
of each processing sub-function below.</p>
<div class="section level3">
<h3 id="threshold-signal-noise">Threshold Signal-Noise<a class="anchor" aria-label="anchor" href="#threshold-signal-noise"></a>
</h3>
<p>Considering whether you have enough signal to analyze spectra is
important. Classical spectroscopy would recommend your highest peak to
be at least 10 times the baseline of your processed spectra before you
begin analysis. If your spectra is below that threshold even after
processing, you may want to consider recollecting it. In practice, we
are rarely able to collect spectra of that good quality and more often
use 5. The “run_sig_over_noise” <code>metric</code> searches your
spectra for high and low regions and conducts division on them to derive
the signal to noise ratio and <code>step</code> specifies the number of
intensities to search. This is a good way to automatically calculate the
signal to noise ratio. In the example below you can see that our signal
to noise ratio is increased by the processing, the goal of processing is
generally to maximize this. “sig_times_noise” <code>metric</code>
multiplies the mean signal by the standard deviation of the signal and
“tot_sig” <code>metric</code> sums the intensities. The latter can be
really useful for thresholding spectral maps to identify particles which
we will discuss later. If you know where your signal region and noise
regions are you can specify them with <code>sig_min</code>,
<code>sig_max</code>, <code>noise_min</code>, and
<code>noise_max</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sig_noise.html">sig_noise</a></span><span class="op">(</span><span class="va">processed</span>, metric <span class="op">=</span> <span class="st">"run_sig_over_noise"</span><span class="op">)</span> <span class="op">&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sig_noise.html">sig_noise</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, metric <span class="op">=</span> <span class="st">"run_sig_over_noise"</span><span class="op">)</span></span></code></pre></div>
<p>If analyzing spectra in batch, we recommend looking at the heatmap
and optimizing the percent of spectra that are above your signal to
noise threshold to determine the correct settings instead of looking
through spectra individually. Setting the <code>min_sn</code> will
threshold the heatmap image to only color spectra which have a
<code>sn</code> value over the threshold.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spectral_map_p</span> <span class="op">&lt;-</span> <span class="va">spectral_map</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/process_spec.html">process_spec</a></span><span class="op">(</span>flatten_range <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spectral_map_p</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">sig_noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sig_noise.html">sig_noise</a></span><span class="op">(</span><span class="va">spectral_map_p</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/interactive_plots.html">heatmap_spec</a></span><span class="op">(</span><span class="va">spectral_map_p</span>, sn <span class="op">=</span> <span class="va">spectral_map_p</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">sig_noise</span>, min_sn <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"visdat":{"18f1bd6402b":["function () ","plotlyVisDat"]},"cur_data":"18f1bd6402b","attrs":{"18f1bd6402b":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12],"z":[null,6.4146582349849357,null,null,null,null,null,null,null,null,null,null,null,null,null,null,5.4081029570108621,6.3999797052876506,null,null,null,null,null,null,null,null,null,null,null,null,null,5.1497977321174124,7.0937856262252614,5.4499154379515335,null,null,5.1018864249812941,null,null,null,5.0366012662911182,null,null,null,null,null,null,null,6.1186127352835946,null,5.2685927820922291,null,null,null,5.0079758666041441,null,5.3132460647136002,null,5.4130404920869983,null,null,null,null,null,null,null,5.1226415212412615,null,null,null,5.4989525594681403,null,5.1944198513693953,null,5.0679976954760599,5.5399986047024123,5.4547060695678065,null,null,null,null,null,null,5.1443743887325946,5.3037643601770696,null,null,null,null,null,null,5.2192259416806408,5.1177637447809214,null,null,null,null,null,null,5.1081835150072097,null,null,null,null,null,null,null,5.1341766503257205,null,null,null,null,null,null,null,null,5.2557702792632561,null,null,null,null,null,null,null,5.5183979487147941,5.2297252720341092,6.7390625946486873,null,null,null,5.3367154267315735,5.2543219485114196,null,null,null,null,null,null,null,null,null,null,null,null,null,5.2256015883201874,null,null,null,null,null,null,null,null,null,5.110092722952472,null,null,null,null,null,5.4312530327091872,5.1393299351530715,null,5.8794387553301561,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,6.0262273514737661,null,5.5464220397017083,null,null,null,null,null,null,null,null,null,null,null,null,5.3614602207890574,null,null,5.4354739140982451,null,5.4736024207190646,null,null,null,null,null,null,null],"colorscale":"Viridis","type":"heatmap","hoverinfo":"text","showscale":false,"text":{},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"x","zeroline":false,"showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"title":"y","scaleanchor":"x","scaleratio":1,"zeroline":false,"showgrid":false},"plot_bgcolor":"rgba(17, 0, 73, 0)","paper_bgcolor":"rgb(0, 0, 0)","showlegend":false,"font":{"color":"#FFFFFF"},"scene":{"zaxis":{"title":[]}},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2},"colorscale":"Viridis","showscale":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12],"z":[null,6.4146582349849357,null,null,null,null,null,null,null,null,null,null,null,null,null,null,5.4081029570108621,6.3999797052876506,null,null,null,null,null,null,null,null,null,null,null,null,null,5.1497977321174124,7.0937856262252614,5.4499154379515335,null,null,5.1018864249812941,null,null,null,5.0366012662911182,null,null,null,null,null,null,null,6.1186127352835946,null,5.2685927820922291,null,null,null,5.0079758666041441,null,5.3132460647136002,null,5.4130404920869983,null,null,null,null,null,null,null,5.1226415212412615,null,null,null,5.4989525594681403,null,5.1944198513693953,null,5.0679976954760599,5.5399986047024123,5.4547060695678065,null,null,null,null,null,null,5.1443743887325946,5.3037643601770696,null,null,null,null,null,null,5.2192259416806408,5.1177637447809214,null,null,null,null,null,null,5.1081835150072097,null,null,null,null,null,null,null,5.1341766503257205,null,null,null,null,null,null,null,null,5.2557702792632561,null,null,null,null,null,null,null,5.5183979487147941,5.2297252720341092,6.7390625946486873,null,null,null,5.3367154267315735,5.2543219485114196,null,null,null,null,null,null,null,null,null,null,null,null,null,5.2256015883201874,null,null,null,null,null,null,null,null,null,5.110092722952472,null,null,null,null,null,5.4312530327091872,5.1393299351530715,null,5.8794387553301561,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,6.0262273514737661,null,5.5464220397017083,null,null,null,null,null,null,null,null,null,null,null,null,5.3614602207890574,null,null,5.4354739140982451,null,5.4736024207190646,null,null,null,null,null,null,null],"type":"heatmap","hoverinfo":"text","text":["row:  1 <br>x:  0 , y:  0 , z:  NA <br>snr:  3.6 ","row:  2 <br>x:  1 , y:  0 , z:  6.41465823498494 <br>snr:  6.4 ","row:  3 <br>x:  2 , y:  0 , z:  NA <br>snr:  2.6 ","row:  4 <br>x:  3 , y:  0 , z:  NA <br>snr:  2.8 ","row:  5 <br>x:  4 , y:  0 , z:  NA <br>snr:  4.4 ","row:  6 <br>x:  5 , y:  0 , z:  NA <br>snr:  4.3 ","row:  7 <br>x:  6 , y:  0 , z:  NA <br>snr:  3.1 ","row:  8 <br>x:  7 , y:  0 , z:  NA <br>snr:  3.8 ","row:  9 <br>x:  8 , y:  0 , z:  NA <br>snr:  3.8 ","row:  10 <br>x:  9 , y:  0 , z:  NA <br>snr:  4.1 ","row:  11 <br>x:  10 , y:  0 , z:  NA <br>snr:  2.4 ","row:  12 <br>x:  11 , y:  0 , z:  NA <br>snr:  2.9 ","row:  13 <br>x:  12 , y:  0 , z:  NA <br>snr:  4.1 ","row:  14 <br>x:  13 , y:  0 , z:  NA <br>snr:  3.5 ","row:  15 <br>x:  14 , y:  0 , z:  NA <br>snr:  4.4 ","row:  16 <br>x:  15 , y:  0 , z:  NA <br>snr:  4.8 ","row:  17 <br>x:  0 , y:  1 , z:  5.40810295701086 <br>snr:  5.4 ","row:  18 <br>x:  1 , y:  1 , z:  6.39997970528765 <br>snr:  6.4 ","row:  19 <br>x:  2 , y:  1 , z:  NA <br>snr:  2.6 ","row:  20 <br>x:  3 , y:  1 , z:  NA <br>snr:  3.4 ","row:  21 <br>x:  4 , y:  1 , z:  NA <br>snr:  3.5 ","row:  22 <br>x:  5 , y:  1 , z:  NA <br>snr:  3.6 ","row:  23 <br>x:  6 , y:  1 , z:  NA <br>snr:  4.4 ","row:  24 <br>x:  7 , y:  1 , z:  NA <br>snr:  4.5 ","row:  25 <br>x:  8 , y:  1 , z:  NA <br>snr:  3.2 ","row:  26 <br>x:  9 , y:  1 , z:  NA <br>snr:  3.4 ","row:  27 <br>x:  10 , y:  1 , z:  NA <br>snr:  2.6 ","row:  28 <br>x:  11 , y:  1 , z:  NA <br>snr:  2.9 ","row:  29 <br>x:  12 , y:  1 , z:  NA <br>snr:  3.8 ","row:  30 <br>x:  13 , y:  1 , z:  NA <br>snr:  3.1 ","row:  31 <br>x:  14 , y:  1 , z:  NA <br>snr:  4 ","row:  32 <br>x:  15 , y:  1 , z:  5.14979773211741 <br>snr:  5.1 ","row:  33 <br>x:  0 , y:  2 , z:  7.09378562622526 <br>snr:  7.1 ","row:  34 <br>x:  1 , y:  2 , z:  5.44991543795153 <br>snr:  5.4 ","row:  35 <br>x:  2 , y:  2 , z:  NA <br>snr:  3.2 ","row:  36 <br>x:  3 , y:  2 , z:  NA <br>snr:  4.7 ","row:  37 <br>x:  4 , y:  2 , z:  5.10188642498129 <br>snr:  5.1 ","row:  38 <br>x:  5 , y:  2 , z:  NA <br>snr:  3.8 ","row:  39 <br>x:  6 , y:  2 , z:  NA <br>snr:  4.8 ","row:  40 <br>x:  7 , y:  2 , z:  NA <br>snr:  3.7 ","row:  41 <br>x:  8 , y:  2 , z:  5.03660126629112 <br>snr:  5 ","row:  42 <br>x:  9 , y:  2 , z:  NA <br>snr:  3.7 ","row:  43 <br>x:  10 , y:  2 , z:  NA <br>snr:  4.2 ","row:  44 <br>x:  11 , y:  2 , z:  NA <br>snr:  3.6 ","row:  45 <br>x:  12 , y:  2 , z:  NA <br>snr:  3.8 ","row:  46 <br>x:  13 , y:  2 , z:  NA <br>snr:  2.7 ","row:  47 <br>x:  14 , y:  2 , z:  NA <br>snr:  4.4 ","row:  48 <br>x:  15 , y:  2 , z:  NA <br>snr:  4.9 ","row:  49 <br>x:  0 , y:  3 , z:  6.11861273528359 <br>snr:  6.1 ","row:  50 <br>x:  1 , y:  3 , z:  NA <br>snr:  4.6 ","row:  51 <br>x:  2 , y:  3 , z:  5.26859278209223 <br>snr:  5.3 ","row:  52 <br>x:  3 , y:  3 , z:  NA <br>snr:  4.6 ","row:  53 <br>x:  4 , y:  3 , z:  NA <br>snr:  4.5 ","row:  54 <br>x:  5 , y:  3 , z:  NA <br>snr:  4.5 ","row:  55 <br>x:  6 , y:  3 , z:  5.00797586660414 <br>snr:  5 ","row:  56 <br>x:  7 , y:  3 , z:  NA <br>snr:  4.8 ","row:  57 <br>x:  8 , y:  3 , z:  5.3132460647136 <br>snr:  5.3 ","row:  58 <br>x:  9 , y:  3 , z:  NA <br>snr:  4.8 ","row:  59 <br>x:  10 , y:  3 , z:  5.413040492087 <br>snr:  5.4 ","row:  60 <br>x:  11 , y:  3 , z:  NA <br>snr:  3.9 ","row:  61 <br>x:  12 , y:  3 , z:  NA <br>snr:  4.2 ","row:  62 <br>x:  13 , y:  3 , z:  NA <br>snr:  2.9 ","row:  63 <br>x:  14 , y:  3 , z:  NA <br>snr:  3.3 ","row:  64 <br>x:  15 , y:  3 , z:  NA <br>snr:  4.3 ","row:  65 <br>x:  0 , y:  4 , z:  NA <br>snr:  4.7 ","row:  66 <br>x:  1 , y:  4 , z:  NA <br>snr:  3.9 ","row:  67 <br>x:  2 , y:  4 , z:  5.12264152124126 <br>snr:  5.1 ","row:  68 <br>x:  3 , y:  4 , z:  NA <br>snr:  4.3 ","row:  69 <br>x:  4 , y:  4 , z:  NA <br>snr:  4.2 ","row:  70 <br>x:  5 , y:  4 , z:  NA <br>snr:  4.4 ","row:  71 <br>x:  6 , y:  4 , z:  5.49895255946814 <br>snr:  5.5 ","row:  72 <br>x:  7 , y:  4 , z:  NA <br>snr:  4.8 ","row:  73 <br>x:  8 , y:  4 , z:  5.1944198513694 <br>snr:  5.2 ","row:  74 <br>x:  9 , y:  4 , z:  NA <br>snr:  4.6 ","row:  75 <br>x:  10 , y:  4 , z:  5.06799769547606 <br>snr:  5.1 ","row:  76 <br>x:  11 , y:  4 , z:  5.53999860470241 <br>snr:  5.5 ","row:  77 <br>x:  12 , y:  4 , z:  5.45470606956781 <br>snr:  5.5 ","row:  78 <br>x:  13 , y:  4 , z:  NA <br>snr:  3 ","row:  79 <br>x:  14 , y:  4 , z:  NA <br>snr:  3.7 ","row:  80 <br>x:  15 , y:  4 , z:  NA <br>snr:  3.2 ","row:  81 <br>x:  0 , y:  5 , z:  NA <br>snr:  4.4 ","row:  82 <br>x:  1 , y:  5 , z:  NA <br>snr:  4.5 ","row:  83 <br>x:  2 , y:  5 , z:  NA <br>snr:  4.7 ","row:  84 <br>x:  3 , y:  5 , z:  5.14437438873259 <br>snr:  5.1 ","row:  85 <br>x:  4 , y:  5 , z:  5.30376436017707 <br>snr:  5.3 ","row:  86 <br>x:  5 , y:  5 , z:  NA <br>snr:  4.2 ","row:  87 <br>x:  6 , y:  5 , z:  NA <br>snr:  4.8 ","row:  88 <br>x:  7 , y:  5 , z:  NA <br>snr:  4.6 ","row:  89 <br>x:  8 , y:  5 , z:  NA <br>snr:  4.7 ","row:  90 <br>x:  9 , y:  5 , z:  NA <br>snr:  4.4 ","row:  91 <br>x:  10 , y:  5 , z:  NA <br>snr:  4.9 ","row:  92 <br>x:  11 , y:  5 , z:  5.21922594168064 <br>snr:  5.2 ","row:  93 <br>x:  12 , y:  5 , z:  5.11776374478092 <br>snr:  5.1 ","row:  94 <br>x:  13 , y:  5 , z:  NA <br>snr:  3.6 ","row:  95 <br>x:  14 , y:  5 , z:  NA <br>snr:  3.9 ","row:  96 <br>x:  15 , y:  5 , z:  NA <br>snr:  3.1 ","row:  97 <br>x:  0 , y:  6 , z:  NA <br>snr:  4.7 ","row:  98 <br>x:  1 , y:  6 , z:  NA <br>snr:  4.6 ","row:  99 <br>x:  2 , y:  6 , z:  NA <br>snr:  4.5 ","row:  100 <br>x:  3 , y:  6 , z:  5.10818351500721 <br>snr:  5.1 ","row:  101 <br>x:  4 , y:  6 , z:  NA <br>snr:  4.6 ","row:  102 <br>x:  5 , y:  6 , z:  NA <br>snr:  4 ","row:  103 <br>x:  6 , y:  6 , z:  NA <br>snr:  4.7 ","row:  104 <br>x:  7 , y:  6 , z:  NA <br>snr:  4 ","row:  105 <br>x:  8 , y:  6 , z:  NA <br>snr:  3.9 ","row:  106 <br>x:  9 , y:  6 , z:  NA <br>snr:  3.9 ","row:  107 <br>x:  10 , y:  6 , z:  NA <br>snr:  4.2 ","row:  108 <br>x:  11 , y:  6 , z:  5.13417665032572 <br>snr:  5.1 ","row:  109 <br>x:  12 , y:  6 , z:  NA <br>snr:  4.9 ","row:  110 <br>x:  13 , y:  6 , z:  NA <br>snr:  4.7 ","row:  111 <br>x:  14 , y:  6 , z:  NA <br>snr:  4.6 ","row:  112 <br>x:  15 , y:  6 , z:  NA <br>snr:  3 ","row:  113 <br>x:  0 , y:  7 , z:  NA <br>snr:  4.5 ","row:  114 <br>x:  1 , y:  7 , z:  NA <br>snr:  3.9 ","row:  115 <br>x:  2 , y:  7 , z:  NA <br>snr:  5 ","row:  116 <br>x:  3 , y:  7 , z:  NA <br>snr:  4.6 ","row:  117 <br>x:  4 , y:  7 , z:  5.25577027926326 <br>snr:  5.3 ","row:  118 <br>x:  5 , y:  7 , z:  NA <br>snr:  3.6 ","row:  119 <br>x:  6 , y:  7 , z:  NA <br>snr:  3.7 ","row:  120 <br>x:  7 , y:  7 , z:  NA <br>snr:  3.5 ","row:  121 <br>x:  8 , y:  7 , z:  NA <br>snr:  4.1 ","row:  122 <br>x:  9 , y:  7 , z:  NA <br>snr:  4.4 ","row:  123 <br>x:  10 , y:  7 , z:  NA <br>snr:  4.5 ","row:  124 <br>x:  11 , y:  7 , z:  NA <br>snr:  4.6 ","row:  125 <br>x:  12 , y:  7 , z:  5.51839794871479 <br>snr:  5.5 ","row:  126 <br>x:  13 , y:  7 , z:  5.22972527203411 <br>snr:  5.2 ","row:  127 <br>x:  14 , y:  7 , z:  6.73906259464869 <br>snr:  6.7 ","row:  128 <br>x:  15 , y:  7 , z:  NA <br>snr:  2.7 ","row:  129 <br>x:  0 , y:  8 , z:  NA <br>snr:  4.5 ","row:  130 <br>x:  1 , y:  8 , z:  NA <br>snr:  3.9 ","row:  131 <br>x:  2 , y:  8 , z:  5.33671542673157 <br>snr:  5.3 ","row:  132 <br>x:  3 , y:  8 , z:  5.25432194851142 <br>snr:  5.3 ","row:  133 <br>x:  4 , y:  8 , z:  NA <br>snr:  4.9 ","row:  134 <br>x:  5 , y:  8 , z:  NA <br>snr:  3.3 ","row:  135 <br>x:  6 , y:  8 , z:  NA <br>snr:  3.5 ","row:  136 <br>x:  7 , y:  8 , z:  NA <br>snr:  3.6 ","row:  137 <br>x:  8 , y:  8 , z:  NA <br>snr:  4.1 ","row:  138 <br>x:  9 , y:  8 , z:  NA <br>snr:  5 ","row:  139 <br>x:  10 , y:  8 , z:  NA <br>snr:  4.7 ","row:  140 <br>x:  11 , y:  8 , z:  NA <br>snr:  5 ","row:  141 <br>x:  12 , y:  8 , z:  NA <br>snr:  4.9 ","row:  142 <br>x:  13 , y:  8 , z:  NA <br>snr:  4.7 ","row:  143 <br>x:  14 , y:  8 , z:  NA <br>snr:  3.7 ","row:  144 <br>x:  15 , y:  8 , z:  NA <br>snr:  2.8 ","row:  145 <br>x:  0 , y:  9 , z:  NA <br>snr:  3.7 ","row:  146 <br>x:  1 , y:  9 , z:  5.22560158832019 <br>snr:  5.2 ","row:  147 <br>x:  2 , y:  9 , z:  NA <br>snr:  4.9 ","row:  148 <br>x:  3 , y:  9 , z:  NA <br>snr:  4.7 ","row:  149 <br>x:  4 , y:  9 , z:  NA <br>snr:  4.7 ","row:  150 <br>x:  5 , y:  9 , z:  NA <br>snr:  4.5 ","row:  151 <br>x:  6 , y:  9 , z:  NA <br>snr:  4.6 ","row:  152 <br>x:  7 , y:  9 , z:  NA <br>snr:  4.6 ","row:  153 <br>x:  8 , y:  9 , z:  NA <br>snr:  4.6 ","row:  154 <br>x:  9 , y:  9 , z:  NA <br>snr:  4.2 ","row:  155 <br>x:  10 , y:  9 , z:  NA <br>snr:  4 ","row:  156 <br>x:  11 , y:  9 , z:  5.11009272295247 <br>snr:  5.1 ","row:  157 <br>x:  12 , y:  9 , z:  NA <br>snr:  4.8 ","row:  158 <br>x:  13 , y:  9 , z:  NA <br>snr:  4.7 ","row:  159 <br>x:  14 , y:  9 , z:  NA <br>snr:  3.3 ","row:  160 <br>x:  15 , y:  9 , z:  NA <br>snr:  2.8 ","row:  161 <br>x:  0 , y:  10 , z:  NA <br>snr:  2.9 ","row:  162 <br>x:  1 , y:  10 , z:  5.43125303270919 <br>snr:  5.4 ","row:  163 <br>x:  2 , y:  10 , z:  5.13932993515307 <br>snr:  5.1 ","row:  164 <br>x:  3 , y:  10 , z:  NA <br>snr:  4.8 ","row:  165 <br>x:  4 , y:  10 , z:  5.87943875533016 <br>snr:  5.9 ","row:  166 <br>x:  5 , y:  10 , z:  NA <br>snr:  4.7 ","row:  167 <br>x:  6 , y:  10 , z:  NA <br>snr:  4.3 ","row:  168 <br>x:  7 , y:  10 , z:  NA <br>snr:  4.2 ","row:  169 <br>x:  8 , y:  10 , z:  NA <br>snr:  3.5 ","row:  170 <br>x:  9 , y:  10 , z:  NA <br>snr:  3.8 ","row:  171 <br>x:  10 , y:  10 , z:  NA <br>snr:  3.9 ","row:  172 <br>x:  11 , y:  10 , z:  NA <br>snr:  4.5 ","row:  173 <br>x:  12 , y:  10 , z:  NA <br>snr:  4.6 ","row:  174 <br>x:  13 , y:  10 , z:  NA <br>snr:  4.4 ","row:  175 <br>x:  14 , y:  10 , z:  NA <br>snr:  3.1 ","row:  176 <br>x:  15 , y:  10 , z:  NA <br>snr:  2.6 ","row:  177 <br>x:  0 , y:  11 , z:  NA <br>snr:  3.1 ","row:  178 <br>x:  1 , y:  11 , z:  NA <br>snr:  4.9 ","row:  179 <br>x:  2 , y:  11 , z:  NA <br>snr:  4.7 ","row:  180 <br>x:  3 , y:  11 , z:  NA <br>snr:  3.9 ","row:  181 <br>x:  4 , y:  11 , z:  6.02622735147377 <br>snr:  6 ","row:  182 <br>x:  5 , y:  11 , z:  NA <br>snr:  4.6 ","row:  183 <br>x:  6 , y:  11 , z:  5.54642203970171 <br>snr:  5.5 ","row:  184 <br>x:  7 , y:  11 , z:  NA <br>snr:  3.4 ","row:  185 <br>x:  8 , y:  11 , z:  NA <br>snr:  4.2 ","row:  186 <br>x:  9 , y:  11 , z:  NA <br>snr:  4.2 ","row:  187 <br>x:  10 , y:  11 , z:  NA <br>snr:  4.5 ","row:  188 <br>x:  11 , y:  11 , z:  NA <br>snr:  4.3 ","row:  189 <br>x:  12 , y:  11 , z:  NA <br>snr:  4.7 ","row:  190 <br>x:  13 , y:  11 , z:  NA <br>snr:  3.9 ","row:  191 <br>x:  14 , y:  11 , z:  NA <br>snr:  3.5 ","row:  192 <br>x:  15 , y:  11 , z:  NA <br>snr:  3.1 ","row:  193 <br>x:  0 , y:  12 , z:  NA <br>snr:  3.3 ","row:  194 <br>x:  1 , y:  12 , z:  NA <br>snr:  3 ","row:  195 <br>x:  2 , y:  12 , z:  NA <br>snr:  4 ","row:  196 <br>x:  3 , y:  12 , z:  5.36146022078906 <br>snr:  5.4 ","row:  197 <br>x:  4 , y:  12 , z:  NA <br>snr:  5 ","row:  198 <br>x:  5 , y:  12 , z:  NA <br>snr:  4.9 ","row:  199 <br>x:  6 , y:  12 , z:  5.43547391409825 <br>snr:  5.4 ","row:  200 <br>x:  7 , y:  12 , z:  NA <br>snr:  4.4 ","row:  201 <br>x:  8 , y:  12 , z:  5.47360242071906 <br>snr:  5.5 ","row:  202 <br>x:  9 , y:  12 , z:  NA <br>snr:  3.6 ","row:  203 <br>x:  10 , y:  12 , z:  NA <br>snr:  4.8 ","row:  204 <br>x:  11 , y:  12 , z:  NA <br>snr:  3.8 ","row:  205 <br>x:  12 , y:  12 , z:  NA <br>snr:  3.8 ","row:  206 <br>x:  13 , y:  12 , z:  NA <br>snr:  3.4 ","row:  207 <br>x:  14 , y:  12 , z:  NA <br>snr:  3.7 ","row:  208 <br>x:  15 , y:  12 , z:  NA <br>snr:  2.8 "],"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="intensity-adjustment">Intensity Adjustment<a class="anchor" aria-label="anchor" href="#intensity-adjustment"></a>
</h3>
<p>Open Specy assumes that intensity units are in absorbance units but
Open Specy can adjust reflectance or transmittance spectra to absorbance
units. The transmittance adjustment uses the <span class="math inline">\(\log_{10} 1/T\)</span> calculation which does not
correct for system or particle characteristics. The reflectance
adjustment use the Kubelka-Munk equation <span class="math inline">\(\frac{(1-R)^2}{2R}\)</span>.</p>
<p>This is the respective R code for a scenario where the spectra
doesn’t need intensity adjustment:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trans_raman_hdpe</span> <span class="op">&lt;-</span> <span class="va">raman_hdpe</span></span>
<span><span class="va">trans_raman_hdpe</span><span class="op">$</span><span class="va">spectra</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">trans_raman_hdpe</span><span class="op">$</span><span class="va">spectra</span><span class="op">^</span><span class="fl">2</span></span>
<span>    </span>
<span><span class="va">rev_trans_raman_hdpe</span> <span class="op">&lt;-</span> <span class="va">trans_raman_hdpe</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adj_intens.html">adj_intens</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"transmittance"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/interactive_plots.html">plotly_spec</a></span><span class="op">(</span><span class="va">trans_raman_hdpe</span>, <span class="va">rev_trans_raman_hdpe</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"visdat":{"18f1707ad029":["function () ","plotlyVisDat"],"18f16ade9691":["function () ","data"]},"cur_data":"18f16ade9691","attrs":{"18f1707ad029":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"18f1707ad029.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"split":{},"line":{"color":"rgb(255, 255, 255)"},"name":"x1","showlegend":false,"inherit":true},"18f16ade9691":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"split":{},"name":"x2","line":{"dash":"dot","color":"rgb(255,0,0)"},"showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"wavenumber [cm<sup>-1<\/sup>]","autorange":"reversed"},"yaxis":{"domain":[0,1],"automargin":true,"title":"intensity [-]"},"plot_bgcolor":"rgba(17, 0, 73, 0)","paper_bgcolor":"rgb(0, 0, 0)","legend":{"orientation":"h","y":1.1000000000000001},"font":{"color":"#FFFFFF"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[301.04000000000002,304.63200000000001,308.221,311.81,315.39800000000002,318.983,322.56599999999997,326.14999999999998,329.73200000000003,333.31099999999998,336.88900000000001,340.46699999999998,344.04199999999997,347.61799999999999,351.19,354.75999999999999,358.33199999999999,361.89999999999998,365.46600000000001,369.03100000000001,372.59699999999998,376.16000000000003,379.721,383.27999999999997,386.839,390.39600000000002,393.95100000000002,397.505,401.05799999999999,404.61000000000001,408.16000000000003,411.70800000000003,415.25599999999997,418.80099999999999,422.346,425.887,429.42899999999997,432.97000000000003,436.50700000000001,440.04399999999998,443.58100000000002,447.11599999999999,450.64699999999999,454.18000000000001,457.70800000000003,461.238,464.76400000000001,468.291,471.815,475.339,478.85899999999998,482.37900000000002,485.899,489.416,492.93099999999998,496.447,499.95999999999998,503.471,506.98099999999999,510.48899999999998,513.99900000000002,517.50300000000004,521.00900000000001,524.50999999999999,528.01400000000001,531.51300000000003,535.01400000000001,538.50999999999999,542.00800000000004,545.50199999999995,548.99699999999996,552.48800000000006,555.97900000000004,559.46900000000005,562.95500000000004,566.44200000000001,569.928,573.41099999999994,576.89400000000001,580.37599999999998,583.85400000000004,587.33100000000002,590.81100000000004,594.28599999999994,597.75900000000001,601.23099999999999,604.70500000000004,608.17399999999998,611.64200000000005,615.10900000000004,618.57399999999996,622.03800000000001,625.50300000000004,628.96600000000001,632.42600000000004,635.88400000000001,639.34199999999998,642.798,646.25199999999995,649.70600000000002,653.15800000000002,656.60799999999995,660.05799999999999,663.50599999999997,666.95299999999997,670.39800000000002,673.84199999999998,677.28499999999997,680.72699999999998,684.16499999999996,687.60199999999998,691.03999999999996,694.476,697.91099999999994,701.34500000000003,704.77499999999998,708.20399999999995,711.63400000000001,715.06299999999999,718.49000000000001,721.91200000000003,725.33600000000001,728.75999999999999,732.17999999999995,735.59900000000005,739.01800000000003,742.43399999999997,745.84900000000005,749.26499999999999,752.67499999999995,756.08799999999997,759.49800000000005,762.90599999999995,766.31299999999999,769.71900000000005,773.12400000000002,776.52700000000004,779.92899999999997,783.33000000000004,786.72900000000004,790.12699999999995,793.524,796.91899999999998,800.31200000000001,803.70500000000004,807.09699999999998,810.48500000000001,813.87400000000002,817.26199999999994,820.64700000000005,824.03200000000004,827.41600000000005,830.79700000000003,834.17899999999997,837.55700000000002,840.93600000000004,844.31200000000001,847.68799999999999,851.06100000000004,854.43299999999999,857.80600000000004,861.17499999999995,864.54300000000001,867.90999999999997,871.27800000000002,874.64200000000005,878.005,881.36699999999996,884.72799999999995,888.08699999999999,891.44500000000005,894.80200000000002,898.15700000000004,901.51099999999997,904.86400000000003,908.21600000000001,911.56700000000001,914.91399999999999,918.26199999999994,921.60900000000004,924.95399999999995,928.29600000000005,931.63900000000001,934.98099999999999,938.32000000000005,941.65899999999999,944.995,948.33199999999999,951.66499999999996,954.99900000000002,958.33000000000004,961.65999999999997,964.99099999999999,968.31799999999998,971.64400000000001,974.971,978.29499999999996,981.61699999999996,984.94000000000005,988.25800000000004,991.57799999999997,994.89599999999996,998.21199999999999,1001.53,1004.84,1008.15,1011.46,1014.77,1018.08,1021.39,1024.7,1028,1031.3,1034.6099999999999,1037.9100000000001,1041.21,1044.51,1047.8,1051.0999999999999,1054.3900000000001,1057.6800000000001,1060.98,1064.27,1067.5599999999999,1070.8399999999999,1074.1300000000001,1077.4200000000001,1080.7,1083.98,1087.27,1090.55,1093.8299999999999,1097.0999999999999,1100.3800000000001,1103.6500000000001,1106.9300000000001,1110.2,1113.47,1116.74,1120.01,1123.28,1126.55,1129.8099999999999,1133.0799999999999,1136.3399999999999,1139.5999999999999,1142.8599999999999,1146.1199999999999,1149.3699999999999,1152.6300000000001,1155.8900000000001,1159.1400000000001,1162.3900000000001,1165.6400000000001,1168.8900000000001,1172.1400000000001,1175.3900000000001,1178.6400000000001,1181.8800000000001,1185.1199999999999,1188.3699999999999,1191.6099999999999,1194.8499999999999,1198.0899999999999,1201.3199999999999,1204.5599999999999,1207.79,1211.03,1214.26,1217.49,1220.72,1223.95,1227.1800000000001,1230.4000000000001,1233.6300000000001,1236.8499999999999,1240.0699999999999,1243.3,1246.52,1249.74,1252.95,1256.1700000000001,1259.3800000000001,1262.5999999999999,1265.8099999999999,1269.02,1272.23,1275.4400000000001,1278.6500000000001,1281.8499999999999,1285.0599999999999,1288.26,1291.46,1294.6700000000001,1297.8699999999999,1301.0699999999999,1304.26,1307.46,1310.6600000000001,1313.8499999999999,1317.04,1320.23,1323.4200000000001,1326.6099999999999,1329.8,1332.99,1336.1700000000001,1339.3599999999999,1342.54,1345.72,1348.9000000000001,1352.0799999999999,1355.26,1358.4400000000001,1361.6099999999999,1364.79,1367.96,1371.1300000000001,1374.3,1377.47,1380.6400000000001,1383.8099999999999,1386.97,1390.1400000000001,1393.3,1396.47,1399.6300000000001,1402.79,1405.95,1409.0999999999999,1412.26,1415.4100000000001,1418.5699999999999,1421.72,1424.8699999999999,1428.02,1431.1700000000001,1434.3199999999999,1437.47,1440.6099999999999,1443.76,1446.9000000000001,1450.04,1453.1800000000001,1456.3199999999999,1459.46,1462.5899999999999,1465.73,1468.8699999999999,1472,1475.1300000000001,1478.26,1481.4000000000001,1484.52,1487.6500000000001,1490.78,1493.9000000000001,1497.03,1500.1500000000001,1503.27,1506.3900000000001,1509.51,1512.6300000000001,1515.74,1518.8599999999999,1521.97,1525.0899999999999,1528.2,1531.3099999999999,1534.4200000000001,1537.53,1540.6400000000001,1543.74,1546.8499999999999,1549.95,1553.05,1556.1600000000001,1559.26,1562.3599999999999,1565.45,1568.55,1571.6500000000001,1574.74,1577.8299999999999,1580.9200000000001,1584.02,1587.1099999999999,1590.1900000000001,1593.28,1596.3699999999999,1599.45,1602.54,1605.6199999999999,1608.7,1611.78,1614.8599999999999,1617.9400000000001,1621.02,1624.0899999999999,1627.1700000000001,1630.24,1633.3099999999999,1636.3800000000001,1639.45,1642.52,1645.5899999999999,1648.6500000000001,1651.72,1654.78,1657.8499999999999,1660.9100000000001,1663.97,1667.03,1670.0899999999999,1673.1500000000001,1676.2,1679.26,1682.3099999999999,1685.3599999999999,1688.4100000000001,1691.46,1694.51,1697.5599999999999,1700.6099999999999,1703.6500000000001,1706.7,1709.74,1712.78,1715.8299999999999,1718.8599999999999,1721.9000000000001,1724.9400000000001,1727.98,1731.01,1734.05,1737.0799999999999,1740.1099999999999,1743.1400000000001,1746.1700000000001,1749.2,1752.23,1755.25,1758.28,1761.3,1764.3299999999999,1767.3499999999999,1770.3699999999999,1773.3900000000001,1776.4100000000001,1779.4200000000001,1782.4400000000001,1785.46,1788.47,1791.48,1794.49,1797.5,1800.51,1803.52,1806.53,1809.53,1812.54,1815.54,1818.54,1821.54,1824.55,1827.55,1830.54,1833.54,1836.54,1839.53,1842.52,1845.51,1848.51,1851.5,1854.49,1857.48,1860.46,1863.45,1866.4300000000001,1869.4100000000001,1872.4000000000001,1875.3800000000001,1878.3599999999999,1881.3399999999999,1884.3199999999999,1887.29,1890.27,1893.24,1896.22,1899.1900000000001,1902.1600000000001,1905.1300000000001,1908.0999999999999,1911.0699999999999,1914.03,1917,1919.96,1922.9300000000001,1925.8900000000001,1928.8499999999999,1931.8099999999999,1934.77,1937.4300000000001,1940.4000000000001,1943.3599999999999,1946.3299999999999,1949.3,1952.27,1955.23,1958.1900000000001,1961.1600000000001,1964.1199999999999,1967.0799999999999,1970.04,1972.99,1975.95,1978.9100000000001,1981.8599999999999,1984.8199999999999,1987.77,1990.72,1993.6700000000001,1996.6199999999999,1999.5699999999999,2002.52,2005.46,2008.4100000000001,2011.3499999999999,2014.29,2017.24,2020.1800000000001,2023.1199999999999,2026.05,2028.99,2031.9300000000001,2034.8699999999999,2037.8,2040.73,2043.6600000000001,2046.5999999999999,2049.52,2052.4499999999998,2055.3800000000001,2058.3099999999999,2061.23,2064.1599999999999,2067.0799999999999,2070,2072.9299999999998,2075.8499999999999,2078.77,2081.6799999999998,2084.5999999999999,2087.52,2090.4299999999998,2093.3400000000001,2096.2600000000002,2099.1700000000001,2102.0799999999999,2104.9899999999998,2107.9000000000001,2110.8099999999999,2113.71,2116.6199999999999,2119.52,2122.4299999999998,2125.3299999999999,2128.23,2131.1300000000001,2134.0300000000002,2136.9299999999998,2139.8200000000002,2142.7199999999998,2145.6100000000001,2148.5100000000002,2151.4000000000001,2154.29,2157.1799999999998,2160.0700000000002,2162.96,2165.8499999999999,2168.73,2171.6199999999999,2174.5,2177.3899999999999,2180.27,2183.1500000000001,2186.0300000000002,2188.9099999999999,2191.79,2194.6700000000001,2197.54,2200.4200000000001,2203.29,2206.1599999999999,2209.0300000000002,2211.9000000000001,2214.77,2217.6399999999999,2220.5100000000002,2223.3800000000001,2226.2399999999998,2229.1100000000001,2231.9699999999998,2234.8299999999999,2237.6900000000001,2240.5500000000002,2243.4099999999999,2246.27,2249.1300000000001,2251.98,2254.8400000000001,2257.6900000000001,2260.54,2263.3899999999999,2266.25,2269.0999999999999,2271.9400000000001,2274.79,2277.6399999999999,2280.4899999999998,2283.3299999999999,2286.1700000000001,2289.02,2291.8600000000001,2294.6999999999998,2297.54,2300.3800000000001,2303.21,2306.0500000000002,2308.8899999999999,2311.7199999999998,2314.5500000000002,2317.3899999999999,2320.2199999999998,2323.0500000000002,2325.8800000000001,2328.6999999999998,2331.5300000000002,2334.3600000000001,2337.1799999999998,2340.0100000000002,2342.8299999999999,2345.6500000000001,2348.4699999999998,2351.29,2354.1100000000001,2356.9299999999998,2359.75,2362.5599999999999,2365.3800000000001,2368.1900000000001,2371,2373.8200000000002,2376.6300000000001,2379.4400000000001,2382.25,2385.0500000000002,2387.8600000000001,2390.6700000000001,2393.4699999999998,2396.2800000000002,2399.0799999999999,2401.8800000000001,2404.6799999999998,2407.48,2410.2800000000002,2413.0799999999999,2415.8699999999999,2418.6700000000001,2421.46,2424.2600000000002,2427.0500000000002,2429.8400000000001,2432.6300000000001,2435.4200000000001,2438.21,2441,2443.79,2446.5700000000002,2449.3600000000001,2452.1399999999999,2454.9200000000001,2457.6999999999998,2460.48,2463.2600000000002,2466.04,2468.8200000000002,2471.5999999999999,2474.3699999999999,2477.1500000000001,2479.9200000000001,2482.6900000000001,2485.4699999999998,2488.2399999999998,2491.0100000000002,2493.77,2496.54,2499.3099999999999,2502.0700000000002,2504.8400000000001,2507.5999999999999,2510.3699999999999,2513.1300000000001,2515.8899999999999,2518.6500000000001,2521.4099999999999,2524.1599999999999,2526.9200000000001,2529.6799999999998,2532.4299999999998,2535.1900000000001,2537.9400000000001,2540.6900000000001,2543.4400000000001,2546.1900000000001,2548.9400000000001,2551.6900000000001,2554.4400000000001,2557.1799999999998,2559.9299999999998,2562.6700000000001,2565.4200000000001,2568.1599999999999,2570.9000000000001,2573.6399999999999,2576.3800000000001,2579.1100000000001,2581.8499999999999,2584.5900000000001,2587.3200000000002,2590.0599999999999,2592.79,2595.52,2598.25,2600.98,2603.7199999999998,2606.4400000000001,2609.1700000000001,2611.9000000000001,2614.6199999999999,2617.3499999999999,2620.0700000000002,2622.79,2625.5100000000002,2628.23,2630.9499999999998,2633.6700000000001,2636.3899999999999,2639.1100000000001,2641.8200000000002,2644.54,2647.25,2649.96,2652.6799999999998,2655.3899999999999,2658.0999999999999,2660.8099999999999,2663.5100000000002,2666.2199999999998,2668.9299999999998,2671.6300000000001,2674.3400000000001,2677.04,2679.7399999999998,2682.4400000000001,2685.1399999999999,2687.8400000000001,2690.54,2693.2399999999998,2695.9400000000001,2698.6300000000001,2701.3299999999999,2704.02,2706.71,2709.4099999999999,2712.0999999999999,2714.79,2717.4699999999998,2720.1599999999999,2722.8499999999999,2725.5300000000002,2728.2199999999998,2730.9000000000001,2733.5900000000001,2736.27,2738.9499999999998,2741.6300000000001,2744.3099999999999,2746.9899999999998,2749.6700000000001,2752.3400000000001,2755.02,2757.6900000000001,2760.3699999999999,2763.04,2765.71,2768.3800000000001,2771.0500000000002,2773.7199999999998,2776.3899999999999,2779.0599999999999,2781.7199999999998,2784.3899999999999,2787.0500000000002,2789.71,2792.3800000000001,2795.04,2797.6999999999998,2800.3600000000001,2803.02,2805.6799999999998,2808.3299999999999,2810.9899999999998,2813.6399999999999,2816.3000000000002,2818.9499999999998,2821.5999999999999,2824.25,2826.9000000000001,2829.5500000000002,2832.1999999999998,2834.8499999999999,2837.4899999999998,2840.1399999999999,2842.7800000000002,2845.4299999999998,2848.0700000000002,2850.71,2853.3499999999999,2855.9899999999998,2858.6300000000001,2861.27,2863.9099999999999,2866.54,2869.1799999999998,2871.8099999999999,2874.4499999999998,2877.0799999999999,2879.71,2882.3400000000001,2884.9699999999998,2887.5999999999999,2890.23,2892.8600000000001,2895.48,2898.1100000000001,2900.73,2903.3499999999999,2905.9699999999998,2908.5999999999999,2911.2199999999998,2913.8400000000001,2916.46,2919.0700000000002,2921.6900000000001,2924.3099999999999,2926.9200000000001,2929.54,2932.1500000000001,2934.7600000000002,2937.3699999999999,2939.98,2942.5900000000001,2945.1999999999998,2947.8099999999999,2950.4200000000001,2953.02,2955.6300000000001,2958.23,2960.8299999999999,2963.4400000000001,2966.04,2968.6399999999999,2971.2399999999998,2973.8299999999999,2976.4299999999998,2979.0300000000002,2981.6300000000001,2984.2199999999998,2986.8099999999999,2989.4099999999999,2992,2994.5900000000001,2997.1799999999998,2999.77,3002.3600000000001,3004.9499999999998,3007.5300000000002,3010.1199999999999,3012.6999999999998,3015.29,3017.8699999999999,3020.4499999999998,3023.04,3025.6199999999999,3028.1999999999998,3030.77,3033.3499999999999,3035.9299999999998,3038.5,3041.0799999999999,3043.6500000000001,3046.23,3048.8000000000002,3051.3699999999999,3053.9400000000001,3056.5100000000002,3059.0799999999999,3061.6500000000001,3064.21,3066.7800000000002,3069.3499999999999,3071.9099999999999,3074.4699999999998,3077.04,3079.5999999999999,3082.1599999999999,3084.7199999999998,3087.2800000000002,3089.8299999999999,3092.3899999999999,3094.9499999999998,3097.5,3100.0599999999999,3102.6100000000001,3105.1599999999999,3107.7199999999998,3110.27,3112.8200000000002,3115.3699999999999,3117.9099999999999,3120.46,3123.0100000000002,3125.5599999999999,3128.0999999999999,3130.6399999999999,3133.1900000000001,3135.73,3138.27,3140.8099999999999,3143.3499999999999,3145.8899999999999,3148.4299999999998,3150.96,3153.5,3156.0300000000002,3158.5700000000002,3161.0999999999999,3163.6399999999999,3166.1700000000001,3168.6999999999998,3171.23,3173.7600000000002,3175.3000000000002,3177.8400000000001,3180.3800000000001,3182.9099999999999,3185.4499999999998,3187.9899999999998,3190.52,3193.0599999999999,3195.5900000000001,3198.1199999999999],"y":[1,0.99725788508373669,0.99755254216903699,0.99797197750984701,0.99783517243452902,0.99836435250608857,0.99797197750984701,0.99810577588021288,0.99755254216903699,0.99783517243452902,0.99755254216903699,0.99810577588021288,0.99740671697886285,0.99695120117862834,0.99755254216903699,0.99679334916864604,0.99695120117862834,0.99783517243452902,0.9984891307615984,0.99725788508373669,0.99523737935596379,0.99613187407919657,0.99695120117862834,0.99797197750984701,0.99646862503382538,0.99836435250608857,0.99695120117862834,0.99810577588021288,0.99523737935596379,0.99613187407919657,0.99725788508373669,0.99578309630475959,0.99755254216903699,0.99769536065425901,0.99578309630475959,0.99595898854445408,0.99595898854445408,0.99278390811509665,0.99385880513545211,0.99186986980967562,0.99426771700892991,0.99300490092907179,0.99578309630475959,0.99322288703809491,0.99466460206259955,0.99679334916864604,0.99466460206259955,0.99504946029646113,0.99542229171051444,0.99630175290898704,0.99769536065425901,0.99695120117862834,0.99679334916864604,0.99595898854445408,0.99595898854445408,0.99823656754562673,0.99663249045371183,0.99646862503382538,0.99725788508373669,0.99769536065425901,0.99646862503382538,0.99595898854445408,0.99725788508373669,0.99769536065425901,0.99810577588021288,0.99646862503382538,0.99630175290898704,0.99595898854445408,0.99663249045371183,0.99695120117862834,0.99797197750984701,0.99485853453200634,0.99523737935596379,0.99523737935596379,0.99613187407919657,0.99646862503382538,0.99740671697886285,0.99466460206259955,0.99523737935596379,0.99679334916864604,0.99646862503382538,0.99578309630475959,0.99300490092907179,0.99504946029646113,0.99504946029646113,0.99426771700892991,0.99210288944345892,0.99278390811509665,0.99278390811509665,0.99163384347094019,0.99446766288824073,0.99446766288824073,0.99426771700892991,0.99560419736011307,0.99578309630475959,0.99755254216903699,0.99810577588021288,0.99613187407919657,0.99542229171051444,0.99578309630475959,0.99755254216903699,0.99578309630475959,0.99578309630475959,0.99823656754562673,0.99725788508373669,0.99740671697886285,0.99542229171051444,0.99595898854445408,0.99485853453200634,0.99278390811509665,0.99740671697886285,0.99485853453200634,0.99646862503382538,0.99646862503382538,0.99523737935596379,0.99695120117862834,0.99523737935596379,0.99646862503382538,0.99466460206259955,0.99663249045371183,0.99695120117862834,0.99446766288824073,0.99663249045371183,0.99663249045371183,0.99663249045371183,0.99560419736011307,0.99646862503382538,0.99630175290898704,0.99679334916864604,0.99542229171051444,0.99504946029646113,0.99679334916864604,0.99725788508373669,0.99523737935596379,0.99523737935596379,0.99364983914128502,0.99504946029646113,0.99542229171051444,0.99646862503382538,0.99630175290898704,0.99364983914128502,0.99523737935596379,0.99446766288824073,0.99560419736011307,0.99630175290898704,0.99426771700892991,0.99613187407919657,0.99485853453200634,0.99630175290898704,0.99710604648365853,0.99630175290898704,0.99578309630475959,0.99542229171051444,0.99679334916864604,0.99406476442466696,0.99485853453200634,0.99710604648365853,0.99560419736011307,0.99523737935596379,0.99523737935596379,0.99233290237229022,0.99466460206259955,0.99679334916864604,0.99406476442466696,0.99679334916864604,0.99710604648365853,0.99613187407919657,0.99679334916864604,0.99504946029646113,0.99560419736011307,0.99278390811509665,0.99578309630475959,0.99300490092907179,0.99710604648365853,0.99278390811509665,0.99466460206259955,0.99485853453200634,0.99578309630475959,0.99364983914128502,0.99542229171051444,0.99836435250608857,0.99343786644216603,0.99446766288824073,0.99695120117862834,0.99364983914128502,0.99426771700892991,0.99595898854445408,0.99466460206259955,0.99485853453200634,0.99446766288824073,0.99255990859616949,0.99578309630475959,0.99560419736011307,0.99485853453200634,0.99504946029646113,0.99406476442466696,0.99542229171051444,0.99679334916864604,0.99560419736011307,0.99426771700892991,0.99613187407919657,0.99278390811509665,0.99578309630475959,0.99485853453200634,0.99385880513545211,0.99233290237229022,0.99578309630475959,0.99466460206259955,0.99466460206259955,0.99255990859616949,0.98989747136113537,0.99186986980967562,0.99364983914128502,0.99233290237229022,0.99040861120298262,0.99186986980967562,0.99385880513545211,0.99446766288824073,0.99065967106647823,0.98883911121801615,0.98716136985477621,0.97638533930665383,0.97027421149162629,0.98568056766589496,0.99115277067861329,0.99233290237229022,0.99322288703809491,0.99015454463453501,0.99163384347094019,0.99065967106647823,0.99426771700892991,0.99163384347094019,0.99485853453200634,0.99139481042725275,0.99322288703809491,0.99278390811509665,0.99364983914128502,0.99115277067861329,0.99163384347094019,0.99090772422502182,0.9874485101776963,0.97972729186084972,0.96808683363901504,0.98773264379566428,0.99139481042725275,0.99343786644216603,0.99090772422502182,0.99233290237229022,0.99233290237229022,0.99233290237229022,0.99090772422502182,0.99300490092907179,0.99446766288824073,0.99139481042725275,0.99163384347094019,0.98568056766589496,0.99343786644216603,0.99065967106647823,0.99255990859616949,0.99446766288824073,0.99322288703809491,0.99233290237229022,0.99406476442466696,0.98937430469947985,0.99115277067861329,0.99446766288824073,0.99426771700892991,0.99406476442466696,0.99115277067861329,0.99426771700892991,0.99385880513545211,0.99186986980967562,0.99406476442466696,0.99485853453200634,0.99115277067861329,0.99065967106647823,0.99186986980967562,0.99278390811509665,0.99426771700892991,0.99485853453200634,0.99090772422502182,0.99322288703809491,0.99163384347094019,0.99466460206259955,0.99040861120298262,0.99233290237229022,0.98963739138278362,0.99255990859616949,0.99233290237229022,0.98963739138278362,0.99090772422502182,0.98568056766589496,0.97638533930665383,0.94088216723292939,0.97027421149162629,0.98444180522565317,0.98568056766589496,0.98963739138278362,0.99210288944345892,0.98937430469947985,0.99233290237229022,0.99163384347094019,0.9874485101776963,0.99233290237229022,0.99426771700892991,0.99090772422502182,0.99090772422502182,0.99364983914128502,0.99090772422502182,0.99322288703809491,0.98937430469947985,0.99446766288824073,0.99406476442466696,0.99343786644216603,0.99040861120298262,0.99278390811509665,0.98598274151357523,0.99065967106647823,0.99385880513545211,0.98856700441985623,0.99115277067861329,0.99210288944345892,0.99040861120298262,0.99255990859616949,0.98989747136113537,0.99343786644216603,0.9882918909167443,0.98773264379566428,0.99210288944345892,0.98801377070868035,0.98801377070868035,0.9828257013139301,0.98215821281457649,0.98506719985567814,0.98412459785321271,0.9828257013139301,0.97752638383595414,0.97827204666406087,0.95807901620613967,0.95338404642352448,0.95958988544454138,0.9759989777203163,0.98043687422953185,0.9807871553564449,0.97676869418803935,0.9732102588772964,0.97027421149162629,0.97676869418803935,0.98147869749541472,0.98568056766589496,0.99015454463453501,0.98801377070868035,0.98657806909407975,0.98963739138278362,0.98687122282690398,0.98773264379566428,0.9874485101776963,0.99015454463453501,0.98773264379566428,0.98801377070868035,0.99015454463453501,0.98801377070868035,0.99278390811509665,0.99255990859616949,0.99115277067861329,0.98444180522565317,0.9874485101776963,0.98444180522565317,0.98444180522565317,0.98506719985567814,0.98989747136113537,0.99015454463453501,0.98537538711326256,0.99255990859616949,0.99322288703809491,0.98910821131122406,0.98716136985477621,0.9882918909167443,0.98989747136113537,0.99015454463453501,0.98883911121801615,0.98598274151357523,0.98856700441985623,0.98937430469947985,0.98657806909407975,0.99065967106647823,0.99040861120298262,0.98801377070868035,0.98687122282690398,0.99343786644216603,0.99300490092907179,0.98937430469947985,0.99186986980967562,0.99040861120298262,0.98883911121801615,0.98687122282690398,0.98910821131122406,0.98937430469947985,0.98989747136113537,0.98910821131122406,0.98910821131122406,0.98910821131122406,0.98910821131122406,0.98716136985477621,0.98657806909407975,0.98506719985567814,0.98773264379566428,0.98856700441985623,0.98657806909407975,0.98348116299347543,0.99139481042725275,0.98598274151357523,0.98937430469947985,0.98568056766589496,0.98475600589314172,0.98856700441985623,0.98716136985477621,0.98657806909407975,0.98537538711326256,0.98716136985477621,0.98598274151357523,0.99090772422502182,0.98963739138278362,0.98380438377582002,0.98773264379566428,0.98444180522565317,0.98716136985477621,0.98444180522565317,0.98412459785321271,0.9828257013139301,0.98716136985477621,0.98937430469947985,0.98657806909407975,0.98773264379566428,0.98628190865630361,0.99015454463453501,0.98628190865630361,0.98801377070868035,0.98856700441985623,0.98716136985477621,0.98773264379566428,0.98506719985567814,0.98598274151357523,0.98412459785321271,0.98989747136113537,0.98444180522565317,0.98598274151357523,0.98883911121801615,0.98537538711326256,0.98598274151357523,0.98598274151357523,0.97900568267235932,0.97900568267235932,0.98380438377582002,0.98687122282690398,0.98773264379566428,0.9807871553564449,0.98444180522565317,0.98598274151357523,0.98657806909407975,0.98537538711326256,0.98380438377582002,0.9828257013139301,0.98598274151357523,0.98380438377582002,0.98568056766589496,0.98147869749541472,0.98412459785321271,0.98315493550617883,0.98113442977840581,0.9807871553564449,0.98348116299347543,0.98147869749541472,0.98215821281457649,0.9828257013139301,0.98215821281457649,0.98348116299347543,0.98380438377582002,0.98315493550617883,0.98315493550617883,0.98444180522565317,0.98537538711326256,0.98380438377582002,0.98249346041672936,0.98315493550617883,0.98348116299347543,0.98215821281457649,0.98348116299347543,0.98537538711326256,0.98444180522565317,0.9828257013139301,0.98348116299347543,0.9874485101776963,0.98380438377582002,0.98628190865630361,0.98412459785321271,0.9828257013139301,0.98113442977840581,0.98380438377582002,0.98598274151357523,0.98348116299347543,0.98380438377582002,0.98380438377582002,0.98181995850747161,0.98801377070868035,0.98181995850747161,0.97790071860248351,0.97972729186084972,0.98315493550617883,0.98568056766589496,0.98315493550617883,0.97936799061908053,0.98215821281457649,0.98348116299347543,0.98249346041672936,0.9807871553564449,0.98687122282690398,0.98412459785321271,0.98147869749541472,0.9807871553564449,0.97752638383595414,0.98315493550617883,0.98506719985567814,0.98147869749541472,0.9786403680206861,0.9786403680206861,0.98412459785321271,0.97790071860248351,0.98444180522565317,0.97936799061908053,0.98444180522565317,0.98008358639766679,0.98147869749541472,0.98444180522565317,0.98008358639766679,0.98113442977840581,0.98215821281457649,0.9807871553564449,0.98215821281457649,0.9748218527315915,0.9807871553564449,0.98412459785321271,0.98113442977840581,0.98181995850747161,0.98348116299347543,0.9732102588772964,0.97521723443278507,0.97827204666406087,0.98348116299347543,0.97936799061908053,0.97521723443278507,0.97900568267235932,0.97714904236447275,0.97790071860248351,0.97279984365134253,0.97560960942902675,0.9759989777203163,0.97972729186084972,0.97714904236447275,0.9732102588772964,0.97361766739829825,0.97361766739829825,0.97560960942902675,0.97560960942902675,0.97790071860248351,0.97714904236447275,0.9786403680206861,0.97521723443278507,0.97936799061908053,0.97155055774376864,0.97936799061908053,0.97238642172043654,0.97638533930665383,0.97676869418803935,0.97521723443278507,0.96897080489491572,0.9744234643254458,0.9711281156980065,0.97790071860248351,0.97827204666406087,0.97279984365134253,0.97521723443278507,0.97676869418803935,0.97638533930665383,0.97827204666406087,0.97361766739829825,0.97827204666406087,0.97900568267235932,0.97638533930665383,0.9711281156980065,0.9732102588772964,0.9732102588772964,0.97972729186084972,0.98147869749541472,0.9786403680206861,0.97676869418803935,0.97361766739829825,0.97238642172043654,0.97714904236447275,0.97752638383595414,0.98008358639766679,0.97900568267235932,0.9759989777203163,0.9744234643254458,0.97279984365134253,0.97521723443278507,0.98008358639766679,0.97070266694729246,0.98506719985567814,0.98181995850747161,0.97827204666406087,0.9828257013139301,0.97361766739829825,0.97638533930665383,0.9744234643254458,0.97900568267235932,0.97521723443278507,0.98008358639766679,0.98113442977840581,0.9786403680206861,0.97790071860248351,0.98147869749541472,0.97936799061908053,0.9732102588772964,0.9759989777203163,0.97827204666406087,0.97972729186084972,0.97972729186084972,0.98008358639766679,0.98147869749541472,0.9807871553564449,0.9807871553564449,0.97936799061908053,0.98348116299347543,0.98181995850747161,0.98147869749541472,0.9759989777203163,0.9807871553564449,0.9828257013139301,0.98315493550617883,0.98008358639766679,0.98506719985567814,0.97900568267235932,0.97936799061908053,0.98348116299347543,0.98348116299347543,0.97972729186084972,0.97560960942902675,0.98475600589314172,0.98380438377582002,0.9874485101776963,0.9828257013139301,0.98716136985477621,0.98043687422953185,0.98315493550617883,0.98249346041672936,0.98249346041672936,0.98215821281457649,0.98181995850747161,0.98215821281457649,0.98568056766589496,0.9828257013139301,0.98380438377582002,0.98716136985477621,0.98628190865630361,0.98444180522565317,0.98568056766589496,0.98628190865630361,0.98506719985567814,0.98687122282690398,0.98716136985477621,0.98348116299347543,0.98380438377582002,0.98506719985567814,0.98506719985567814,0.98215821281457649,0.98506719985567814,0.98113442977840581,0.98348116299347543,0.98380438377582002,0.98537538711326256,0.98348116299347543,0.98506719985567814,0.98537538711326256,0.98657806909407975,0.98537538711326256,0.98657806909407975,0.98444180522565317,0.98380438377582002,0.9874485101776963,0.98506719985567814,0.98215821281457649,0.98215821281457649,0.98444180522565317,0.98628190865630361,0.98444180522565317,0.98215821281457649,0.98628190865630361,0.98628190865630361,0.98412459785321271,0.98568056766589496,0.98687122282690398,0.98537538711326256,0.98628190865630361,0.98628190865630361,0.98537538711326256,0.9874485101776963,0.98315493550617883,0.98716136985477621,0.98598274151357523,0.98628190865630361,0.98506719985567814,0.98043687422953185,0.98598274151357523,0.98412459785321271,0.9828257013139301,0.98716136985477621,0.98687122282690398,0.98444180522565317,0.98657806909407975,0.98598274151357523,0.98883911121801615,0.98773264379566428,0.98380438377582002,0.98568056766589496,0.9882918909167443,0.98716136985477621,0.98412459785321271,0.98444180522565317,0.99233290237229022,0.98801377070868035,0.98475600589314172,0.98568056766589496,0.98475600589314172,0.9874485101776963,0.9874485101776963,0.98801377070868035,0.99115277067861329,0.98475600589314172,0.98716136985477621,0.98568056766589496,0.98657806909407975,0.98856700441985623,0.98506719985567814,0.99015454463453501,0.98598274151357523,0.98963739138278362,0.98963739138278362,0.98657806909407975,0.98598274151357523,0.98598274151357523,0.9874485101776963,0.98147869749541472,0.98716136985477621,0.98444180522565317,0.98412459785321271,0.99115277067861329,0.98716136985477621,0.98475600589314172,0.98506719985567814,0.98910821131122406,0.98348116299347543,0.9882918909167443,0.98910821131122406,0.98716136985477621,0.99115277067861329,0.98856700441985623,0.98598274151357523,0.98537538711326256,0.98506719985567814,0.98628190865630361,0.97972729186084972,0.98475600589314172,0.98687122282690398,0.98628190865630361,0.97638533930665383,0.9807871553564449,0.97714904236447275,0.97827204666406087,0.97560960942902675,0.97900568267235932,0.9748218527315915,0.98113442977840581,0.98249346041672936,0.98315493550617883,0.98537538711326256,0.98716136985477621,0.98348116299347543,0.98475600589314172,0.99090772422502182,0.98598274151357523,0.98380438377582002,0.98687122282690398,0.99115277067861329,0.98598274151357523,0.98568056766589496,0.98657806909407975,0.98657806909407975,0.98598274151357523,0.98537538711326256,0.98687122282690398,0.9874485101776963,0.98883911121801615,0.98801377070868035,0.98537538711326256,0.9874485101776963,0.98506719985567814,0.98412459785321271,0.98537538711326256,0.98628190865630361,0.98568056766589496,0.98043687422953185,0.98568056766589496,0.98475600589314172,0.98147869749541472,0.98215821281457649,0.97972729186084972,0.98412459785321271,0.9807871553564449,0.97521723443278507,0.9748218527315915,0.96808683363901504,0.95807901620613967,0.94088216723292939,0.86299497880273013,0.78621125108993051,0.6938753420126883,0.64153311885504671,0.67595387714603561,0.72175200697555553,0.77469557112360565,0.81048738687272615,0.83431101356023929,0.84899125048858959,0.86116690219188796,0.85840223698848428,0.86116690219188796,0.83230253465227455,0.75198743197330042,0.50223999518927209,0,0.33819417300580296,0.63414414143540099,0.76882497970474162,0.81474488108481913,0.84899125048858959,0.84514266814997441,0.84610932379205628,0.85840223698848428,0.88399380618779877,0.90402597793078565,0.90172133858504466,0.91586036862202713,0.92692504284554555,0.93216873628190866,0.92891397817132204,0.94148200487086198,0.93659911602874413,0.93344959259147897,0.92423103520851502,0.93722000060134103,0.95176493580684929,0.94900628401334974,0.96156228389308163,0.96808683363901504,0.98380438377582002,0.97972729186084972,0.9828257013139301,0.98181995850747161,0.98568056766589496,0.98315493550617883,0.98147869749541472,0.98444180522565317,0.98380438377582002,0.98773264379566428,0.98856700441985623,0.98687122282690398,0.98568056766589496,0.98963739138278362,0.98348116299347543,0.9874485101776963,0.98506719985567814,0.9874485101776963,0.98773264379566428,0.98716136985477621,0.98910821131122406,0.98910821131122406,0.98444180522565317,0.98773264379566428,0.99163384347094019,0.99015454463453501,0.98628190865630361,0.98801377070868035,0.99040861120298262,0.99210288944345892,0.9874485101776963,0.9882918909167443,0.99300490092907179,0.98910821131122406,0.98657806909407975,0.99322288703809491,0.99139481042725275,0.99115277067861329,0.98657806909407975,0.98963739138278362,0.99115277067861329,0.98989747136113537,0.9882918909167443,0.99015454463453501,0.98989747136113537,0.9882918909167443,0.98989747136113537,0.99090772422502182,0.98963739138278362,0.98989747136113537,0.98801377070868035,0.98963739138278362,0.98937430469947985,0.98963739138278362,0.99115277067861329,0.99090772422502182,0.98883911121801615,0.99233290237229022,0.98883911121801615,0.99065967106647823,0.99139481042725275,0.99255990859616949,0.99090772422502182,0.99065967106647823,0.99233290237229022,0.99278390811509665,0.99040861120298262,0.99065967106647823,0.99300490092907179,0.99278390811509665,0.99210288944345892,0.99210288944345892,0.99210288944345892,0.99115277067861329,0.99139481042725275,0.99210288944345892,0.99255990859616949,0.99406476442466696,0.99385880513545211,0.99210288944345892,0.99210288944345892,0.99300490092907179,0.99278390811509665,0.99115277067861329,0.99255990859616949,0.99406476442466696,0.99300490092907179,0.99255990859616949,0.99233290237229022,0.99210288944345892,0.99255990859616949,0.99210288944345892,0.99343786644216603,0.99210288944345892,0.99343786644216603,0.99343786644216603,0.99255990859616949,0.99255990859616949,0.99426771700892991],"line":{"color":"rgb(255, 255, 255)"},"name":"x1","showlegend":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[301.04000000000002,304.63200000000001,308.221,311.81,315.39800000000002,318.983,322.56599999999997,326.14999999999998,329.73200000000003,333.31099999999998,336.88900000000001,340.46699999999998,344.04199999999997,347.61799999999999,351.19,354.75999999999999,358.33199999999999,361.89999999999998,365.46600000000001,369.03100000000001,372.59699999999998,376.16000000000003,379.721,383.27999999999997,386.839,390.39600000000002,393.95100000000002,397.505,401.05799999999999,404.61000000000001,408.16000000000003,411.70800000000003,415.25599999999997,418.80099999999999,422.346,425.887,429.42899999999997,432.97000000000003,436.50700000000001,440.04399999999998,443.58100000000002,447.11599999999999,450.64699999999999,454.18000000000001,457.70800000000003,461.238,464.76400000000001,468.291,471.815,475.339,478.85899999999998,482.37900000000002,485.899,489.416,492.93099999999998,496.447,499.95999999999998,503.471,506.98099999999999,510.48899999999998,513.99900000000002,517.50300000000004,521.00900000000001,524.50999999999999,528.01400000000001,531.51300000000003,535.01400000000001,538.50999999999999,542.00800000000004,545.50199999999995,548.99699999999996,552.48800000000006,555.97900000000004,559.46900000000005,562.95500000000004,566.44200000000001,569.928,573.41099999999994,576.89400000000001,580.37599999999998,583.85400000000004,587.33100000000002,590.81100000000004,594.28599999999994,597.75900000000001,601.23099999999999,604.70500000000004,608.17399999999998,611.64200000000005,615.10900000000004,618.57399999999996,622.03800000000001,625.50300000000004,628.96600000000001,632.42600000000004,635.88400000000001,639.34199999999998,642.798,646.25199999999995,649.70600000000002,653.15800000000002,656.60799999999995,660.05799999999999,663.50599999999997,666.95299999999997,670.39800000000002,673.84199999999998,677.28499999999997,680.72699999999998,684.16499999999996,687.60199999999998,691.03999999999996,694.476,697.91099999999994,701.34500000000003,704.77499999999998,708.20399999999995,711.63400000000001,715.06299999999999,718.49000000000001,721.91200000000003,725.33600000000001,728.75999999999999,732.17999999999995,735.59900000000005,739.01800000000003,742.43399999999997,745.84900000000005,749.26499999999999,752.67499999999995,756.08799999999997,759.49800000000005,762.90599999999995,766.31299999999999,769.71900000000005,773.12400000000002,776.52700000000004,779.92899999999997,783.33000000000004,786.72900000000004,790.12699999999995,793.524,796.91899999999998,800.31200000000001,803.70500000000004,807.09699999999998,810.48500000000001,813.87400000000002,817.26199999999994,820.64700000000005,824.03200000000004,827.41600000000005,830.79700000000003,834.17899999999997,837.55700000000002,840.93600000000004,844.31200000000001,847.68799999999999,851.06100000000004,854.43299999999999,857.80600000000004,861.17499999999995,864.54300000000001,867.90999999999997,871.27800000000002,874.64200000000005,878.005,881.36699999999996,884.72799999999995,888.08699999999999,891.44500000000005,894.80200000000002,898.15700000000004,901.51099999999997,904.86400000000003,908.21600000000001,911.56700000000001,914.91399999999999,918.26199999999994,921.60900000000004,924.95399999999995,928.29600000000005,931.63900000000001,934.98099999999999,938.32000000000005,941.65899999999999,944.995,948.33199999999999,951.66499999999996,954.99900000000002,958.33000000000004,961.65999999999997,964.99099999999999,968.31799999999998,971.64400000000001,974.971,978.29499999999996,981.61699999999996,984.94000000000005,988.25800000000004,991.57799999999997,994.89599999999996,998.21199999999999,1001.53,1004.84,1008.15,1011.46,1014.77,1018.08,1021.39,1024.7,1028,1031.3,1034.6099999999999,1037.9100000000001,1041.21,1044.51,1047.8,1051.0999999999999,1054.3900000000001,1057.6800000000001,1060.98,1064.27,1067.5599999999999,1070.8399999999999,1074.1300000000001,1077.4200000000001,1080.7,1083.98,1087.27,1090.55,1093.8299999999999,1097.0999999999999,1100.3800000000001,1103.6500000000001,1106.9300000000001,1110.2,1113.47,1116.74,1120.01,1123.28,1126.55,1129.8099999999999,1133.0799999999999,1136.3399999999999,1139.5999999999999,1142.8599999999999,1146.1199999999999,1149.3699999999999,1152.6300000000001,1155.8900000000001,1159.1400000000001,1162.3900000000001,1165.6400000000001,1168.8900000000001,1172.1400000000001,1175.3900000000001,1178.6400000000001,1181.8800000000001,1185.1199999999999,1188.3699999999999,1191.6099999999999,1194.8499999999999,1198.0899999999999,1201.3199999999999,1204.5599999999999,1207.79,1211.03,1214.26,1217.49,1220.72,1223.95,1227.1800000000001,1230.4000000000001,1233.6300000000001,1236.8499999999999,1240.0699999999999,1243.3,1246.52,1249.74,1252.95,1256.1700000000001,1259.3800000000001,1262.5999999999999,1265.8099999999999,1269.02,1272.23,1275.4400000000001,1278.6500000000001,1281.8499999999999,1285.0599999999999,1288.26,1291.46,1294.6700000000001,1297.8699999999999,1301.0699999999999,1304.26,1307.46,1310.6600000000001,1313.8499999999999,1317.04,1320.23,1323.4200000000001,1326.6099999999999,1329.8,1332.99,1336.1700000000001,1339.3599999999999,1342.54,1345.72,1348.9000000000001,1352.0799999999999,1355.26,1358.4400000000001,1361.6099999999999,1364.79,1367.96,1371.1300000000001,1374.3,1377.47,1380.6400000000001,1383.8099999999999,1386.97,1390.1400000000001,1393.3,1396.47,1399.6300000000001,1402.79,1405.95,1409.0999999999999,1412.26,1415.4100000000001,1418.5699999999999,1421.72,1424.8699999999999,1428.02,1431.1700000000001,1434.3199999999999,1437.47,1440.6099999999999,1443.76,1446.9000000000001,1450.04,1453.1800000000001,1456.3199999999999,1459.46,1462.5899999999999,1465.73,1468.8699999999999,1472,1475.1300000000001,1478.26,1481.4000000000001,1484.52,1487.6500000000001,1490.78,1493.9000000000001,1497.03,1500.1500000000001,1503.27,1506.3900000000001,1509.51,1512.6300000000001,1515.74,1518.8599999999999,1521.97,1525.0899999999999,1528.2,1531.3099999999999,1534.4200000000001,1537.53,1540.6400000000001,1543.74,1546.8499999999999,1549.95,1553.05,1556.1600000000001,1559.26,1562.3599999999999,1565.45,1568.55,1571.6500000000001,1574.74,1577.8299999999999,1580.9200000000001,1584.02,1587.1099999999999,1590.1900000000001,1593.28,1596.3699999999999,1599.45,1602.54,1605.6199999999999,1608.7,1611.78,1614.8599999999999,1617.9400000000001,1621.02,1624.0899999999999,1627.1700000000001,1630.24,1633.3099999999999,1636.3800000000001,1639.45,1642.52,1645.5899999999999,1648.6500000000001,1651.72,1654.78,1657.8499999999999,1660.9100000000001,1663.97,1667.03,1670.0899999999999,1673.1500000000001,1676.2,1679.26,1682.3099999999999,1685.3599999999999,1688.4100000000001,1691.46,1694.51,1697.5599999999999,1700.6099999999999,1703.6500000000001,1706.7,1709.74,1712.78,1715.8299999999999,1718.8599999999999,1721.9000000000001,1724.9400000000001,1727.98,1731.01,1734.05,1737.0799999999999,1740.1099999999999,1743.1400000000001,1746.1700000000001,1749.2,1752.23,1755.25,1758.28,1761.3,1764.3299999999999,1767.3499999999999,1770.3699999999999,1773.3900000000001,1776.4100000000001,1779.4200000000001,1782.4400000000001,1785.46,1788.47,1791.48,1794.49,1797.5,1800.51,1803.52,1806.53,1809.53,1812.54,1815.54,1818.54,1821.54,1824.55,1827.55,1830.54,1833.54,1836.54,1839.53,1842.52,1845.51,1848.51,1851.5,1854.49,1857.48,1860.46,1863.45,1866.4300000000001,1869.4100000000001,1872.4000000000001,1875.3800000000001,1878.3599999999999,1881.3399999999999,1884.3199999999999,1887.29,1890.27,1893.24,1896.22,1899.1900000000001,1902.1600000000001,1905.1300000000001,1908.0999999999999,1911.0699999999999,1914.03,1917,1919.96,1922.9300000000001,1925.8900000000001,1928.8499999999999,1931.8099999999999,1934.77,1937.4300000000001,1940.4000000000001,1943.3599999999999,1946.3299999999999,1949.3,1952.27,1955.23,1958.1900000000001,1961.1600000000001,1964.1199999999999,1967.0799999999999,1970.04,1972.99,1975.95,1978.9100000000001,1981.8599999999999,1984.8199999999999,1987.77,1990.72,1993.6700000000001,1996.6199999999999,1999.5699999999999,2002.52,2005.46,2008.4100000000001,2011.3499999999999,2014.29,2017.24,2020.1800000000001,2023.1199999999999,2026.05,2028.99,2031.9300000000001,2034.8699999999999,2037.8,2040.73,2043.6600000000001,2046.5999999999999,2049.52,2052.4499999999998,2055.3800000000001,2058.3099999999999,2061.23,2064.1599999999999,2067.0799999999999,2070,2072.9299999999998,2075.8499999999999,2078.77,2081.6799999999998,2084.5999999999999,2087.52,2090.4299999999998,2093.3400000000001,2096.2600000000002,2099.1700000000001,2102.0799999999999,2104.9899999999998,2107.9000000000001,2110.8099999999999,2113.71,2116.6199999999999,2119.52,2122.4299999999998,2125.3299999999999,2128.23,2131.1300000000001,2134.0300000000002,2136.9299999999998,2139.8200000000002,2142.7199999999998,2145.6100000000001,2148.5100000000002,2151.4000000000001,2154.29,2157.1799999999998,2160.0700000000002,2162.96,2165.8499999999999,2168.73,2171.6199999999999,2174.5,2177.3899999999999,2180.27,2183.1500000000001,2186.0300000000002,2188.9099999999999,2191.79,2194.6700000000001,2197.54,2200.4200000000001,2203.29,2206.1599999999999,2209.0300000000002,2211.9000000000001,2214.77,2217.6399999999999,2220.5100000000002,2223.3800000000001,2226.2399999999998,2229.1100000000001,2231.9699999999998,2234.8299999999999,2237.6900000000001,2240.5500000000002,2243.4099999999999,2246.27,2249.1300000000001,2251.98,2254.8400000000001,2257.6900000000001,2260.54,2263.3899999999999,2266.25,2269.0999999999999,2271.9400000000001,2274.79,2277.6399999999999,2280.4899999999998,2283.3299999999999,2286.1700000000001,2289.02,2291.8600000000001,2294.6999999999998,2297.54,2300.3800000000001,2303.21,2306.0500000000002,2308.8899999999999,2311.7199999999998,2314.5500000000002,2317.3899999999999,2320.2199999999998,2323.0500000000002,2325.8800000000001,2328.6999999999998,2331.5300000000002,2334.3600000000001,2337.1799999999998,2340.0100000000002,2342.8299999999999,2345.6500000000001,2348.4699999999998,2351.29,2354.1100000000001,2356.9299999999998,2359.75,2362.5599999999999,2365.3800000000001,2368.1900000000001,2371,2373.8200000000002,2376.6300000000001,2379.4400000000001,2382.25,2385.0500000000002,2387.8600000000001,2390.6700000000001,2393.4699999999998,2396.2800000000002,2399.0799999999999,2401.8800000000001,2404.6799999999998,2407.48,2410.2800000000002,2413.0799999999999,2415.8699999999999,2418.6700000000001,2421.46,2424.2600000000002,2427.0500000000002,2429.8400000000001,2432.6300000000001,2435.4200000000001,2438.21,2441,2443.79,2446.5700000000002,2449.3600000000001,2452.1399999999999,2454.9200000000001,2457.6999999999998,2460.48,2463.2600000000002,2466.04,2468.8200000000002,2471.5999999999999,2474.3699999999999,2477.1500000000001,2479.9200000000001,2482.6900000000001,2485.4699999999998,2488.2399999999998,2491.0100000000002,2493.77,2496.54,2499.3099999999999,2502.0700000000002,2504.8400000000001,2507.5999999999999,2510.3699999999999,2513.1300000000001,2515.8899999999999,2518.6500000000001,2521.4099999999999,2524.1599999999999,2526.9200000000001,2529.6799999999998,2532.4299999999998,2535.1900000000001,2537.9400000000001,2540.6900000000001,2543.4400000000001,2546.1900000000001,2548.9400000000001,2551.6900000000001,2554.4400000000001,2557.1799999999998,2559.9299999999998,2562.6700000000001,2565.4200000000001,2568.1599999999999,2570.9000000000001,2573.6399999999999,2576.3800000000001,2579.1100000000001,2581.8499999999999,2584.5900000000001,2587.3200000000002,2590.0599999999999,2592.79,2595.52,2598.25,2600.98,2603.7199999999998,2606.4400000000001,2609.1700000000001,2611.9000000000001,2614.6199999999999,2617.3499999999999,2620.0700000000002,2622.79,2625.5100000000002,2628.23,2630.9499999999998,2633.6700000000001,2636.3899999999999,2639.1100000000001,2641.8200000000002,2644.54,2647.25,2649.96,2652.6799999999998,2655.3899999999999,2658.0999999999999,2660.8099999999999,2663.5100000000002,2666.2199999999998,2668.9299999999998,2671.6300000000001,2674.3400000000001,2677.04,2679.7399999999998,2682.4400000000001,2685.1399999999999,2687.8400000000001,2690.54,2693.2399999999998,2695.9400000000001,2698.6300000000001,2701.3299999999999,2704.02,2706.71,2709.4099999999999,2712.0999999999999,2714.79,2717.4699999999998,2720.1599999999999,2722.8499999999999,2725.5300000000002,2728.2199999999998,2730.9000000000001,2733.5900000000001,2736.27,2738.9499999999998,2741.6300000000001,2744.3099999999999,2746.9899999999998,2749.6700000000001,2752.3400000000001,2755.02,2757.6900000000001,2760.3699999999999,2763.04,2765.71,2768.3800000000001,2771.0500000000002,2773.7199999999998,2776.3899999999999,2779.0599999999999,2781.7199999999998,2784.3899999999999,2787.0500000000002,2789.71,2792.3800000000001,2795.04,2797.6999999999998,2800.3600000000001,2803.02,2805.6799999999998,2808.3299999999999,2810.9899999999998,2813.6399999999999,2816.3000000000002,2818.9499999999998,2821.5999999999999,2824.25,2826.9000000000001,2829.5500000000002,2832.1999999999998,2834.8499999999999,2837.4899999999998,2840.1399999999999,2842.7800000000002,2845.4299999999998,2848.0700000000002,2850.71,2853.3499999999999,2855.9899999999998,2858.6300000000001,2861.27,2863.9099999999999,2866.54,2869.1799999999998,2871.8099999999999,2874.4499999999998,2877.0799999999999,2879.71,2882.3400000000001,2884.9699999999998,2887.5999999999999,2890.23,2892.8600000000001,2895.48,2898.1100000000001,2900.73,2903.3499999999999,2905.9699999999998,2908.5999999999999,2911.2199999999998,2913.8400000000001,2916.46,2919.0700000000002,2921.6900000000001,2924.3099999999999,2926.9200000000001,2929.54,2932.1500000000001,2934.7600000000002,2937.3699999999999,2939.98,2942.5900000000001,2945.1999999999998,2947.8099999999999,2950.4200000000001,2953.02,2955.6300000000001,2958.23,2960.8299999999999,2963.4400000000001,2966.04,2968.6399999999999,2971.2399999999998,2973.8299999999999,2976.4299999999998,2979.0300000000002,2981.6300000000001,2984.2199999999998,2986.8099999999999,2989.4099999999999,2992,2994.5900000000001,2997.1799999999998,2999.77,3002.3600000000001,3004.9499999999998,3007.5300000000002,3010.1199999999999,3012.6999999999998,3015.29,3017.8699999999999,3020.4499999999998,3023.04,3025.6199999999999,3028.1999999999998,3030.77,3033.3499999999999,3035.9299999999998,3038.5,3041.0799999999999,3043.6500000000001,3046.23,3048.8000000000002,3051.3699999999999,3053.9400000000001,3056.5100000000002,3059.0799999999999,3061.6500000000001,3064.21,3066.7800000000002,3069.3499999999999,3071.9099999999999,3074.4699999999998,3077.04,3079.5999999999999,3082.1599999999999,3084.7199999999998,3087.2800000000002,3089.8299999999999,3092.3899999999999,3094.9499999999998,3097.5,3100.0599999999999,3102.6100000000001,3105.1599999999999,3107.7199999999998,3110.27,3112.8200000000002,3115.3699999999999,3117.9099999999999,3120.46,3123.0100000000002,3125.5599999999999,3128.0999999999999,3130.6399999999999,3133.1900000000001,3135.73,3138.27,3140.8099999999999,3143.3499999999999,3145.8899999999999,3148.4299999999998,3150.96,3153.5,3156.0300000000002,3158.5700000000002,3161.0999999999999,3163.6399999999999,3166.1700000000001,3168.6999999999998,3171.23,3173.7600000000002,3175.3000000000002,3177.8400000000001,3180.3800000000001,3182.9099999999999,3185.4499999999998,3187.9899999999998,3190.52,3193.0599999999999,3195.5900000000001,3198.1199999999999],"y":[0,0.00020479678281937051,0.0001827631244454214,0.00015141010959716193,0.00016163491345947258,0.00012209179708108945,0.00015141010959716193,0.00014141138238459594,0.0001827631244454214,0.00016163491345947258,0.0001827631244454214,0.00014141138238459594,0.0001936667234368011,0.00022773668948861228,0.0001827631244454214,0.00023954674538245339,0.00022773668948861228,0.00016163491345947258,0.00011277076376843145,0.00020479678281937051,0.00035606033178085925,0.0002890568512200403,0.00022773668948861228,0.00015141010959716193,0.00026384759956552374,0.00012209179708108945,0.00022773668948861228,0.00014141138238459594,0.00035606033178085925,0.0002890568512200403,0.00020479678281937051,0.00031517541905475547,0.0001827631244454214,0.00017208588677858052,0.00031517541905475547,0.00030200241187254751,0.00030200241187254751,0.00054015088757523302,0.00045944253556065188,0.00060884998291730501,0.00042876241543635856,0.00052355056828310082,0.00031517541905475547,0.00050717972261445348,0.00039899671596918876,0.00023954674538245339,0.00039899671596918876,0.0003701443477291128,0.00034220425568096824,0.00027633861908273543,0.00017208588677858052,0.00022773668948861228,0.00023954674538245339,0.00030200241187254751,0.00030200241187254751,0.00013163864109542534,0.00025158367888818107,0.00026384759956552374,0.00020479678281937051,0.00017208588677858052,0.00026384759956552374,0.00030200241187254751,0.00020479678281937051,0.00017208588677858052,0.00014141138238459594,0.00026384759956552374,0.00027633861908273543,0.00030200241187254751,0.00025158367888818107,0.00022773668948861228,0.00015141010959716193,0.00038445643219003672,0.00035606033178085925,0.00035606033178085925,0.0002890568512200403,0.00026384759956552374,0.0001936667234368011,0.00039899671596918876,0.00035606033178085925,0.00023954674538245339,0.00026384759956552374,0.00031517541905475547,0.00052355056828310082,0.0003701443477291128,0.0003701443477291128,0.00042876241543635856,0.0005913302226783284,0.00054015088757523302,0.00054015088757523302,0.00062660000099029221,0.00041376533201774822,0.00041376533201774822,0.00042876241543635856,0.00032857599290320188,0.00031517541905475547,0.0001827631244454214,0.00014141138238459594,0.0002890568512200403,0.00034220425568096824,0.00031517541905475547,0.0001827631244454214,0.00031517541905475547,0.00031517541905475547,0.00013163864109542534,0.00020479678281937051,0.0001936667234368011,0.00034220425568096824,0.00030200241187254751,0.00038445643219003672,0.00054015088757523302,0.0001936667234368011,0.00038445643219003672,0.00026384759956552374,0.00026384759956552374,0.00035606033178085925,0.00022773668948861228,0.00035606033178085925,0.00026384759956552374,0.00039899671596918876,0.00025158367888818107,0.00022773668948861228,0.00041376533201774822,0.00025158367888818107,0.00025158367888818107,0.00025158367888818107,0.00032857599290320188,0.00026384759956552374,0.00027633861908273543,0.00023954674538245339,0.00034220425568096824,0.0003701443477291128,0.00023954674538245339,0.00020479678281937051,0.00035606033178085925,0.00035606033178085925,0.00047512585325375982,0.0003701443477291128,0.00034220425568096824,0.00026384759956552374,0.00027633861908273543,0.00047512585325375982,0.00035606033178085925,0.00041376533201774822,0.00032857599290320188,0.00027633861908273543,0.00042876241543635856,0.0002890568512200403,0.00038445643219003672,0.00027633861908273543,0.0002161534037518776,0.00027633861908273543,0.00031517541905475547,0.00034220425568096824,0.00023954674538245339,0.00044398810347976396,0.00038445643219003672,0.0002161534037518776,0.00032857599290320188,0.00035606033178085925,0.00035606033178085925,0.00057404055903283212,0.00039899671596918876,0.00023954674538245339,0.00044398810347976396,0.00023954674538245339,0.0002161534037518776,0.0002890568512200403,0.00023954674538245339,0.0003701443477291128,0.00032857599290320188,0.00054015088757523302,0.00031517541905475547,0.00052355056828310082,0.0002161534037518776,0.00054015088757523302,0.00039899671596918876,0.00038445643219003672,0.00031517541905475547,0.00047512585325375982,0.00034220425568096824,0.00012209179708108945,0.00049103820030077733,0.00041376533201774822,0.00022773668948861228,0.00047512585325375982,0.00042876241543635856,0.00030200241187254751,0.00039899671596918876,0.00038445643219003672,0.00041376533201774822,0.00055698083294420135,0.00031517541905475547,0.00032857599290320188,0.00038445643219003672,0.0003701443477291128,0.00044398810347976396,0.00034220425568096824,0.00023954674538245339,0.00032857599290320188,0.00042876241543635856,0.0002890568512200403,0.00054015088757523302,0.00031517541905475547,0.00038445643219003672,0.00045944253556065188,0.00057404055903283212,0.00031517541905475547,0.00039899671596918876,0.00039899671596918876,0.00055698083294420135,0.00075731135627471143,0.00060884998291730501,0.00047512585325375982,0.00057404055903283212,0.00071880975721070163,0.00060884998291730501,0.00045944253556065188,0.00041376533201774822,0.00069990595386016188,0.00083709555337611017,0.00096374678383190718,0.0017823873779483663,0.0022506657741288402,0.0010757102101022645,0.00066279146665113487,0.00057404055903283212,0.00050717972261445348,0.00073794483241094826,0.00062660000099029221,0.00069990595386016188,0.00042876241543635856,0.00062660000099029221,0.00038445643219003672,0.00064458044034690354,0.00050717972261445348,0.00054015088757523302,0.00047512585325375982,0.00066279146665113487,0.00062660000099029221,0.00068123324778626628,0.00094205555157084425,0.001527541166608743,0.002418995436381465,0.00092059766060343458,0.00064458044034690354,0.00049103820030077733,0.00068123324778626628,0.00057404055903283212,0.00057404055903283212,0.00057404055903283212,0.00068123324778626628,0.00052355056828310082,0.00041376533201774822,0.00064458044034690354,0.00062660000099029221,0.0010757102101022645,0.00049103820030077733,0.00069990595386016188,0.00055698083294420135,0.00041376533201774822,0.00050717972261445348,0.00057404055903283212,0.00044398810347976396,0.00079673946848435589,0.00066279146665113487,0.00041376533201774822,0.00042876241543635856,0.00044398810347976396,0.00066279146665113487,0.00042876241543635856,0.00045944253556065188,0.00060884998291730501,0.00044398810347976396,0.00038445643219003672,0.00066279146665113487,0.00069990595386016188,0.00060884998291730501,0.00054015088757523302,0.00042876241543635856,0.00038445643219003672,0.00068123324778626628,0.00050717972261445348,0.00062660000099029221,0.00039899671596918876,0.00071880975721070163,0.00057404055903283212,0.00077690950786184817,0.00055698083294420135,0.00057404055903283212,0.00077690950786184817,0.00068123324778626628,0.0010757102101022645,0.0017823873779483663,0.0045449072807760118,0.0022506657741288402,0.0011695023024812044,0.0010757102101022645,0.00077690950786184817,0.0005913302226783284,0.00079673946848435589,0.00057404055903283212,0.00062660000099029221,0.00094205555157084425,0.00057404055903283212,0.00042876241543635856,0.00068123324778626628,0.00068123324778626628,0.00047512585325375982,0.00068123324778626628,0.00050717972261445348,0.00079673946848435589,0.00041376533201774822,0.00044398810347976396,0.00049103820030077733,0.00071880975721070163,0.00054015088757523302,0.0010528491973903296,0.00069990595386016188,0.00045944253556065188,0.00085762205157974031,0.00066279146665113487,0.0005913302226783284,0.00071880975721070163,0.00055698083294420135,0.00075731135627471143,0.00049103820030077733,0.0008783811066991671,0.00092059766060343458,0.0005913302226783284,0.00089937291139215029,0.00089937291139215029,0.0012920421401675668,0.0013427127515114174,0.00112213621282781,0.0011935384326987879,0.0012920421401675668,0.0016952771721683161,0.0016384063171171023,0.0031940297480212623,0.0035604159295972632,0.0030765062616309223,0.001811906264440132,0.0014735426627221077,0.0014469010276367373,0.0017531097529439579,0.0020253178050531743,0.0022506657741288402,0.0017531097529439579,0.0013943317318681646,0.0010757102101022645,0.00073794483241094826,0.00089937291139215029,0.0010078300819183358,0.00077690950786184817,0.00098567155922928726,0.00092059766060343458,0.00094205555157084425,0.00073794483241094826,0.00092059766060343458,0.00089937291139215029,0.00073794483241094826,0.00089937291139215029,0.00054015088757523302,0.00055698083294420135,0.00066279146665113487,0.0011695023024812044,0.00094205555157084425,0.0011695023024812044,0.0011695023024812044,0.00112213621282781,0.00075731135627471143,0.00073794483241094826,0.0010988058099768308,0.00055698083294420135,0.00050717972261445348,0.0008168014217115405,0.00096374678383190718,0.0008783811066991671,0.00075731135627471143,0.00073794483241094826,0.00083709555337611017,0.0010528491973903296,0.00085762205157974031,0.00079673946848435589,0.0010078300819183358,0.00069990595386016188,0.00071880975721070163,0.00089937291139215029,0.00098567155922928726,0.00049103820030077733,0.00052355056828310082,0.00079673946848435589,0.00060884998291730501,0.00071880975721070163,0.00083709555337611017,0.00098567155922928726,0.0008168014217115405,0.00079673946848435589,0.00075731135627471143,0.0008168014217115405,0.0008168014217115405,0.0008168014217115405,0.0008168014217115405,0.00096374678383190718,0.0010078300819183358,0.00112213621282781,0.00092059766060343458,0.00085762205157974031,0.0010078300819183358,0.0012423179902421057,0.00064458044034690354,0.0010528491973903296,0.00079673946848435589,0.0010757102101022645,0.0011457016368210202,0.00085762205157974031,0.00096374678383190718,0.0010078300819183358,0.0010988058099768308,0.00096374678383190718,0.0010528491973903296,0.00068123324778626628,0.00077690950786184817,0.0012178102527378274,0.00092059766060343458,0.0011695023024812044,0.00096374678383190718,0.0011695023024812044,0.0011935384326987879,0.0012920421401675668,0.00096374678383190718,0.00079673946848435589,0.0010078300819183358,0.00092059766060343458,0.0010302225583725233,0.00073794483241094826,0.0010302225583725233,0.00089937291139215029,0.00085762205157974031,0.00096374678383190718,0.00092059766060343458,0.00112213621282781,0.0010528491973903296,0.0011935384326987879,0.00075731135627471143,0.0011695023024812044,0.0010528491973903296,0.00083709555337611017,0.0010988058099768308,0.0010528491973903296,0.0010528491973903296,0.0015824950233318243,0.0015824950233318243,0.0012178102527378274,0.00098567155922928726,0.00092059766060343458,0.0014469010276367373,0.0011695023024812044,0.0010528491973903296,0.0010078300819183358,0.0010988058099768308,0.0012178102527378274,0.0012920421401675668,0.0010528491973903296,0.0012178102527378274,0.0010757102101022645,0.0013943317318681646,0.0011935384326987879,0.0012670618752432124,0.0014204974671534862,0.0014469010276367373,0.0012423179902421057,0.0013943317318681646,0.0013427127515114174,0.0012920421401675668,0.0013427127515114174,0.0012423179902421057,0.0012178102527378274,0.0012670618752432124,0.0012670618752432124,0.0011695023024812044,0.0010988058099768308,0.0012178102527378274,0.0013172590198441017,0.0012670618752432124,0.0012423179902421057,0.0013427127515114174,0.0012423179902421057,0.0010988058099768308,0.0011695023024812044,0.0012920421401675668,0.0012423179902421057,0.00094205555157084425,0.0012178102527378274,0.0010302225583725233,0.0011935384326987879,0.0012920421401675668,0.0014204974671534862,0.0012178102527378274,0.0010528491973903296,0.0012423179902421057,0.0012178102527378274,0.0012178102527378274,0.0013684035748255988,0.00089937291139215029,0.0013684035748255988,0.0016667216651525946,0.001527541166608743,0.0012670618752432124,0.0010757102101022645,0.0012670618752432124,0.001554898546535277,0.0013427127515114174,0.0012423179902421057,0.0013172590198441017,0.0014469010276367373,0.00098567155922928726,0.0011935384326987879,0.0013943317318681646,0.0014469010276367373,0.0016952771721683161,0.0012670618752432124,0.00112213621282781,0.0013943317318681646,0.0016103308587691468,0.0016103308587691468,0.0011935384326987879,0.0016667216651525946,0.0011695023024812044,0.001554898546535277,0.0011695023024812044,0.0015004226242707529,0.0013943317318681646,0.0011695023024812044,0.0015004226242707529,0.0014204974671534862,0.0013427127515114174,0.0014469010276367373,0.0013427127515114174,0.0019019133257600111,0.0014469010276367373,0.0011935384326987879,0.0014204974671534862,0.0013684035748255988,0.0012423179902421057,0.0020253178050531743,0.0018716689524801711,0.0016384063171171023,0.0012423179902421057,0.001554898546535277,0.0018716689524801711,0.0015824950233318243,0.0017240731099817592,0.0016667216651525946,0.0020567771527397853,0.0018416666944255022,0.001811906264440132,0.001527541166608743,0.0017240731099817592,0.0020253178050531743,0.00199410204739571,0.00199410204739571,0.0018416666944255022,0.0018416666944255022,0.0016667216651525946,0.0017240731099817592,0.0016103308587691468,0.0018716689524801711,0.001554898546535277,0.0021526197775696746,0.001554898546535277,0.0020884803932901541,0.0017823873779483663,0.0017531097529439579,0.0018716689524801711,0.0023509236794700332,0.0019324001040091541,0.0021850565402479834,0.0016667216651525946,0.0016384063171171023,0.0020567771527397853,0.0018716689524801711,0.0017531097529439579,0.0017823873779483663,0.0016384063171171023,0.00199410204739571,0.0016384063171171023,0.0015824950233318243,0.0017823873779483663,0.0021850565402479834,0.0020253178050531743,0.0020253178050531743,0.001527541166608743,0.0013943317318681646,0.0016103308587691468,0.0017531097529439579,0.00199410204739571,0.0020884803932901541,0.0017240731099817592,0.0016952771721683161,0.0015004226242707529,0.0015824950233318243,0.001811906264440132,0.0019324001040091541,0.0020567771527397853,0.0018716689524801711,0.0015004226242707529,0.0022177384337087672,0.00112213621282781,0.0013684035748255988,0.0016384063171171023,0.0012920421401675668,0.00199410204739571,0.0017823873779483663,0.0019324001040091541,0.0015824950233318243,0.0018716689524801711,0.0015004226242707529,0.0014204974671534862,0.0016103308587691468,0.0016667216651525946,0.0013943317318681646,0.001554898546535277,0.0020253178050531743,0.001811906264440132,0.0016384063171171023,0.001527541166608743,0.001527541166608743,0.0015004226242707529,0.0013943317318681646,0.0014469010276367373,0.0014469010276367373,0.001554898546535277,0.0012423179902421057,0.0013684035748255988,0.0013943317318681646,0.001811906264440132,0.0014469010276367373,0.0012920421401675668,0.0012670618752432124,0.0015004226242707529,0.00112213621282781,0.0015824950233318243,0.001554898546535277,0.0012423179902421057,0.0012423179902421057,0.001527541166608743,0.0018416666944255022,0.0011457016368210202,0.0012178102527378274,0.00094205555157084425,0.0012920421401675668,0.00096374678383190718,0.0014735426627221077,0.0012670618752432124,0.0013172590198441017,0.0013172590198441017,0.0013427127515114174,0.0013684035748255988,0.0013427127515114174,0.0010757102101022645,0.0012920421401675668,0.0012178102527378274,0.00096374678383190718,0.0010302225583725233,0.0011695023024812044,0.0010757102101022645,0.0010302225583725233,0.00112213621282781,0.00098567155922928726,0.00096374678383190718,0.0012423179902421057,0.0012178102527378274,0.00112213621282781,0.00112213621282781,0.0013427127515114174,0.00112213621282781,0.0014204974671534862,0.0012423179902421057,0.0012178102527378274,0.0010988058099768308,0.0012423179902421057,0.00112213621282781,0.0010988058099768308,0.0010078300819183358,0.0010988058099768308,0.0010078300819183358,0.0011695023024812044,0.0012178102527378274,0.00094205555157084425,0.00112213621282781,0.0013427127515114174,0.0013427127515114174,0.0011695023024812044,0.0010302225583725233,0.0011695023024812044,0.0013427127515114174,0.0010302225583725233,0.0010302225583725233,0.0011935384326987879,0.0010757102101022645,0.00098567155922928726,0.0010988058099768308,0.0010302225583725233,0.0010302225583725233,0.0010988058099768308,0.00094205555157084425,0.0012670618752432124,0.00096374678383190718,0.0010528491973903296,0.0010302225583725233,0.00112213621282781,0.0014735426627221077,0.0010528491973903296,0.0011935384326987879,0.0012920421401675668,0.00096374678383190718,0.00098567155922928726,0.0011695023024812044,0.0010078300819183358,0.0010528491973903296,0.00083709555337611017,0.00092059766060343458,0.0012178102527378274,0.0010757102101022645,0.0008783811066991671,0.00096374678383190718,0.0011935384326987879,0.0011695023024812044,0.00057404055903283212,0.00089937291139215029,0.0011457016368210202,0.0010757102101022645,0.0011457016368210202,0.00094205555157084425,0.00094205555157084425,0.00089937291139215029,0.00066279146665113487,0.0011457016368210202,0.00096374678383190718,0.0010757102101022645,0.0010078300819183358,0.00085762205157974031,0.00112213621282781,0.00073794483241094826,0.0010528491973903296,0.00077690950786184817,0.00077690950786184817,0.0010078300819183358,0.0010528491973903296,0.0010528491973903296,0.00094205555157084425,0.0013943317318681646,0.00096374678383190718,0.0011695023024812044,0.0011935384326987879,0.00066279146665113487,0.00096374678383190718,0.0011457016368210202,0.00112213621282781,0.0008168014217115405,0.0012423179902421057,0.0008783811066991671,0.0008168014217115405,0.00096374678383190718,0.00066279146665113487,0.00085762205157974031,0.0010528491973903296,0.0010988058099768308,0.00112213621282781,0.0010302225583725233,0.001527541166608743,0.0011457016368210202,0.00098567155922928726,0.0010302225583725233,0.0017823873779483663,0.0014469010276367373,0.0017240731099817592,0.0016384063171171023,0.0018416666944255022,0.0015824950233318243,0.0019019133257600111,0.0014204974671534862,0.0013172590198441017,0.0012670618752432124,0.0010988058099768308,0.00096374678383190718,0.0012423179902421057,0.0011457016368210202,0.00068123324778626628,0.0010528491973903296,0.0012178102527378274,0.00098567155922928726,0.00066279146665113487,0.0010528491973903296,0.0010757102101022645,0.0010078300819183358,0.0010078300819183358,0.0010528491973903296,0.0010988058099768308,0.00098567155922928726,0.00094205555157084425,0.00083709555337611017,0.00089937291139215029,0.0010988058099768308,0.00094205555157084425,0.00112213621282781,0.0011935384326987879,0.0010988058099768308,0.0010302225583725233,0.0010757102101022645,0.0014735426627221077,0.0010757102101022645,0.0011457016368210202,0.0013943317318681646,0.0013427127515114174,0.001527541166608743,0.0011935384326987879,0.0014469010276367373,0.0018716689524801711,0.0019019133257600111,0.002418995436381465,0.0031940297480212623,0.0045449072807760118,0.010989573875886666,0.017939489485187341,0.027257409835666699,0.03310708320523785,0.029209064216081531,0.024319630993290844,0.019039993560290604,0.015671394405160806,0.013510682904006996,0.012209755097940367,0.011147730636986125,0.011387555675598616,0.011147730636986125,0.013690447348990938,0.02125888398439851,0.051363755623669419,1,0.080858228849511729,0.03397109438630571,0.019607332629060514,0.015280633754643596,0.012209755097940367,0.012548618779795248,0.012463360856817842,0.011387555675598616,0.009196504471299112,0.0075252400778487777,0.0077156184068952896,0.0065552237510352633,0.0056595695223908222,0.005238834708664466,0.0054997050987852722,0.0044973736060606494,0.0048851976924790654,0.0051364231479855381,0.0058766533100504765,0.004835771799246393,0.0036871866623681285,0.0039036770710474834,0.0029233607180431829,0.002418995436381465,0.0012178102527378274,0.001527541166608743,0.0012920421401675668,0.0013684035748255988,0.0010757102101022645,0.0012670618752432124,0.0013943317318681646,0.0011695023024812044,0.0012178102527378274,0.00092059766060343458,0.00085762205157974031,0.00098567155922928726,0.0010757102101022645,0.00077690950786184817,0.0012423179902421057,0.00094205555157084425,0.00112213621282781,0.00094205555157084425,0.00092059766060343458,0.00096374678383190718,0.0008168014217115405,0.0008168014217115405,0.0011695023024812044,0.00092059766060343458,0.00062660000099029221,0.00073794483241094826,0.0010302225583725233,0.00089937291139215029,0.00071880975721070163,0.0005913302226783284,0.00094205555157084425,0.0008783811066991671,0.00052355056828310082,0.0008168014217115405,0.0010078300819183358,0.00050717972261445348,0.00064458044034690354,0.00066279146665113487,0.0010078300819183358,0.00077690950786184817,0.00066279146665113487,0.00075731135627471143,0.0008783811066991671,0.00073794483241094826,0.00075731135627471143,0.0008783811066991671,0.00075731135627471143,0.00068123324778626628,0.00077690950786184817,0.00075731135627471143,0.00089937291139215029,0.00077690950786184817,0.00079673946848435589,0.00077690950786184817,0.00066279146665113487,0.00068123324778626628,0.00083709555337611017,0.00057404055903283212,0.00083709555337611017,0.00069990595386016188,0.00064458044034690354,0.00055698083294420135,0.00068123324778626628,0.00069990595386016188,0.00057404055903283212,0.00054015088757523302,0.00071880975721070163,0.00069990595386016188,0.00052355056828310082,0.00054015088757523302,0.0005913302226783284,0.0005913302226783284,0.0005913302226783284,0.00066279146665113487,0.00064458044034690354,0.0005913302226783284,0.00055698083294420135,0.00044398810347976396,0.00045944253556065188,0.0005913302226783284,0.0005913302226783284,0.00052355056828310082,0.00054015088757523302,0.00066279146665113487,0.00055698083294420135,0.00044398810347976396,0.00052355056828310082,0.00055698083294420135,0.00057404055903283212,0.0005913302226783284,0.00055698083294420135,0.0005913302226783284,0.00049103820030077733,0.0005913302226783284,0.00049103820030077733,0.00049103820030077733,0.00055698083294420135,0.00055698083294420135,0.00042876241543635856],"name":"x2","line":{"color":"rgb(255,0,0)","dash":"dot"},"showlegend":false,"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="conforming">Conforming<a class="anchor" aria-label="anchor" href="#conforming"></a>
</h3>
<p>Conforming spectra is essential before comparing to a reference
library and can be useful for summarizing data when you don’t need it to
be highly resolved spectrally. We set the default spectral resolution to
8 because this tends to be pretty good for a lot of applications and is
in between 4 and 8 which are commonly used wavenumber resolutions. There
are several ways that this function can be specified.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/conform_spec.html">conform_spec</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, res <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># convert res to 8 wavenumbers.</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $wavenumber</span></span>
<span><span class="co">#&gt;  Length Min. Max.     Res.</span></span>
<span><span class="co">#&gt;     362  304 3192 7.977901</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $spectra</span></span>
<span><span class="co">#&gt;  Number Min. Intensity Max. Intensity</span></span>
<span><span class="co">#&gt;       1       42.85152       602.4639</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metadata</span></span>
<span><span class="co">#&gt;   Min. Max.</span></span>
<span><span class="co">#&gt; x    1    1</span></span>
<span><span class="co">#&gt; y    1    1</span></span>
<span><span class="co">#&gt; [1] "x"                 "y"                 "user_name"        </span></span>
<span><span class="co">#&gt; [4] "spectrum_type"     "spectrum_identity" "organization"     </span></span>
<span><span class="co">#&gt; [7] "license"           "session_id"        "file_id"</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Force one spectrum to have the exact same wavenumbers as another</span></span>
<span><span class="fu"><a href="../reference/conform_spec.html">conform_spec</a></span><span class="op">(</span><span class="va">asp_example</span>, range <span class="op">=</span> <span class="va">ps_example</span><span class="op">$</span><span class="va">wavenumber</span>, res <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $wavenumber</span></span>
<span><span class="co">#&gt;  Length     Min.     Max.     Res.</span></span>
<span><span class="co">#&gt;    1736 651.8728 3998.025 1.927507</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $spectra</span></span>
<span><span class="co">#&gt;  Number Min. Intensity Max. Intensity</span></span>
<span><span class="co">#&gt;       1   0.0009781419      0.5156938</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metadata</span></span>
<span><span class="co">#&gt;   Min. Max.</span></span>
<span><span class="co">#&gt; x    1    1</span></span>
<span><span class="co">#&gt; y    1    1</span></span>
<span><span class="co">#&gt; [1] "x"          "y"          "file_name"  "license"    "col_id"    </span></span>
<span><span class="co">#&gt; [6] "session_id" "file_id"</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Specify the wavenumber resolution and use a rolling join instead of linear</span></span>
<span><span class="co"># approximation (faster for large datasets). </span></span>
<span><span class="fu"><a href="../reference/conform_spec.html">conform_spec</a></span><span class="op">(</span><span class="va">spectral_map</span>, range <span class="op">=</span> <span class="va">ps_example</span><span class="op">$</span><span class="va">wavenumber</span>, res <span class="op">=</span> <span class="fl">10</span>,</span>
<span>             type <span class="op">=</span> <span class="st">"roll"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $wavenumber</span></span>
<span><span class="co">#&gt;  Length Min. Max.     Res.</span></span>
<span><span class="co">#&gt;     329  720 4000 9.969605</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $spectra</span></span>
<span><span class="co">#&gt;  Number Min. Intensity Max. Intensity</span></span>
<span><span class="co">#&gt;     208      -1.317072       1.168225</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metadata</span></span>
<span><span class="co">#&gt;   Min. Max.</span></span>
<span><span class="co">#&gt; x    0   15</span></span>
<span><span class="co">#&gt; y    0   12</span></span>
<span><span class="co">#&gt;  [1] "y"             "x"             "file_name"     "license"      </span></span>
<span><span class="co">#&gt;  [5] "description"   "samples"       "lines"         "bands"        </span></span>
<span><span class="co">#&gt;  [9] "header offset" "data type"     "interleave"    "z plot titles"</span></span>
<span><span class="co">#&gt; [13] "pixel size"    "col_id"        "session_id"    "file_id"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="smoothing">Smoothing<a class="anchor" aria-label="anchor" href="#smoothing"></a>
</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Savitzky%E2%80%93Golay_filter" class="external-link">Savitzky-Golay
filter</a> is used for smoothing. Higher polynomial numbers lead to more
wiggly fits and thus less smoothing, lower numbers lead to more smooth
fits. The SG filter is fit to a moving window of 11 data points by
default where the center point in the window is replaced with the
polynomial estimate. Larger windows will produce smoother fits. The
derivative order is set to 1 by default which transforms the spectra to
their first derivative. A zero order derivative will have no derivative
transformation. When smoothing is done well, peak shapes and relative
heights should not change. The absolute value is primarily useful for
first derivative spectra where the absolute value results in an
absorbance-like spectrum which is why we set it as the default. You’ll
notice a new function we are using <code><a href="../reference/manage_spec.html">c_spec()</a></code> which is used
to combine spectral objects into one OpenSpecy object.</p>
<p>Examples of smoothing:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">none</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_rel.html">make_rel</a></span><span class="op">(</span><span class="va">raman_hdpe</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_intens.html">smooth_intens</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, polynomial <span class="op">=</span> <span class="fl">1</span>, derivative <span class="op">=</span> <span class="fl">0</span>, abs <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_intens.html">smooth_intens</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, polynomial <span class="op">=</span> <span class="fl">4</span>, derivative <span class="op">=</span> <span class="fl">0</span>, abs <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/manage_spec.html">c_spec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">none</span>, <span class="va">p1</span>, <span class="va">p4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="sop_files/figure-html/smooth_intens-1.png" alt="Sample `raman_hdpe` spectrum with different smoothing polynomials." width="480"><p class="caption">
Sample <code>raman_hdpe</code> spectrum with different smoothing
polynomials.
</p>
</div>
<p>Derivative transformation can happen with the same function.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">none</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_rel.html">make_rel</a></span><span class="op">(</span><span class="va">raman_hdpe</span><span class="op">)</span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_intens.html">smooth_intens</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, derivative <span class="op">=</span> <span class="fl">1</span>, abs <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_intens.html">smooth_intens</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, derivative <span class="op">=</span> <span class="fl">2</span>, abs <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/manage_spec.html">c_spec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">none</span>, <span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="sop_files/figure-html/compare_derivative-1.png" alt="Sample `raman_hdpe` spectrum with different derivatives." width="480"><p class="caption">
Sample <code>raman_hdpe</code> spectrum with different derivatives.
</p>
</div>
</div>
<div class="section level3">
<h3 id="baseline-correction">Baseline Correction<a class="anchor" aria-label="anchor" href="#baseline-correction"></a>
</h3>
<p>The goal of baseline correction is to get all non-peak regions of the
spectra to zero absorbance. The higher the polynomial order, the more
wiggly the fit to the baseline. If the baseline is not very wiggly, a
more wiggly fit could remove peaks which is not desired. The baseline
correction algorithm used in Open Specy is called “iModPolyfit” (Zhao et
al. 2007). This algorithm iteratively fits polynomial equations of the
specified order to the whole spectrum. During the first fit iteration,
peak regions will often be above the baseline fit. The data in the peak
region is removed from the fit to make sure that the baseline is less
likely to fit to the peaks. The iterative fitting terminates once the
difference between the new and previous fit is small. An example of a
good baseline fit below. Manual baseline correction can also be
specified by providing a baseline <code>OpenSpecy</code> object.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alternative_baseline</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smooth_intens.html">smooth_intens</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, polynomial <span class="op">=</span> <span class="fl">1</span>, window <span class="op">=</span> <span class="fl">51</span>,</span>
<span>                                      derivative <span class="op">=</span> <span class="fl">0</span>, abs <span class="op">=</span> <span class="cn">F</span>, make_rel <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/adj_range.html">flatten_range</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">2700</span>, max <span class="op">=</span> <span class="fl">3200</span>, make_rel <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="va">none</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_rel.html">make_rel</a></span><span class="op">(</span><span class="va">raman_hdpe</span><span class="op">)</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subtr_baseline.html">subtr_baseline</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, type <span class="op">=</span> <span class="st">"manual"</span>,</span>
<span>                     baseline <span class="op">=</span> <span class="va">alternative_baseline</span><span class="op">)</span></span>
<span><span class="va">d8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subtr_baseline.html">subtr_baseline</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, degree <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/manage_spec.html">c_spec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">none</span>, <span class="va">d2</span>, <span class="va">d8</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="sop_files/figure-html/subtr_baseline-1.png" alt="Sample `raman_hdpe` spectrum with different degrees of background subtraction (Cowger et al., 2020)." width="480"><p class="caption">
Sample <code>raman_hdpe</code> spectrum with different degrees of
background subtraction (Cowger et al., 2020).
</p>
</div>
</div>
<div class="section level3">
<h3 id="range-selection">Range Selection<a class="anchor" aria-label="anchor" href="#range-selection"></a>
</h3>
<p>Sometimes an instrument operates with high noise at the ends of the
spectrum and, a baseline fit produces distortions, or there are regions
of interest for analysis. Range selection accomplishes those goals. You
should look into the signal to noise ratio of your specific instrument
by wavelength to determine what wavelength ranges to use. Distortions
due to baseline fit can be assessed from looking at the process spectra.
Additionally, you can restrict the range to examine a single peak or a
subset of peaks of interests. Multiple ranges can be specified
simultaneously.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">none</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_rel.html">make_rel</a></span><span class="op">(</span><span class="va">raman_hdpe</span><span class="op">)</span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adj_range.html">restrict_range</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, min <span class="op">=</span> <span class="fl">1000</span>, max <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adj_range.html">restrict_range</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1800</span><span class="op">)</span>, max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1200</span>, <span class="fl">2000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">compare_ranges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manage_spec.html">c_spec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">none</span>, <span class="va">r1</span>, <span class="va">r2</span><span class="op">)</span>, range <span class="op">=</span> <span class="st">"common"</span><span class="op">)</span></span>
<span><span class="co"># Common argument crops the ranges to the most common range between the spectra</span></span>
<span><span class="co"># when joining. </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">compare_ranges</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="sop_files/figure-html/restrict_range-1.png" alt="Sample `raman_hdpe` spectrum with different degrees of range restriction." width="480"><p class="caption">
Sample <code>raman_hdpe</code> spectrum with different degrees of range
restriction.
</p>
</div>
</div>
<div class="section level3">
<h3 id="flattening-ranges">Flattening Ranges<a class="anchor" aria-label="anchor" href="#flattening-ranges"></a>
</h3>
<p>Sometimes there are peaks that really shouldn’t be in your spectra
and can distort your interpretation of the spectra but you don’t
necessarily want to remove the regions from the analysis because you
believe those regions should be flat instead of having a peak. One way
to deal with this is to replace the peak values with the mean of the
values around the peak. This is the purpose of the
<code>flatten_range</code> function. By default it is set to flatten the
CO2 region for FTIR spectra because that region often needs to be
flattened when atmospheric artifacts occur in spectra. Like
<code>restrict_range</code>, the R function can accept multiple
ranges.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/match_spec.html">filter_spec</a></span><span class="op">(</span><span class="va">spectral_map</span>, <span class="fl">120</span><span class="op">)</span> <span class="co"># Function to filter spectra by index</span></span>
<span>                                         <span class="co"># number or name or a logical vector. </span></span>
<span><span class="va">none</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_rel.html">make_rel</a></span><span class="op">(</span><span class="va">single</span><span class="op">)</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adj_range.html">flatten_range</a></span><span class="op">(</span><span class="va">single</span><span class="op">)</span> <span class="co">#default flattening the CO2 region. </span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adj_range.html">flatten_range</a></span><span class="op">(</span><span class="va">single</span>, min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">2500</span><span class="op">)</span>, max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1200</span>, <span class="fl">3000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">compare_flats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manage_spec.html">c_spec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">none</span>, <span class="va">f1</span>, <span class="va">f2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">compare_flats</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="sop_files/figure-html/flatten_range-1.png" alt="Sample `raman_hdpe` spectrum with different degrees of background subtraction (Cowger et al., 2020)." width="480"><p class="caption">
Sample <code>raman_hdpe</code> spectrum with different degrees of
background subtraction (Cowger et al., 2020).
</p>
</div>
</div>
<div class="section level3">
<h3 id="min-max-normalization">Min-Max Normalization<a class="anchor" aria-label="anchor" href="#min-max-normalization"></a>
</h3>
<p>Often we regard spectral intensities as arbitrary and min-max
normalization allows us to view spectra on the same scale without
drastically distorting their shapes or relative peak intensities. In the
package, most of the processing functions will min-max transform your
spectra by default if you do not specify otherwise. This plot shows two
plots that are nearly identical except for the min-max transformed
spectrum has a y axis that ranges from 0-1.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">relative</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_rel.html">make_rel</a></span><span class="op">(</span><span class="va">raman_hdpe</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="identifying-spectra">Identifying Spectra<a class="anchor" aria-label="anchor" href="#identifying-spectra"></a>
</h2>
<div class="section level3">
<h3 id="reading-libraries">Reading Libraries<a class="anchor" aria-label="anchor" href="#reading-libraries"></a>
</h3>
<p>Reference libraries are spectra with known identities. The Open Specy
library now has over 10,000 spectra in it an is getting so large that we
cannot fit it within the R package size limit of 5 MB. We host the
reference libraries on <a href="https://osf.io/x7dpz/" class="external-link">OSF</a> and have
a function to pull the libraries down automatically. Running get_lib by
itself will download all libraries to your package director or you can
specify which libraries you want and where you want them.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/manage_lib.html">get_lib</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"derivative"</span><span class="op">)</span></span></code></pre></div>
<p>After download the libraries you can load them into your active
environment. You should load them one at a time. Libraries are also
<code>OpenSpecy</code> objects so you can use any Open Specy object as a
library.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/manage_lib.html">load_lib</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"derivative"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="matches">Matches<a class="anchor" aria-label="anchor" href="#matches"></a>
</h3>
<p>Before attempting to use a reference library to identify spectra it
is really important to understand what format the reference library is
in. All the OpenSpecy reference libraries are in Absorbance units.
<code>derivative</code> has been absolute first derivative transformed,
<code>nobaseline</code> has been baseline corrected, <code>raw</code> is
the rawest form of the reference spectra (not recommended except for
advanced uses). The previously mentioned libraries all have Raman and
FTIR spectra in them. <code>mediod</code> is the mediod compressed
library version of the absolute first derivative for FTIR,
<code>model</code> is an exception because it is a multinomial
regression approach for FTIR to identification of absolute derivative
spectra. In this example we use the <code>data("test_lib")</code> which
is a subsampled version of the absolute derivative library and
<code>data("raman_hdpe")</code> which is an unprocessed Raman spectrum
in absorbance units of HDPE plastic. With single spectra it is easy to
look at the spectra but when doing in batch, also refer to the
Thresholding Signal-Noise section for guidance on making sure your batch
spectra are processed to quality specs.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"test_lib"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"raman_hdpe"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">processed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_spec.html">process_spec</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">raman_hdpe</span>, </span>
<span>                          conform_spec <span class="op">=</span> <span class="cn">F</span>, <span class="co">#We will conform during matching. </span></span>
<span>                          smooth_intens <span class="op">=</span> <span class="cn">T</span> <span class="co">#Conducts the default derivative transformation. </span></span>
<span>                          <span class="op">)</span></span>
<span></span>
<span><span class="co"># Check to make sure that the signal to noise ratio of the processed spectra is</span></span>
<span><span class="co"># greater than 10.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/sig_noise.html">sig_noise</a></span><span class="op">(</span><span class="va">processed</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/interactive_plots.html">plotly_spec</a></span><span class="op">(</span><span class="va">raman_hdpe</span>, <span class="va">processed</span><span class="op">)</span></span></code></pre></div>
<p>After your spectra is processed similarly to the library
specifications, you can identify the spectra using
<code><a href="../reference/match_spec.html">match_spec()</a></code>. All of the libraries have wavenumbers at 8
cm^-1 resolution. Whichever library you choose, you need to get your
spectra into a similar enough format to use for comparison. That means
conforming the wavenumbers to the same values using
<code>conform = T</code>. Alternatively, you could have done the
conformation during the processing. The
<code>add_library_metadata</code> and <code>add_object_metadata</code>
options specify the column name in the metadata that you want to add
metadata from and <code>top_n</code> specifies how many matches you
want. In this example we just identified a single spectrum with the
library but you can also send an OpenSpecy object with multiple spectra.
The output <code>matches</code> is a data.table with at least 3 columns,
<code>object_id</code> tells you the column names of the spectra in
<code>x</code>, <code>library_id</code> tells you the column names from
the library that it matched to. <code>match_val</code> is the value of
the Pearson correlation coefficient (default) or other correlation if
specified in <code>...</code> or if using the model identification
option <code>match_val</code> will be the model confidence. The output
in this example returned the correct material type, HDPE, as the top
match. If using Pearson correlation, 0.7 is a good threshold to use for
a positive ID. In this example, only our top match is greater than the
threshold so we would disregard the other matches. If no matches were
above our threshold, we would proclaim that the spectrum is of an
unknown identity. You’ll also notice in this example that we matched to
a library with both Raman and FTIR spectra but the Raman spectra had the
highest hits, this is the rationale for lazily matching to a library
with both. If you want to just match to a library with FTIR or Raman
spectra, you can first filter the library using
<code><a href="../reference/match_spec.html">filter_spec()</a></code> using <code>SpectrumType</code>.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">matches</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/match_spec.html">match_spec</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">processed</span>, library <span class="op">=</span> <span class="va">test_lib</span>, conform <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                      add_library_metadata <span class="op">=</span> <span class="st">"sample_name"</span>, top_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">matches</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"object_id"</span>, <span class="st">"library_id"</span>, <span class="st">"match_val"</span>, <span class="st">"SpectrumType"</span>,</span>
<span>                 <span class="st">"SpectrumIdentity"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="library-metadata">Library Metadata<a class="anchor" aria-label="anchor" href="#library-metadata"></a>
</h3>
<p>The libraries we have created have over 100 variables of metadata in
them and this can be onerous to read through especially given that many
of the variables are <code>NA</code> values. We created
<code><a href="../reference/match_spec.html">get_metadata()</a></code> to remedy this by removing columns from the
metadata which are all blank values. The function below will return the
metadata for the top match in <code>matches</code>. Remember, similar
<code><a href="../reference/match_spec.html">filter_spec()</a></code>, you can specify <code>logic</code> for more
than one thing at a time.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/match_spec.html">get_metadata</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">test_lib</span>, logic <span class="op">=</span> <span class="va">matches</span><span class="op">[[</span><span class="fl">1</span>,<span class="st">"library_id"</span><span class="op">]</span><span class="op">]</span>, rm_empty <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-matches">Plot Matches<a class="anchor" aria-label="anchor" href="#plot-matches"></a>
</h3>
<p>Overlaying unknown spectra and the best matches can be extremely
useful to identify peaks that don’t fit to the reference library which
may need further investigation. The example below shows great
correspondence between the best match and the unknown spectrum. All
major peaks are accounted for and the correct relative height. There are
two small peaks in the unknown spectrum near 500 that are not accounted
for which could be investigated further but we would call this a
positive id to HDPE.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/interactive_plots.html">plotly_spec</a></span><span class="op">(</span><span class="va">processed</span>, <span class="fu"><a href="../reference/match_spec.html">filter_spec</a></span><span class="op">(</span><span class="va">test_lib</span>, logic <span class="op">=</span> <span class="va">matches</span><span class="op">[[</span><span class="fl">1</span>,<span class="st">"library_id"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sharing-reference-data">Sharing Reference Data<a class="anchor" aria-label="anchor" href="#sharing-reference-data"></a>
</h3>
<p>If you have reference data or AI models that you think would be
useful for sharing with the spectroscopy community through OpenSpecy
please contact the package administrator to discuss options for
collaborating.</p>
</div>
</div>
<div class="section level2">
<h2 id="characterizing-particles">Characterizing Particles<a class="anchor" aria-label="anchor" href="#characterizing-particles"></a>
</h2>
<p>Sometimes the spectroscopy task we want to perform is to identify
particles in a spectral map. This is especially common for microplastic
analysis where a spectral map is used to image a sample and spectral
information is used to differentiate microplastic particles from
nonplastic particles. In addition to the material id, one often wants to
measure the shape and size of the particles. In a brute force technique,
one could first identify every spectrum in the map, then use
thresholding and image analysis to measure the particles. However, more
often than not, particles are well separated on the image surface and
background spectra is quite different from particle spectra and
therefore we can use thresholding a priori to identify and measure the
particles, then pass an exemplary spectrum for each particle to the
identification routine. It is important to note here that this is at the
bleeding edge of theory and technique so we may be updating these
functions in the near future.</p>
<div class="section level3">
<h3 id="brute-force">Brute Force<a class="anchor" aria-label="anchor" href="#brute-force"></a>
</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"test_lib"</span><span class="op">)</span></span>
<span><span class="va">test_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_multi.html">read_any</a></span><span class="op">(</span><span class="fu"><a href="../reference/read_ext.html">read_extdata</a></span><span class="op">(</span><span class="st">"CA_tiny_map.zip"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_map_processed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_spec.html">process_spec</a></span><span class="op">(</span><span class="va">test_map</span>, conform_spec_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  range <span class="op">=</span> <span class="va">test_lib</span><span class="op">$</span><span class="va">wavenumber</span>, res <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">identities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/match_spec.html">match_spec</a></span><span class="op">(</span><span class="va">test_map_processed</span>, <span class="va">test_lib</span>, order <span class="op">=</span> <span class="va">test_map</span>,</span>
<span>                         add_library_metadata <span class="op">=</span> <span class="st">"sample_name"</span>, top_n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">identities</span><span class="op">$</span><span class="va">match_val</span> <span class="op">&gt;</span> <span class="fl">0.7</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">identities</span><span class="op">$</span><span class="va">polymer_class</span><span class="op">)</span>, <span class="st">"unknown"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">id_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/def_features.html">def_features</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">test_map_processed</span>, features <span class="op">=</span> <span class="va">features</span><span class="op">)</span></span>
<span></span>
<span><span class="va">id_map</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">identities</span> <span class="op">&lt;-</span> <span class="va">features</span></span>
<span><span class="co"># Also should probably be implemented automatically in the function when a</span></span>
<span><span class="co"># character value is provided. </span></span>
<span></span>
<span><span class="co"># Collapses spectra to their median for each particle</span></span>
<span><span class="va">test_collapsed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/def_features.html">collapse_spec</a></span><span class="op">(</span><span class="va">id_map</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="a-priori-particle-thresholding">A Priori Particle Thresholding<a class="anchor" aria-label="anchor" href="#a-priori-particle-thresholding"></a>
</h3>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"test_lib"</span><span class="op">)</span></span>
<span><span class="va">test_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_multi.html">read_any</a></span><span class="op">(</span><span class="fu"><a href="../reference/read_ext.html">read_extdata</a></span><span class="op">(</span><span class="st">"CA_tiny_map.zip"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Characterize the total signal as a threshold value. </span></span>
<span><span class="va">snr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sig_noise.html">sig_noise</a></span><span class="op">(</span><span class="va">test_map</span>,metric <span class="op">=</span> <span class="st">"log_tot_sig"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use this to find your particles and the sig_noise value to use for</span></span>
<span><span class="co"># thresholding. </span></span>
<span><span class="fu"><a href="../reference/interactive_plots.html">heatmap_spec</a></span><span class="op">(</span><span class="va">test_map</span>, z <span class="op">=</span> <span class="va">snr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set define the feature regions based on the threshold. 400 appeared to be</span></span>
<span><span class="co"># where I suspected my particle to be in the previous heatmap. </span></span>
<span><span class="va">id_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/def_features.html">def_features</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">test_map</span>, features <span class="op">=</span> <span class="va">snr</span> <span class="op">&gt;</span> <span class="fl">400</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Check that the thresholding worked as expected.</span></span>
<span><span class="fu"><a href="../reference/interactive_plots.html">heatmap_spec</a></span><span class="op">(</span><span class="va">id_map</span>, z <span class="op">=</span> <span class="va">id_map</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">feature_id</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Collapse the spectra to their medians based on the threshold. Important to</span></span>
<span><span class="co"># note here that the particles with id -88 are anything from the FALSE values</span></span>
<span><span class="co"># so they should be your background. </span></span>
<span><span class="va">collapsed_id_map</span> <span class="op">&lt;-</span> <span class="va">id_map</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/def_features.html">collapse_spec</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Process the collapsed spectra. </span></span>
<span><span class="va">id_map_processed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_spec.html">process_spec</a></span><span class="op">(</span><span class="va">collapsed_id_map</span>, conform_spec_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  range <span class="op">=</span> <span class="va">test_lib</span><span class="op">$</span><span class="va">wavenumber</span>, res <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the spectra.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">id_map_processed</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the matches of the collapsed spectra for the particles.</span></span>
<span><span class="va">matches</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/match_spec.html">match_spec</a></span><span class="op">(</span><span class="va">id_map_processed</span>, <span class="va">test_lib</span>,</span>
<span>                      add_library_metadata <span class="op">=</span> <span class="st">"sample_name"</span>, top_n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Chabuka BK, Kalivas JH (2020). “Application of a Hybrid Fusion
Classification Process for Identification of Microplastics Based on
Fourier Transform Infrared Spectroscopy.” <em>Applied Spectroscopy</em>,
<strong>74</strong>(9), 1167–1183. doi: <a href="https://doi.org/10.1177/0003702820923993" class="external-link">10.1177/0003702820923993</a>.</p>
<p>Cowger W, Gray A, Christiansen SH, De Frond H, Deshpande AD,
Hemabessiere L, Lee E, Mill L, et al. (2020). “Critical Review of
Processing and Classification Techniques for Images and Spectra in
Microplastic Research.” <em>Applied Spectroscopy</em>,
<strong>74</strong>(9), 989–1010. doi: <a href="https://doi.org/10.1177/0003702820929064" class="external-link">10.1177/0003702820929064</a>.</p>
<p>Cowger W, Steinmetz Z, Gray A, Munno K, Lynch J, Hapich H, Primpke S,
De Frond H, Rochman C, Herodotou O (2021). “Microplastic Spectral
Classification Needs an Open Source Community: Open Specy to the
Rescue!” <em>Analytical Chemistry</em>, <strong>93</strong>(21),
7543–7548. doi: <a href="https://doi.org/10.1021/acs.analchem.1c00123" class="external-link">10.1021/acs.analchem.1c00123</a>.</p>
<p>Primpke S, Wirth M, Lorenz C, Gerdts G (2018). “Reference Database
Design for the Automated Analysis of Microplastic Samples Based on
Fourier Transform Infrared (FTIR) Spectroscopy.” <em>Analytical and
Bioanalytical Chemistry</em>, <strong>410</strong>(21), 5131–5141. doi:
<a href="https://doi.org/10.1007/s00216-018-1156-x" class="external-link">10.1007/s00216-018-1156-x</a>.</p>
<p>Renner G, Schmidt TC, Schram J (2017). “A New Chemometric Approach
for Automatic Identification of Microplastics from Environmental
Compartments Based on FT-IR Spectroscopy.” <em>Analytical
Chemistry</em>, <strong>89</strong>(22), 12045–12053. doi: <a href="https://doi.org/10.1021/acs.analchem.7b02472" class="external-link">10.1021/acs.analchem.7b02472</a>.</p>
<p>Savitzky A, Golay MJ (1964). “Smoothing and Differentiation of Data
by Simplified Least Squares Procedures.” <em>Analytical Chemistry</em>,
<strong>36</strong>(8), 1627–1639.</p>
<p>Zhao J, Lui H, McLean DI, Zeng H (2007). “Automated Autofluorescence
Background Subtraction Algorithm for Biomedical Raman Spectroscopy.”
<em>Applied Spectroscopy</em>, <strong>61</strong>(11), 1225–1232. doi:
<a href="https://doi.org/10.1366/000370207782597003" class="external-link">10.1366/000370207782597003</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Win Cowger, Zacharias Steinmetz, Nick Leong, Andrea Faltynkova, Hannah Sherrod, National Renewable Energy Laboratory, Possibility Lab.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
